# Resolving State Ambiguity in Robot Manipulation via Adaptive Working Memory Recoding

**相关性评分**: 7.0/10

**排名**: #22


---


## 基本信息

- **arXiv ID**: [2512.24638v1](https://arxiv.org/abs/2512.24638v1)
- **发布时间**: 2025-12-31T05:20:13Z
- **相关性评分**: 7.0/10
- **是否相关**: 是

## 作者

Qingda Hu, Ziheng Qiu, Zijun Xu, Kaizhao Zhang, Xizhou Bu, Zuolei Sun, Bo Zhang, Jieru Zhao, Zhongxue Gan, Wenchao Ding

## 关键词

Vision-Language-Action Model, VLA for Robotics, Inference Efficiency, Lightweight Architecture, Inference Acceleration, Edge Deployment

## 一句话总结

该论文提出一种具有自适应工作记忆的视觉运动策略PAM，通过高效处理长历史窗口来解决机器人操作中的状态模糊问题，并保持高推理速度，适用于边缘部署。

## 摘要

State ambiguity is common in robotic manipulation. Identical observations may correspond to multiple valid behavior trajectories. The visuomotor policy must correctly extract the appropriate types and levels of information from the history to identify the current task phase. However, naively extending the history window is computationally expensive and may cause severe overfitting. Inspired by the continuous nature of human reasoning and the recoding of working memory, we introduce PAM, a novel visuomotor Policy equipped with Adaptive working Memory. With minimal additional training cost in a two-stage manner, PAM supports a 300-frame history window while maintaining high inference speed. Specifically, a hierarchical frame feature extractor yields two distinct representations for motion primitives and temporal disambiguation. For compact representation, a context router with range-specific queries is employed to produce compact context features across multiple history lengths. And an auxiliary objective of reconstructing historical information is introduced to ensure that the context router acts as an effective bottleneck. We meticulously design 7 tasks and verify that PAM can handle multiple scenarios of state ambiguity simultaneously. With a history window of approximately 10 seconds, PAM still supports stable training and maintains inference speeds above 20Hz. Project website: https://tinda24.github.io/pam/

## 详细分析

## 论文摘要

**论文标题**：通过自适应工作记忆重编码解决机器人操作中的状态模糊问题

### 1. 研究背景和动机
在机器人操作任务中，**状态模糊性**是一个常见挑战，即相同的观测可能对应多种有效的行为轨迹。现有的视觉运动策略大多依赖马尔可夫假设，仅基于短期观测进行决策，难以处理需要长时历史信息的任务。虽然延长历史窗口有助于解决模糊性，但直接扩展会导致计算成本高昂、训练不稳定和严重的过拟合问题。受人类连续推理过程和工作记忆重编码机制的启发，本研究旨在设计一种能够高效利用长时历史信息、同时保持实时推理能力的策略。

### 2. 核心方法和技术创新
本文提出了 **PAM**，一种配备**自适应工作记忆**的新型视觉运动策略。其核心创新包括：
- **自适应工作记忆重编码**：设计了一个分层帧特征提取器，使用两种不同的查询令牌分别提取与动作执行直接相关的**运动基元**和用于时序消歧的**上下文特征**。后者作为重编码后的工作记忆在推理步骤间传递。
- **上下文路由器**：引入一个上下文路由器，接收历史上下文特征序列，并使用一组覆盖不同历史长度的查询令牌来生成紧凑的上下文表示，有效避免了特征混淆。
- **两阶段训练与辅助目标**：采用两阶段训练策略，先学习稳定的运动基元，再激活上下文模块进行时序消歧学习。同时，引入重建历史图像特征的辅助目标，确保上下文路由器成为一个有效的“信息瓶颈”。
- **高效推理**：PAM支持长达300帧（约10秒）的历史窗口，同时保持20Hz以上的实时推理速度，在训练成本和推理效率之间取得了良好平衡。

### 3. 主要实验结果
- **真实世界任务**：精心设计了涵盖双向重叠、固定姿态、顺序子任务等7种状态模糊场景的任务。PAM在平均成功率上达到**0.91**，显著优于基线方法LongDP（0.61）和MTIL（0.45）。
- **长视野任务**：在Libero-Long仿真基准测试中，PAM取得了**84.7%**的平均成功率，与顶尖方法性能相当，证明了其良好的泛化能力。
- **可解释性**：通过注意力可视化，PAM能够清晰地展示其决策时参考的历史片段和感知模态，增强了模型的可解释性。
- **消融实验**：验证了视觉编码器、多条件注入机制、上下文路由器设计及采样间隔等关键组件的有效性。

### 4. 研究意义和价值
本研究为解决机器人操作中的长时依赖和状态模糊问题提供了一个**高效、通用且可解释**的框架。PAM的核心价值在于：
- **技术创新**：将认知科学中的工作记忆重编码思想成功引入机器人学习，通过自适应机制提取紧凑的历史表示，突破了长历史窗口带来的计算与过拟合瓶颈。
- **实用价值**：在保持实时推理速度的前提下，大幅扩展了策略可利用的历史范围，使机器人能够处理更复杂、需要记忆和上下文理解的序列任务。
- **启发性**：其两阶段训练、模块化设计及可解释性分析，为未来开发更强大、更可靠的时序依赖机器人策略提供了清晰的路径和借鉴。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析

### **一、 想解决的核心问题**
论文旨在解决机器人操作中普遍存在的 **“状态模糊性”** 问题。具体表现为：
- **现象**：相同的即时观测可能对应多个有效的行为轨迹。例如，在“来回擦拭桌子”的任务中，机器人看到自己位于桌子右侧时，无法仅凭当前画面判断是应该开始第一次擦拭、开始第二次擦拭，还是结束任务放回海绵。
- **根源**：任务的状态转移不遵循马尔可夫假设，即当前状态不仅取决于上一状态，还依赖于更长的历史上下文。
- **现有方法的局限**：
    1.  **计算成本高**：简单地延长历史观测窗口（如拼接多帧图像）会显著增加计算负担。
    2.  **容易过拟合**：长历史窗口的高维输入容易导致模型过拟合，损害泛化能力。
    3.  **缺乏适应性**：手工设计的历史表征（如轨迹渲染、物体跟踪）成本高，且难以泛化到多样化的模糊场景。

### **二、 核心创新点**
论文提出了 **PAM**，一个配备**自适应工作记忆**的视觉运动策略。其创新性主要体现在**设计思想**和**具体实现**两个层面：

1.  **核心思想创新：受人类认知启发的“自适应工作记忆重编码”**
    - **灵感来源**：借鉴人类连续推理过程和工作记忆的“重编码”机制。人脑并非存储原始的感官信息，而是根据任务需求，灵活地将信息重新编码为更紧凑、更相关的表征。
    - **对应机制**：PAM 不直接传播或拼接原始观测特征，而是通过一个专门的**上下文查询令牌**，从多模态输入中主动“提取”和“重编码”出与任务上下文相关的紧凑特征，作为工作记忆。

2.  **方法架构创新：高效、稳定、可解释的长历史建模框架**
    - **双特征流提取**：
        - **运动基元特征**：从当前帧提取，直接指导动作生成。
        - **上下文特征**：通过上下文查询令牌提取，作为跨推理步传播的“工作记忆”。
    - **上下文路由器**：
        - **作用**：接收历史上下文特征序列，使用一组覆盖不同历史长度的查询令牌，生成**紧凑的上下文表征**。
        - **优势**：避免了RNN类方法中隐藏状态传播导致的表征失真或遗忘，能更稳定地整合长时信息。
    - **辅助重建目标**：
        - 要求模型仅基于紧凑的上下文表征来重建历史图像嵌入。
        - **目的**：确保上下文路由器成为一个有效的“信息瓶颈”，迫使它学习信息量最大化的表征，避免信息冗余或丢失关键线索。
    - **两阶段训练策略**：
        - **阶段一**：仅训练运动基元提取和动作头，打下稳定的多模态特征基础。
        - **阶段二**：冻结特征提取器，激活并训练上下文相关模块（路由器、辅助头），专注于学习时序解模糊能力。
        - **优势**：实现了高效的并行采样训练，避免了时序依赖模型常见的训练不稳定和高成本问题。

### **三、 解决方案总结**
PAM 通过一套**受神经科学启发的算法架构**和**精心设计的训练流程**，系统性地解决了长历史建模的挑战：

1.  **解决“计算成本高”**：采用**时序依赖推理**。在每一步推理中，只需编码当前观测，而通过维护和更新紧凑的“工作记忆”（上下文特征）来承载历史信息，实现了**长达300帧（约10秒）历史窗口下的20Hz实时推理**。
2.  **解决“容易过拟合”和“缺乏适应性”**：
    - **自适应重编码**：上下文查询和路由器能根据任务动态提取相关信息，无需人工标注。
    - **紧凑表征**：辅助重建目标迫使学习信息密集的瓶颈表征，抑制了过拟合。
    - **可解释性**：注意力可视化能揭示模型决策时关注的历史片段和模态，增强了可信度。
3.  **验证有效性**：在精心设计的7个涵盖不同状态模糊场景的真实机器人任务上，PAM平均成功率（0.91）显著优于基线（LongDP: 0.61， MTIL: 0.45）。在不需要长历史的长视野任务（Libero-Long）上也取得了具有竞争力的性能。

**总而言之，PAM 的核心贡献是提出并实现了一种**模仿人类工作记忆机制、能高效且自适应地利用长历史信息来解决机器人操作中状态模糊性问题的新框架**，在性能、效率和可解释性之间取得了良好平衡。


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: 这篇论文旨在解决机器人操作中普遍存在的**状态模糊性问题**，即相同的观测可能对应多个有效的行为轨迹，导致仅依赖短时观测的策略难以做出正确决策。为此，论文提出了一种名为**PAM**的新型视觉运动策略，其核心创新在于引入了**自适应工作记忆重编码机制**。该方法通过一个上下文路由器，将长时历史信息（最长300帧）动态地压缩为紧凑的上下文特征，作为工作记忆来辅助决策，并采用两阶段训练策略以稳定、高效地学习这种时序依赖的推理能力。实验表明，PAM在多种精心设计的、存在状态模糊性的真实世界任务中取得了显著优于基线方法的性能（平均成功率0.91），同时保持了20Hz的实时推理速度，并在长视野任务上展现了良好的通用性。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## 论文创新点分析

这篇论文提出的PAM（Policy with Adaptive working Memory）在解决机器人操作中的状态模糊性问题上，相对于已有工作，具有以下几个明确的创新点：

### 1. **引入“自适应工作记忆重编码”机制**
   - **改进/不同之处**：以往方法（如TraceVLA、HistRISE）依赖**手动设计的历史特征表示**（如渲染的运动轨迹、物体跟踪），或像MTIL那样直接传播隐藏状态。PAM则受人类工作记忆启发，设计了一个**上下文查询令牌（`q^{ctx}`）**，通过因果注意力动态地从多模态输入（视觉、语言、本体感觉）中“重编码”出紧凑的上下文特征，作为自适应的工作记忆。
   - **解决的问题/优势**：
     - **解决了手动标注成本高、泛化性差的问题**：自适应重编码无需额外人工标注，能自动从数据中学习与任务最相关的历史信息表示。
     - **解决了特征冗余与混淆问题**：相比简单拼接多帧特征或传播原始特征，重编码能提取出更紧凑、信息密度更高的上下文表示，避免了长历史窗口带来的信息冗余和特征混淆，从而缓解了过拟合。

### 2. **采用“上下文路由器”来整合长时历史信息**
   - **改进/不同之处**：不同于RNN/LSTM类方法（如RoboVLMs）的序列传播，或“记忆银行”方法（如MemoryVLA）复杂的检索融合机制，PAM设计了一个**轻量级的上下文路由器**。它接收一系列历史上下文特征，并使用**一组覆盖不同历史长度的查询令牌**，通过自注意力机制生成一个**分层的、紧凑的上下文摘要**。
   - **解决的问题/优势**：
     - **解决了长时依赖建模的稳定性问题**：实验表明，MTIL等方法传播的隐藏状态容易发生表征失真，导致动作抖动。上下文路由器作为显式的、结构化的整合模块，能更稳定地提取和维持关键历史信息。
     - **提升了计算效率与可解释性**：该模块结构简单，计算高效。其注意力图谱（如图4所示）能直观显示模型决策时参考了历史中的哪些关键帧，提供了良好的可解释性。

### 3. **设计“两阶段训练策略”以实现高效稳定的训练**
   - **改进/不同之处**：以往训练时序依赖模型（如MTIL）常采用**序列化训练**，成本高且不稳定。PAM提出**两阶段训练法**：
     1. **第一阶段**：仅使用当前帧的运动基元特征训练动作头，冻结上下文相关参数，旨在学习稳定的多模态帧特征提取器。
     2. **第二阶段**：冻结特征提取器并缓存其键值状态，仅激活和训练上下文路由器及动作头中的上下文注入部分，并引入辅助重建目标。
   - **解决的问题/优势**：
     - **解决了训练不稳定和高成本问题**：两阶段策略将困难的长时历史建模问题分解，**实现了高效的并行采样**，避免了端到端序列化训练的不稳定性，大幅降低了训练成本。
     - **实现了规模化潜力**：这种解耦训练策略使其能够扩展到更大的模型。

### 4. **支持超长历史窗口（300帧）的同时保持实时推理速度（20Hz）**
   - **改进/不同之处**：现有方法在扩展历史窗口时面临**计算成本与性能的权衡**。例如，LongDP直接拼接多帧感知特征，导致推理速度慢（5Hz）；而一些方法则受限于短窗口。PAM通过**自适应工作记忆重编码和上下文路由器**，在**每个推理步仅编码当前观测**，而通过维护和更新紧凑的工作记忆来承载长达300帧（约10秒）的历史信息。
   - **解决的问题/优势**：
     - **打破了历史窗口长度与推理速度的负相关**：PAM在支持超长历史窗口（覆盖绝大多数需要历史信息的场景）的同时，**推理速度仍保持在20Hz以上**，满足了机器人实时控制的要求。
     - **有效缓解了对马尔可夫假设的依赖**：长窗口使策略能更好地处理非马尔可夫性的状态模糊任务。

### 5. **引入“辅助重建目标”以增强工作记忆的表征质量**
   - **改进/不同之处**：受人类回忆过程启发，PAM在训练第二阶段增加了一个**辅助目标**，要求模型仅基于紧凑的上下文特征 `e_t^{ctx}` 来**重建历史图像的特征嵌入**。这不同于LongDP重建历史动作，PAM选择重建视觉特征。
   - **解决的问题/优势**：
     - **确保了上下文路由器作为有效的“信息瓶颈”**：该目标强制上下文特征必须包含足够重建历史视觉信息的关键内容，从而**提升了工作记忆表征的丰富性和判别力**。消融实验表明，在如“猜谜游戏”这类依赖空间记忆的任务中，该目标能带来显著性能提升。

### 总结
PAM的核心创新在于**受神经科学启发的系统架构设计**（自适应重编码、上下文路由器）与**高效的训练策略**（两阶段训练）相结合。它系统性地解决了在模仿学习中引入长历史窗口所面临的三大挑战：**1) 计算成本高**；**2) 训练不稳定易过拟合**；**3) 历史信息表示效率低下**。最终，PAM以较低的训练成本和较高的推理效率，实现了对复杂状态模糊任务的鲁棒处理，并在长视野任务上保持了竞争力。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 论文实验与评估效果总结

### 一、 主要实验设置与评价指标

#### 1. 数据集
- **真实世界机器人任务数据集**：作者精心设计了7个任务（如 `Wipe the Table Twice`, `Guessing Game`），每个任务收集了50条专家演示轨迹（30Hz）。
- **仿真环境数据集**：使用 **Libero-Long** 基准测试中的10个长视野操作任务，每个任务包含50条专家轨迹。

#### 2. 评价指标
- **任务成功率**：对于多子任务的任务，报告**所有子任务成功率的平均值**。
- **推理速度**：以赫兹（Hz）为单位，衡量策略的实时性。
- **历史窗口长度**：模型能够有效利用的历史帧数。
- **训练稳定性与成本**：关注训练过程的稳定性和计算开销。

### 二、 基线方法对比

论文在两个实验场景中与多个先进的基线方法进行了对比：

1.  **真实世界任务（解决状态模糊性）**：
    - **LongDP**：一种利用多帧感知特征和自监督目标（重建历史动作）的方法。
    - **MTIL**：一种使用选择性状态空间模型编码完整轨迹历史的方法。

2.  **Libero-Long长视野任务（评估通用性）**：
    - **OpenVLA**
    - **Diffusion Policy (DP)**
    - **MDT**
    - **π₀**

### 三、 关键性能结果与结论

#### 1. 在真实世界任务上的表现（核心贡献验证）
- **整体性能**：PAM在7个任务上的**平均成功率达到0.91**，显著优于基线。
    - 相比 **LongDP (0.61)**，性能提升 **49.2%**。
    - 相比 **MTIL (0.45)**，性能提升超过 **102%**。
- **关键优势场景**：
    - 在 `Hold the Pot Lid` 和 `Wipe the Table Twice` 等具有挑战性的状态模糊任务中，PAM成功率（0.95, 0.92）远高于基线，证明了其**强大的时序解歧能力**。
    - PAM能够**使用单一模型同时处理7个不同场景的任务**，而基线多为单任务模型，这证明了其**自适应工作记忆编码的泛化能力**。
- **效率与实时性**：
    - PAM支持长达 **300帧（约10秒）的历史窗口**。
    - 在保持高精度的同时，**推理速度维持在20Hz以上**，满足实时控制要求。而LongDP的推理速度仅为5Hz。
    - 通过**两阶段训练策略**，实现了**稳定且成本可控的训练**，避免了时序依赖模型常见的训练不稳定问题。

#### 2. 在Libero-Long长视野任务上的表现（通用性验证）
- PAM取得了 **84.7%** 的平均成功率。
- 性能与最强的基线 **π₀ (85.2%)** 相当，并显著优于其他基线（OpenVLA: 54.4%, DP: 58.2%, MDT: 65.3%）。
- **结论**：这表明PAM的架构虽然专为状态解歧设计，但其**核心设计（如运动基元与上下文特征分离）同样能有效支持通用的长视野操作任务**，具有良好的通用性。

#### 3. 其他重要结论
- **可解释性**：通过可视化上下文路由器和特征提取器的注意力图，PAM能够展示其决策时**参考了历史中的哪些关键帧**以及**利用了哪些模态的信息**（如图4所示），增强了模型的可解释性。
- **消融实验关键发现**：
    - **视觉编码器**：使用更强大的ViT-Base编码器比轻量级编码器性能好得多（0.91 vs 0.72），表明丰富的感知信息对解歧至关重要。
    - **条件注入机制**：在动作头中，**先注入运动基元特征，再注入上下文特征**的交叉注意力方式效果最佳。
    - **上下文路由器**：使用**3个查询令牌**来整合不同历史长度的信息效果最好，过多或过少都会降低性能。
    - **采样间隔**：对历史上下文特征进行间隔采样（如间隔15帧）能在信息密度和计算效率间取得最佳平衡。

### 总结
论文通过详实的实验证明，PAM方法在**解决机器人操作中的状态模糊性问题上取得了显著效果**。它不仅**在专门设计的复杂任务上大幅超越现有方法**，还在**标准长视野基准测试中达到领先水平**。其核心价值在于，以**可承受的训练成本**和**高效的推理速度**，实现了**对长历史窗口的有效利用**，从而提升了策略在面临状态歧义时的鲁棒性和决策准确性。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2512.24638v1)
- [HTML 版本](https://arxiv.org/html/2512.24638v1)
