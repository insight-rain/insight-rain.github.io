# Warm-Starting Collision-Free Model Predictive Control With Object-Centric Diffusion

**相关性评分**: 6.0/10

**排名**: #16


---


## 基本信息

- **arXiv ID**: [2601.02873v1](https://arxiv.org/abs/2601.02873v1)
- **发布时间**: 2026-01-06T10:02:54Z
- **相关性评分**: 6.0/10
- **是否相关**: 是

## 作者

Arthur Haffemayer, Alexandre Chapin, Armand Jordana, Krzysztof Wojciechowski, Florent Lamiraux, Nicolas Mansard, Vladimir Petrik

## 关键词

Vision-Language-Action Model, VLA for Robotics, Inference Efficiency, Lightweight Architecture, Inference Acceleration, Edge Deployment

## 一句话总结

这篇论文提出了一种结合对象中心扩散模型和模型预测控制的混合方法，用于在复杂环境中实时生成无碰撞运动轨迹，提高了推理效率和机器人控制性能。

## 摘要

Acting in cluttered environments requires predicting and avoiding collisions while still achieving precise control. Conventional optimization-based controllers can enforce physical constraints, but they struggle to produce feasible solutions quickly when many obstacles are present. Diffusion models can generate diverse trajectories around obstacles, yet prior approaches lacked a general and efficient way to condition them on scene structure. In this paper, we show that combining diffusion-based warm-starting conditioned with a latent object-centric representation of the scene and with a collision-aware model predictive controller (MPC) yields reliable and efficient motion generation under strict time limits. Our approach conditions a diffusion transformer on the system state, task, and surroundings, using an object-centric slot attention mechanism to provide a compact obstacle representation suitable for control. The sampled trajectories are refined by an optimal control problem that enforces rigid-body dynamics and signed-distance collision constraints, producing feasible motions in real time. On benchmark tasks, this hybrid method achieved markedly higher success rates and lower latency than sampling-based planners or either component alone. Real-robot experiments with a torque-controlled Panda confirm reliable and safe execution with MPC.

## 详细分析

## 论文摘要

**论文标题：** 基于物体中心扩散模型的碰撞规避模型预测控制预热启动

### 1. 研究背景和动机
在杂乱、非凸的环境中生成**无碰撞且动力学可行**的运动轨迹是机器人操作的核心挑战。传统的基于优化的控制器（如模型预测控制，MPC）虽能处理物理约束，但在复杂场景中**对初始解高度敏感**，容易陷入局部最优。另一方面，扩散模型能够生成多样的轨迹，但先前的方法缺乏一种**通用且高效**的方式来根据场景结构对其进行条件化，限制了其在实时控制中的泛化能力和应用。

### 2. 核心方法和技术创新
本文提出了一种**两阶段混合框架**，将学习型轨迹先验与基于模型的优化控制相结合：
- **物体中心的条件化扩散模型**：采用基于**Slot Attention**的物体中心编码器，从RGB图像中提取紧凑的、排列不变的潜在障碍物表示（“槽”）。以此作为条件，训练一个**扩散变换器**来生成多样化的轨迹提议，作为高质量的“预热启动”轨迹。
- **基于MPC的轨迹精炼**：将扩散模型生成的轨迹作为初始猜测，输入到一个**实时MPC求解器**中。该求解器求解一个包含刚体动力学、关节力矩限制和**基于符号距离的硬碰撞约束**的最优控制问题，确保最终轨迹的动力学可行性和安全性。
- **系统性数据生成**：结合基于采样的规划（RRT）和约束轨迹优化来生成高质量的训练数据集，确保扩散模型学习到的是平滑、可行的专家轨迹分布。

### 3. 主要实验结果
在模拟的桌面、抽屉和货架三个杂乱场景基准测试中，该方法取得了显著优势：
- **成功率最高**：在三个场景中分别达到82%、79%和83%的成功率，明显优于PRESTO、MPD、cuRobo、RRT-Connect以及无预热启动的纯OCP基线。
- **计算效率高**：平均计算时间低于72毫秒，满足实时控制要求。
- **消融实验验证**：Slot Attention的场景表示在低计算预算下性能最佳，优于占用栅格、图像和配置空间表示。实验表明，**结合OCP精炼后，在扩散过程中添加基于成本的梯度引导并无益处**。
- **真实机器人验证**：在Franka Emika Panda机械臂上成功实现了**实时、闭环**的碰撞规避操作，并能动态响应环境中障碍物的移除。

### 4. 研究意义和价值
本研究的主要贡献在于：
- **提出了一种新颖的混合架构**，有效融合了**生成式模型的全局探索能力**与**基于模型的优化的局部约束满足能力**，解决了复杂环境中轨迹优化的初始化难题。
- **创新性地将物体中心表示（Slot Attention）用于控制任务的场景条件化**，提供了紧凑、可泛化的环境编码，提升了系统对未见场景的适应能力。
- **实现了从感知到控制的完整、实时管道**，并在真实机器人上验证了其**可靠性、安全性和高效性**，为在动态杂乱环境中部署智能机器人系统提供了切实可行的解决方案。
- 开源了代码，为后续研究奠定了基础，并指出了未来方向，如集成更丰富的3D物体表示和在线自适应规划。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析

### **核心问题**
在**杂乱、非凸环境**中，机器人需要实时生成**动态可行且无碰撞**的运动轨迹。传统基于优化的控制器（如MPC）能处理物理约束，但在复杂障碍物场景下，对初始解高度敏感，容易陷入局部最优，导致求解失败或效率低下。

### **核心创新点**
论文提出了一种**混合架构**，将**基于学习的生成式轨迹先验**与**基于模型的优化控制**相结合，以解决上述问题。其创新主要体现在以下三个层面的深度融合：

1.  **对象中心化的场景表征与条件扩散模型**
    - **创新点**：采用**Slot Attention**机制，从RGB图像中提取**对象中心化的潜在表示**作为扩散模型的**条件输入**。
    - **解决方式**：相比点云、深度图或占用栅格，这种表征更紧凑、结构化且具有排列不变性。它使扩散模型能理解场景的“对象级”几何与布局，从而生成适应特定环境结构的多样化轨迹提议，显著提升了模型对未见场景的泛化能力。

2.  **扩散模型为MPC提供高质量热启动**
    - **创新点**：将**条件扩散模型**定位为**轨迹提议生成器**，专门为后续的最优控制问题提供**初始猜测**。
    - **解决方式**：扩散模型捕获了专家轨迹的多模态分布，能生成绕过障碍物的多种可能轨迹。这些轨迹作为“热启动”输入给MPC求解器，将其引导至有希望的搜索区域，极大避免了局部最优，加速了收敛。

3.  **基于MPC的轨迹精炼与硬约束保证**
    - **创新点**：使用一个**带硬约束的模型预测控制器**对扩散提议进行**在线精炼和投影**，而非简单的开环跟踪或梯度后处理。
    - **解决方式**：MPC求解一个包含**刚体动力学、关节限位、扭矩限制**以及**基于符号距离的硬碰撞约束**的最优控制问题。这确保了最终输出的轨迹不仅是无碰撞的，而且是动态可行、平滑且可直接在真实机器人上安全执行的，实现了闭环实时重规划。

### **解决方案流程**
整个系统是一个清晰的两阶段流水线：

```mermaid
graph LR
    A[输入: 当前状态、目标、RGB图像] --> B[阶段A: 对象中心化编码]
    B --> C[Slot Attention编码器]
    C --> D[对象中心化潜在表示]
    D --> E[阶段B: 条件轨迹生成]
    E --> F[扩散变换器]
    F --> G[噪声轨迹 + 条件] --> H[去噪过程]
    H --> I[热启动轨迹提议]
    I --> J[阶段C: MPC轨迹精炼]
    J --> K[最优控制问题求解器<br/>动力学+硬碰撞约束]
    K --> L[输出: 可行、安全、最优的控制序列]
```

### **实际价值**
1.  **性能提升**：在基准测试中，该混合方法取得了**最高的成功率**（~80%以上）和**最低的延迟**（<72ms），显著优于单独的采样规划器、纯MPC或其他扩散方法。
2.  **安全与实时性**：在真实扭矩控制的Franka Panda机器人上验证，实现了**毫秒级**的闭环重规划，严格保证了碰撞安全。
3.  **泛化能力**：对象中心化的表征使系统能更好地处理**未见过的杂乱场景布局**。
4.  **开源贡献**：提供了开源实现，为社区提供了结合生成式AI与模型预测控制的可复现范例。

**总结**：本文的核心创新在于**系统性地整合了对象中心化感知、生成式轨迹先验和带硬约束的模型预测控制**，创造了一个既能进行全局多模态推理，又能保证局部物理约束满足的实时运动生成框架，有效解决了杂乱环境中机器人运动规划的可靠性、速度与安全性难题。


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: 这篇论文旨在解决在复杂、非凸的杂乱环境中，机器人实时生成**动态可行且无碰撞**运动轨迹的难题。传统基于优化的控制器（如MPC）对初始猜测敏感，容易陷入局部最优；而现有的扩散模型缺乏高效、通用的场景信息编码方式，难以生成满足物理约束的轨迹。

为此，论文提出了一个**两阶段混合框架**：第一阶段，利用一个**以物体为中心的扩散模型**（基于Slot Attention的场景编码和Diffusion Transformer）来生成高质量的轨迹“热启动”建议；第二阶段，将这些建议输入一个**带硬性碰撞约束的模型预测控制器**进行实时精炼，严格满足刚体动力学和安全性要求。

实验表明，该方法在多个基准任务上实现了**最高的成功率**（约80%）和**最低的延迟**（<72ms），显著优于纯采样规划器、纯优化方法或其他学习基线。在真实机器人（Franka Panda）上的实验进一步验证了该框架能够实现**可靠、安全的实时闭环控制**。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## 论文创新点分析

这篇论文提出了一种结合扩散模型与模型预测控制（MPC）的机器人运动规划框架，其核心创新点可归纳为以下几条：

### 1. **提出“对象中心化场景表示”作为扩散模型的紧凑条件输入**
- **改进/不同之处**：以往方法通常使用高维、非结构化的场景表示（如点云、深度图像）或简单的碰撞指示向量（如PRESTO中的配置空间采样）。本文则采用基于**Slot Attention**的对象中心化编码器，从单目RGB图像中提取一组无序的、紧凑的潜在“槽”（slots），每个槽对应一个障碍物或物体。
- **解决的问题/优势**：
    - **紧凑性与泛化性**：该表示将场景结构压缩为少量潜在向量（如6个槽，每个维度64），显著降低了输入维度，提高了推理速度（适合实时控制）。其**置换不变性**（permutation-invariant）特性使其能泛化到不同数量、不同排列的未知障碍物场景。
    - **信息有效性**：相比图像表示（丢失几何信息）或点云（高维噪声），对象中心化表示直接捕捉了障碍物的几何与布局信息，为轨迹生成提供了更具信息量的条件信号。

### 2. **设计了一种“两阶段混合框架”：扩散模型生成热启动轨迹 + MPC进行严格约束投影优化**
- **改进/不同之处**：以往工作（如Diffusion Seeder、MPD）通常将扩散模型生成的轨迹作为开环指令直接由底层控制器跟踪，**缺乏闭环重规划能力，且不严格保证动力学可行性或硬碰撞约束**。本文则明确将扩散模型作为**热启动生成器**，其输出轨迹随后被送入一个**完整的、带硬约束的MPC最优控制问题（OCP）** 中进行精炼。
- **解决的问题/优势**：
    - **保证安全性与可行性**：扩散模型生成的轨迹可能轻微违反动力学（如扭矩限制）或碰撞约束。MPC阶段通过求解包含刚体动力学模型和**符号距离碰撞约束**的OCP，将轨迹严格投影到可行解空间，确保最终轨迹是动力学可行且绝对安全的。
    - **结合全局推理与局部优化**：扩散模型利用学习到的先验进行**全局、多模态的轨迹推理**（绕过局部极小值），而MPC提供**基于模型的局部精确优化与闭环反馈**。这种结合解决了纯优化方法（对初始化敏感、易陷局部极小）和纯学习方法（缺乏安全保证）各自的短板。

### 3. **实现了在真实机器人上的实时、闭环、碰撞感知控制演示**
- **改进/不同之处**：许多先进的扩散规划方法（如Diffuser、MPD、甚至一些声称近似全局最优MPC的工作）仅在仿真中验证，或仅在简化/低维环境中进行真实机器人实验。本文在**扭矩控制的Franka Panda机器人**上实现了完整的系统，包括：
    1. 基于AprilTag的实时障碍物姿态估计。
    2. 以100Hz频率运行MPC重规划（预测时域150ms）。
    3. 使用Riccati增益进行1kHz的高频底层反馈控制。
    4. 在杂乱、动态变化（如中途移走障碍物）的货架环境中展示了可靠、安全的执行能力。
- **解决的问题/优势**：
    - **验证了实用性**：证明了该混合框架能满足**严格的实时性要求**（总计算时间<72ms），并能处理真实世界的感知噪声、动态变化和非凸几何，将方法从仿真推向了实际应用。
    - **提供了完整技术栈**：集成了从场景感知（对象中心化编码）、轨迹生成（扩散模型）、到精确控制（带硬约束MPC）的完整机器人流水线，并开源了代码。

### 4. **系统性地进行了场景表示消融研究，并分析了计算预算与性能的权衡**
- **改进/不同之处**：论文没有仅仅提出新表示方法，而是**系统比较了四种场景表示**（对象中心化Slot Attention、占据栅格、图像编码、PRESTO的配置空间表示）在相同控制架构下的性能。同时，深入分析了**扩散步数**和**OCP迭代次数**对成功率和计算时间的影响，提供了选择超参数的指导。
- **解决的问题/优势**：
    - **量化了对象中心化表示的优势**：实验表明，在低至中等计算预算（20-60ms）下，Slot Attention表示的成功率显著高于其他方法，尤其在控制相关的实时场景中优势明显。
    - **为工程部署提供设计指南**：通过绘制性能-计算时间曲线，明确了“扩散步数增加初期收益大，后期收益递减”、“OCP迭代超过一定次数后计算成本陡增”等关键趋势，帮助研究者和工程师根据自身计算资源进行最优配置。

### 5. **揭示了在结合OCP精炼时，扩散过程中的“基于成本的梯度引导”并非必要**
- **改进/不同之处**：一些工作（如MPD）在扩散的每一步使用基于任务成本（如碰撞惩罚）的梯度来引导去噪过程，以促使样本满足约束。本文通过实验发现，**当后续有强大的MPC进行投影优化时，这种梯度引导在低计算预算下无益，在高预算下甚至因引入额外开销而有害**。
- **解决的问题/优势**：
    - **简化了管道**：这一发现允许移除复杂的梯度引导机制，使扩散模型更专注于从数据中学习高质量的先验分布，简化了训练和推理流程。
    - **突出了MPC的核心作用**：强调了在混合框架中，**MPC才是确保约束满足的关键组件**，而非依赖扩散模型内部的启发式引导。

**总结**：本文的核心创新在于**创造性地将对象中心化的场景表示、条件扩散模型生成的热启动、以及带硬约束的实时MPC优化三者紧密结合**，形成了一个既具有学习模型的全局推理和快速生成能力，又具备模型控制方法的精确性、安全性和闭环反馈优势的混合系统。它有效解决了在杂乱、非凸环境中，传统优化方法易陷局部极小、学习型方法缺乏安全保证的共性问题，并在真实机器人平台上验证了其高效性与可靠性。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 论文实验与评估效果总结

### 一、 实验设置与数据集

**1. 仿真实验环境与数据集**
- **环境**：在三个具有挑战性的非凸、杂乱环境中进行测试：
    - **Table**：桌面环境，最多3个障碍物。
    - **Drawer**：抽屉环境，最多3个障碍物。
    - **Shelf**：货架环境（最复杂），最多5个障碍物。
- **数据集生成**：通过模拟环境生成高质量专家轨迹用于训练扩散模型。
    - **Shelf环境**：300个场景，每个场景100个规划问题，共30,000条轨迹。
    - **Table/Drawer环境**：各100个场景，每个场景100个问题，各10,000条轨迹。
    - **生成流程**：使用RRT生成几何路径，然后通过最优控制问题（OCP）求解器进行优化，得到平滑、动态可行的专家轨迹。

**2. 真实机器人实验平台**
- **机器人**：Franka Emika Panda（扭矩控制）。
- **感知**：使用AprilTags进行实时障碍物检测与位姿估计。
- **控制框架**：MPC在100 Hz下求解，控制命令在1 kHz下执行。
- **优化设置**：预测时域15个节点，时间步长10 ms，总优化时域150 ms。

### 二、 评价指标

论文使用了三个核心指标来量化性能：
1.  **成功率**：轨迹成功到达目标且无碰撞的百分比。**越高越好**。
2.  **穿透深度**：轨迹中机器人与障碍物累计的穿透深度。**越低越好**，成功轨迹应为零。
3.  **平均成本**：最优控制问题（OCP）的总成本，反映轨迹的可行性和接近目标的程度。**越低越好**。
4.  **计算时间**：生成可行轨迹所需的计算时间。**越低越好**，以满足实时性要求。

### 三、 基线方法对比

论文与以下五类方法进行了全面对比：

| 方法类别 | 具体方法 | 方法特点 |
| :--- | :--- | :--- |
| **学习型扩散方法** | **PRESTO** [[Seo et al., 2025]] | 在构型空间操作的扩散模型，使用预定义构型的碰撞指示向量作为场景表示。 |
| | **运动规划扩散** [[Carvalho et al., 2023]] | 无条件扩散模型，通过成本梯度引导实现避障。 |
| **经典/优化型规划器** | **RRT-Connect** [[Kuffner & LaValle, 2000]] | 经典双向采样规划器。 |
| | **cuRobo** [[Sundaralingam et al., 2023]] | GPU加速的轨迹优化与采样结合框架。 |
| | **纯OCP（无热启动）** [[Mastalli et al., 2020]] | 使用DDP直接求解OCP，无任何热启动，作为消融对比。 |

### 四、 关键性能结果与结论

**1. 整体性能领先（图4）**
- **成功率**：在三个基准环境（Table, Drawer, Shelf）上，本文方法取得了**最高成功率**（分别为82%， 79%， 83%），显著优于其他方法。
- **计算效率**：平均计算时间低于 **72 ms**，满足实时控制要求，且略快于其他基线。
- **轨迹质量**：实现了**最低的平均轨迹成本**，表明生成的轨迹更平滑、更动态可行。
- **基线表现**：
    - PRESTO, cuRobo, RRT-Connect 成功率也超过70%，但计算时间更长。
    - **MPD和纯OCP基线成功率低于10%**，证明了在复杂杂乱环境中，无引导的优化或无条件扩散模型难以收敛。

**结论**：结合**基于槽注意力的对象中心扩散模型**与**基于硬约束的MPC细化**，在成功率、安全性和计算效率之间取得了最佳平衡。

**2. 场景表示消融研究（图5）**
比较了四种场景表示方法对控制性能的影响：
- **槽注意力（本文方法）**：在低至中计算预算（20-60 ms）下实现最高成功率（80% @ 50 ms），**性能最优**。
- **构型空间表示（PRESTO）** 与 **占据栅格表示**：性能接近，但需要更长的计算时间才能达到相近成功率。
- **图像表示（ResNet-18）**：性能最差，成功率低于50%，**凸显了结构化、对象中心表示对于控制任务的重要性**。

**3. 成本梯度引导的影响（图6）**
- **无OCP细化时**：梯度引导在低计算预算下能提升成功率。
- **有OCP细化时**：梯度引导的收益消失，甚至因额外开销而损害性能。因此，**在最终的管道中省略了梯度引导**，简化了流程。

**4. 计算量与性能的权衡（图7）**
- **扩散步数**和**OCP迭代次数**的增加能提升成功率，但存在收益递减。
- 扩散步数超过8，OCP迭代超过10-15后，成功率在80%左右趋于平稳，而计算时间线性增长。
- 这为**根据可用计算预算和任务需求选择超参数**提供了指导。

**5. 真实机器人验证（图8）**
- **成功演示**：在真实的杂乱货架环境中，机器人能够根据AprilTags检测到的障碍物，实时规划并执行无碰撞运动。
- **动态响应**：当障碍物被移开时，系统能无缝地重新优化轨迹，以更高效的路径到达目标，**证明了MPC闭环重规划的有效性**。

### 总结
论文通过系统的仿真和真实实验证明，其提出的 **“对象中心扩散热启动 + 硬约束MPC细化”** 框架，在高度非凸和杂乱的机器人操作任务中，能够：
1.  **显著提高规划成功率**（从纯OCP的<10%提升至>80%）。
2.  **在严格的时间限制内（<72 ms）实现实时性能**。
3.  **生成高质量（低成本）、安全（零穿透）且动态可行的轨迹**。
4.  **对象中心的场景表示是关键创新**，其性能优于图像或占据栅格等替代方案。
5.  **整套系统在真实扭矩控制机器人上得到了验证**，展示了从感知到控制的完整、可靠、安全的流水线。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2601.02873v1)
- [HTML 版本](https://arxiv.org/html/2601.02873v1)
