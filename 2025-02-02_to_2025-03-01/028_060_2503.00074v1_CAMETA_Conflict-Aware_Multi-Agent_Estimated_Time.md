# CAMETA: Conflict-Aware Multi-Agent Estimated Time of Arrival Prediction for Mobile Robots

**相关性评分**: 6.0/10

**排名**: #28


---


## 基本信息

- **arXiv ID**: [2503.00074v1](https://arxiv.org/abs/2503.00074v1)
- **发布时间**: 2025-02-27T18:36:15Z
- **相关性评分**: 6.0/10
- **是否相关**: 是

## 作者

Jonas le Fevre Sejersen, Erdal Kayacan

## 关键词

multi-agent RL, Edge Deployment, local observational information

## 一句话总结

CAMETA框架通过异构图神经网络预测多智能体在无结构环境中的到达时间，提升冲突感知和泛化能力。

## 摘要

This study presents the conflict-aware multi-agent estimated time of arrival (CAMETA) framework, a novel approach for predicting the arrival times of multiple agents in unstructured environments without predefined road infrastructure. The CAMETA framework consists of three components: a path planning layer generating potential path suggestions, a multi-agent ETA prediction layer predicting the arrival times for all agents based on the paths, and lastly, a path selection layer that calculates the accumulated cost and selects the best path. The novelty of the CAMETA framework lies in the heterogeneous map representation and the heterogeneous graph neural network architecture. As a result of the proposed novel structure, CAMETA improves the generalization capability compared to the state-of-the-art methods that rely on structured road infrastructure and historical data. The simulation results demonstrate the efficiency and efficacy of the multi-agent ETA prediction layer, with a mean average percentage error improvement of 29.5% and 44% when compared to a traditional path planning method (A *) which does not consider conflicts. The performance of the CAMETA framework shows significant improvements in terms of robustness to noise and conflicts as well as determining proficient routes compared to state-of-the-art multi-agent path planners.

## 详细分析

## CAMETA论文详细摘要

### 1. 研究背景和动机
在多机器人系统（如仓储物流）中，传统的多智能体路径规划（MAPF）方法通常为所有机器人规划严格协调、无冲突的路径。然而，在现实世界中，由于计划执行不完美和环境不确定性，这种“紧耦合”的规划容易导致频繁的冲突和重规划，降低系统整体效率。特别是在无结构化室内环境中，缺乏预定义的道路基础设施和历史交通数据，使得准确预测机器人的到达时间（ETA）并优化全局系统流更具挑战性。本研究旨在开发一个能够预测冲突、估计到达时间，从而在存在噪声和不确定性的情况下，选择更优路径的鲁棒性框架。

### 2. 核心方法和技术创新
本文提出了**冲突感知多智能体到达时间预测（CAMETA）**框架，其核心创新在于一个三层架构：
- **路径规划层**：为单个智能体生成多条备选路径（使用A*算法）。
- **多智能体ETA预测层（核心）**：**提出了一种新颖的异构图表示法和异构图神经网络（GNN）架构**。该层将环境（静态层）和机器人路径（动态层）建模为一个时空异构图，并采用**异构边增强图注意力（HEAT）**算子进行消息传递，以预测所有机器人在给定路径下的ETA。
- **路径选择层**：基于预测的ETA计算每条备选路径的累积成本（考虑时间约束和缓冲时间），并选择最佳路径。

**主要技术创新**：
1. **异构图表示**：将静态环境特征与动态机器人状态分离并关联，有效建模了智能体与环境、智能体与潜在瓶颈区域之间的交互。
2. **可扩展的GNN架构**：支持在推理时适应不同机器人密度，无需重新训练，增强了泛化能力。
3. **直接多步（DMS）预测策略**：相比迭代多步（IMS）策略，有效减少了误差累积，显著提升了ETA预测精度。

### 3. 主要实验结果
- **ETA预测精度**：在模拟仓库环境中，CAMETA的ETA预测层相比不考虑冲突的朴素A*方法，**平均绝对百分比误差（MAPE）降低了44%（DMS策略）和29.5%（IMS策略）**。
- **泛化能力**：在训练集未见的机器人密度下进行测试，模型表现良好，证明了其优秀的泛化性能。
- **全局路径规划性能**：与先进MAPF规划器（CBS, PIBT）在存在执行噪声的环境中进行对比。结果显示：
    - CAMETA在**总成本（SOC）和完工时间（makespan）**上表现稳定且优异，尤其在噪声增加时，其性能下降远小于依赖紧密协调的PIBT方法。
    - 虽然CBS在无噪声时能给出最优解，但其计算耗时极长（数小时），不适用于实时应用；而CAMETA在保持实时性的同时，提供了接近最优且更鲁棒的解决方案。

### 4. 研究意义和价值
本研究的意义和价值在于：
- **实际应用价值**：为无结构化环境（如仓库、机场）中的多机器人系统提供了一个**鲁棒、可扩展且考虑时间约束的全局规划框架**。它通过预测冲突来主动规避拥堵，降低了本地规划器的实时解冲突压力，从而提升了系统在不确定环境下的整体效率和稳定性。
- **方法论贡献**：**首创了将异构图神经网络用于多机器人ETA预测**，为解决缺乏历史数据和固定基础设施场景下的时空序列预测问题提供了新思路。所提出的框架**弥合了传统最优但脆弱的MAPF规划与需要处理执行不确定性的现实部署之间的差距**。
- **未来方向**：工作为后续研究奠定了基础，例如集成更复杂的机器人运动模型、扩展到连续空间以及处理异构机器人团队。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析：CAMETA框架

### **一、 研究目标与核心问题**
本文旨在解决**非结构化环境（如仓库、工厂）中，多移动机器人（AMR）的到达时间（ETA）预测与路径规划问题**。其核心挑战在于：
- **环境无预设结构**：与有固定车道、交通规则的公路不同，室内环境缺乏结构化路网，传统基于历史交通数据的ETA预测方法不适用。
- **多智能体冲突**：多个机器人在共享空间中运行，会产生顶点、边、交换、循环等多种冲突，严重影响ETA的准确性。
- **现实世界的不确定性**：机器人存在不完美的计划执行能力（如噪声、延迟），而传统的多智能体路径寻找（MAPF）方法生成的“紧密协调”路径对此非常敏感，容易导致频繁重规划，效率低下。
- **时间约束与优先级**：在物流等场景中，不同任务有不同紧急程度（优先级），需要满足时间约束。

### **二、 核心创新点**
论文提出了一个名为 **CAMETA** 的三层框架，其创新性主要体现在以下三个方面：

1.  **新颖的框架设计：冲突感知的全局规划器**
    - **三层架构**：将路径规划、ETA预测和路径选择解耦，形成一个协同优化的闭环系统。
        - **第一层（路径规划）**：为单个机器人使用A*等算法生成多条**备选路径**（不考虑其他机器人）。
        - **第二层（多智能体ETA预测）**：**核心创新层**。评估若采用某条备选路径，将对系统中**所有机器人**的到达时间产生何种影响，并预测其ETA。
        - **第三层（路径选择）**：基于第二层的预测结果，计算每条备选路径的**系统总成本**（考虑时间约束和冲突），选择最优路径。
    - **价值**：该框架不直接提供无碰撞路径，而是**通过精准的ETA预测来最小化潜在冲突**，使系统对执行噪声和不确定性更具鲁棒性，降低了本地规划器的解析压力。

2.  **创新的数据表示：异构时空图**
    - **静态层**：表示环境固有结构（如墙壁、开阔地、瓶颈区域），节点类型为`floor`。
    - **动态层**：表示机器人的状态和计划路径，节点类型为`robot`，边类型为`eta`连接机器人与路径经过的`floor`节点。
    - **价值**：这种表示法能同时编码**环境的空间语义**和**机器人的动态时空信息**，为模型理解“何处（where）”、“何时（when）”可能发生拥堵和冲突提供了结构化基础。

3.  **先进的模型架构：用于ETA预测的异构图神经网络**
    - 采用 **HEAT** 算子进行消息传递，增强了标准GAT对节点和边类型的区分能力。
    - 采用 **直接多步（DMS）** 预测策略，为每个预测步长训练独立解码器，避免了迭代多步（IMS）策略中的误差累积问题。
    - **价值**：该模型能够**同时预测所有机器人的ETA**，并显式地建模机器人-环境、机器人-机器人之间的复杂交互。实验表明，其DMS模型比不考虑冲突的朴素方法（A*）在MAPE指标上提升了**44%**。

### **三、 解决方案总结**
1.  **问题重构**：将多机器人ETA预测问题转化为**异构时空图上的边（`eta`边）属性预测问题**。
2.  **方法流程**：
    ```
    环境地图 + 所有机器人初始路径 → 构建异构时空图 → HEAT-GNN模型编码与处理 → DMS解码器预测每条`eta`边的到达时间 → 汇总得到每个机器人的ETA。
    ```
3.  **路径优化**：利用预测的ETA，通过一个**成本函数**（公式2）评估各备选路径。该函数在满足所有机器人时间约束的前提下，最大化“缓冲时间”，从而选择对系统整体流动最有利的路径。
4.  **处理不确定性**：框架**不与特定的完美执行假设绑定**。在训练后的系统评估中引入噪声（强制等待动作），CAMETA表现出比PIBT、CBS等传统MAPF规划器更稳定的性能（平均完成时间和总成本增长更平缓），因为它预留了更多缓冲空间并分散了交通流。

### **四、 实际价值**
- **提升效率与可靠性**：为工业物流中的AMR调度提供了更准确的时间预估，有助于优化任务排序、资源分配，提高整体运营效率。
- **增强系统鲁棒性**：对执行噪声和意外冲突的容忍度更高，减少了系统停滞和频繁全局重规划的需要。
- **良好的可扩展性与泛化性**：GNN模型能够处理不同数量的机器人（密度），无需针对每种场景重新训练，便于在实际部署中动态增减机器人。
- **填补研究空白**：将ETA预测从依赖历史路网数据的结构化交通场景，成功拓展到了无先验结构的动态多机器人场景。


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: 这篇论文旨在解决**非结构化环境中多移动机器人（AMR）的冲突感知到达时间（ETA）预测问题**，以克服传统多智能体路径规划（MAPF）方法在现实场景中因路径执行不完美和环境噪声而导致的性能下降。论文提出了一个名为**CAMETA**的三层框架，其核心创新在于：1）使用**异构地图表示法**（包含静态环境层和动态机器人层）来建模智能体与环境、智能体之间的时空交互；2）设计了一种**异构图神经网络（GNN）架构**，采用直接多步（DMS）预测策略，对系统中所有机器人的ETA进行同步、冲突感知的预测。实验结果表明，该框架的ETA预测精度相比不考虑冲突的朴素方法（A*）平均绝对百分比误差（MAPE）提升了44%；在存在噪声的全局路径规划对比中，CAMETA在整体耗时（SOC）和任务完成时间（makespan）方面均展现出优于PIBT和CBS等先进方法的**鲁棒性和稳定性**，同时保持了实时计算可行性。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## CAMETA论文创新点分析

这篇论文提出了一个名为CAMETA的冲突感知多智能体到达时间预测框架，用于非结构化环境下的移动机器人。其核心创新点主要体现在以下几个方面：

### 1. **提出三层冲突感知全局规划框架**
   - **改进/不同之处**： 传统多智能体路径规划（MAPF）方法（如CBS, PIBT）通常生成紧密协调、必须严格执行的全局路径，对执行误差和噪声非常敏感。CAMETA将规划过程解耦为三个独立层：**路径规划层**（生成候选路径）、**多智能体ETA预测层**（预测所有智能体的到达时间）、**路径选择层**（基于预测选择最佳路径）。
   - **解决的问题/优势**： 该框架将**冲突预测**与**路径执行**分离。它不追求生成绝对无碰撞的路径，而是通过预测冲突对到达时间的影响，为上层选择“冲突较少”或“对系统整体影响更小”的路径。这使得系统对**计划执行不完美**和**环境噪声**具有更强的鲁棒性，避免了传统MAPF方法因微小误差导致频繁重规划的弊端。

### 2. **设计异构时空图表示方法**
   - **改进/不同之处**： 现有ETA预测研究（如Google Maps的GNN模型）主要针对具有固定拓扑结构（如道路网）的交通系统，并使用同构图。CAMETA为室内非结构化环境设计了一种**双层异构图**：
     - **静态层**： 节点为环境中的“地板”区块，包含空间特征（如墙壁、开放区域），边表示空间邻接关系。
     - **动态层**： 节点为“机器人”，边为从机器人节点到其路径所经“地板”节点的“ETA边”，包含时间特征（如预计停留时长、到达时间戳）。
   - **解决的问题/优势**： 这种表示法能够**统一建模环境静态结构**与**机器人动态交互**。它特别捕捉了潜在的**瓶颈区域**（通过“地板”节点）以及**机器人路径之间的时空重叠**（通过“ETA边”），为GNN提供了预测冲突所需的结构化信息基础，解决了非结构化环境中缺乏预定义图拓扑的挑战。

### 3. **提出支持规模泛化的新型GNN架构用于多机器人ETA预测**
   - **改进/不同之处**：
     1. **模型目标**： 以往GNN用于ETA预测时，多为单车辆在固定路网上的预测。CAMETA的GNN**同时预测系统中所有机器人的ETA**，直接建模多智能体间的相互影响。
     2. **架构设计**： 采用**编码-处理-解码**框架，并集成了**异构边增强图注意力（HEAT）算子**。HEAT在消息传递过程中对节点和边特征进行类型特定的变换，比标准GAT更能有效处理异构图数据。
     3. **训练与推理策略**： 论文对比了迭代多步（IMS）和直接多步（DMS）预测策略，最终证明**DMS策略**（为每个预测步长训练独立模型）能有效避免IMS的误差累积问题，在机器人密度高、冲突多时表现更优。
   - **解决的问题/优势**：
     - **实现多智能体联合预测**： 解决了现有方法无法直接扩展到多车场景的问题。
     - **提升预测精度**： 最佳DMS模型将平均绝对百分比误差（MAPE）相比不考虑冲突的朴素A*方法降低了44%。
     - **实现规模泛化**： 模型在训练时接触特定数量的机器人，但在推理时能够**处理不同密度（机器人数量）的场景而无需重新训练**。这得益于图表示和GNN的消息传递机制本质上是与图规模无关的。这为实际部署带来了巨大灵活性，机器人车队可以动态增减。

### 4. **将ETA预测集成于路径决策，优化系统级目标**
   - **改进/不同之处**： 传统MAPF的成本函数通常是路径长度或总步数（SOC）。CAMETA在路径选择层引入了一个**基于时间约束和预测ETA的成本函数**（公式2）。该函数旨在最大化所有机器人“截止时间”与“预测到达时间”之间的缓冲时间，并惩罚缓冲时间短的路径。
   - **解决的问题/优势**： 这使规划器能够主动考虑**时间约束**（这在物流场景中很常见），并选择那些不仅对自身最优，而且能**减少系统总冲突、为不确定性留出余量**的路径。实验表明，在存在噪声时，CAMETA在总成本（SOC）和完工时间（makespan）上比PIBT等传统规划器表现更稳定、更优，因为它生成的路径本身冲突更少，为本地规划器解决意外冲突留下了更多空间。

### 总结
CAMETA的核心创新在于**范式转变**：从“生成必须严格执行的无碰撞路径”转向“预测路径选择对系统整体到达时间和冲突的影响，并据此做出更鲁棒的决策”。其技术实现围绕**异构图表示**和**可泛化GNN预测模型**展开，最终解决了非结构化环境中多机器人系统在**存在执行噪声和不确定性**情况下的高效、鲁棒协同移动问题。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 论文实验与评估效果分析

### 一、 实验目标与整体设计
论文的实验评估分为两个主要部分：
1.  **多智能体ETA预测层性能评估**：验证所提出的图神经网络（GNN）模型在预测到达时间（ETA）方面的准确性和泛化能力。
2.  **全局路径规划框架整体性能评估**：将完整的CAMETA框架与先进的全局多智能体路径规划（MAPF）方法进行对比，评估其在存在噪声和冲突的现实场景下的鲁棒性和效率。

### 二、 数据集与评价指标

#### 1. 数据集
*   **训练数据**：在仿真环境中生成了 **5000个** 独特的仓库环境地图（最大尺寸为100×100米），如图3所示。这些地图被随机放置了 **N = {250, 500, 1000}** 个机器人及其随机目标点。
*   **评估数据**：
    *   **ETA预测评估**：使用与训练集类似但独立的生成地图进行测试。
    *   **全局规划器评估**：使用一个固定的、具有开放空间、走廊和潜在瓶颈的特定地图（图3中蓝色框所示），包含 **500个** 智能体。每个实验重复 **100次** 并采用不同的随机噪声种子，以确保结果的统计稳定性。

#### 2. 评价指标
*   **ETA预测准确性**：
    *   **主要指标**：**平均绝对百分比误差（MAPE）**。因其对相对误差的惩罚机制，对异常值不敏感，是ETA预测任务的常用指标。
    *   **辅助指标**：均方根误差（RMSE）和平均绝对误差（MAE），用于提供更全面的误差视角。
*   **全局路径规划性能**：
    *   **完工时间（Makespan）**：所有机器人完成其任务所需的平均时间。
    *   **总成本（Sum of Cost， SOC）**：所有机器人路径成本（如移动步数）的总和。这是MAPF领域的标准优化指标之一。

### 三、 基线对比方法

#### 1. ETA预测层对比
*   **Naive方法**：使用不考虑任何冲突的 **A*** 算法生成的路径作为基准ETA。这代表了“理想情况”下的预测，但忽略了实际执行中的交互和延迟。
*   **迭代多步（IMS）方法**：训练单步预测模型并迭代生成多步预测的GNN变体。
*   **直接多步（DMS）方法**：直接训练模型进行多步预测的GNN变体。论文比较了在不同机器人密度（250， 500， 1000）下训练的IMS和DMS模型。

#### 2. 全局路径规划框架对比
将完整的**CAMETA**框架与以下先进的全局MAPF规划器进行对比：
*   **A***：作为不考虑任何智能体间冲突的基线方法。
*   **PIBT**：一种牺牲最优性以换取计算效率的次优、完整的MAPF求解器。
*   **CBS**：一种能够找到最优（最小SOC）路径的MAPF求解器，但计算成本高昂。

### 四、 关键性能结果与结论

#### 1. ETA预测层的性能（核心技术创新验证）
*   **显著优于Naive基线**：如表I所示，无论是IMS还是DMS方法，其冲突感知校正都显著降低了所有误差指标（MAPE， RMSE， MAE）。
*   **DMS方法优于IMS方法**：由于IMS存在训练与测试阶段的误差累积问题，**DMS方法在所有测试环境中表现最佳**。最佳DMS模型相比Naive方法，将**平均MAPE降低了44%**；最佳IMS模型也实现了**29.5%的MAPE提升**。
*   **出色的泛化能力**：在“不同机器人密度下的泛化”实验中，模型展现出强大的泛化性能。特别是在高密度（1000机器人）环境下训练的模型，在低密度测试环境中表现良好，反之亦然。这表明模型学习的是通用的冲突交互模式，而非特定密度的特征。**训练于1000机器人环境的DMS模型被证明是最具泛化性的模型。**

#### 2. 全局路径规划框架的性能（实际应用价值体现）
*   **在无噪声理想情况下**：**CBS** 确实产生了最优的SOC，但其计算时间极长（4小时），**不适用于实时应用**。**CAMETA** 和 **PIBT** 在0%噪声水平下表现相当，但CAMETA通过探索冲突更少的替代路径，略优于PIBT。
*   **在存在执行噪声的现实情况下**（图4， 图5）：
    *   **CAMETA展现出卓越的鲁棒性**：随着噪声水平增加（从0%到0.01%），CAMETA的**完工时间（Makespan）和总成本（SOC）增长最为平缓且稳定**。这是因为其规划策略通过选择冲突较少的路径，为本地规划器（WHCA*）处理意外冲突留出了更多“缓冲空间”。
    *   **PIBT性能显著下降**：由于其路径高度协调且紧凑，为冲突预留的“等待”动作在噪声干扰下无法对齐，导致冲突激增，SOC急剧上升。
    *   **A*** 表现稳定但性能较差：虽然对噪声不敏感（因其本就无协调），但其基础性能（高冲突数）远差于CAMETA。
*   **核心结论**：**CAMETA在保持接近实时计算效率（推理时间400-700ms）的同时，在存在不确定性和噪声的环境中，其路径规划的整体鲁棒性和实际性能（完工时间、总成本）显著优于传统的、追求紧协调的全局MAPF规划器（如PIBT）。** 它通过“预测冲突而非完全避免冲突”的策略，与本地规划器形成了有效互补，构建了一个更适应现实不完美执行环境的系统。

### 总结
论文通过系统的实验设计，定量地证明了其两大核心贡献的价值：
1.  **技术创新有效**：提出的异构图表示与GNN架构能够高精度预测多智能体ETA，DMS方法相比不考虑冲突的基线提升达44%。
2.  **实际价值突出**：集成了该预测模块的CAMETA框架，在模拟的真实噪声环境下，相比主流全局规划器，能提供**更稳定、更高效**的路径方案，平衡了规划质量、计算速度和系统鲁棒性，为解决实际物流、仓储场景中的多机器人调度问题提供了有前景的方案。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2503.00074v1)
- [HTML 版本](https://arxiv.org/html/2503.00074v1)
