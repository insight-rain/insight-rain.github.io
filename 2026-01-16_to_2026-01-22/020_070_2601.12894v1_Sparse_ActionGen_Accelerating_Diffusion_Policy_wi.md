# Sparse ActionGen: Accelerating Diffusion Policy with Real-time Pruning

**相关性评分**: 7.0/10

**排名**: #20


---


## 基本信息

- **arXiv ID**: [2601.12894v1](https://arxiv.org/abs/2601.12894v1)
- **发布时间**: 2026-01-19T09:50:36Z
- **相关性评分**: 7.0/10
- **是否相关**: 是

## 作者

Kangye Ji, Yuan Meng, Zhou Jianbo, Ye Li, Hanyun Cui, Zhi Wang

## 关键词

Diffusion, Inference Acceleration, Edge Deployment, fine tune

## 一句话总结

这篇论文提出Sparse ActionGen方法，通过实时剪枝和缓存重用加速扩散策略的动作生成，适用于机器人实时视觉运动控制。

## 摘要

Diffusion Policy has dominated action generation due to its strong capabilities for modeling multi-modal action distributions, but its multi-step denoising processes make it impractical for real-time visuomotor control. Existing caching-based acceleration methods typically rely on $\textit{static}$ schedules that fail to adapt to the $\textit{dynamics}$ of robot-environment interactions, thereby leading to suboptimal performance. In this paper, we propose $\underline{\textbf{S}}$parse $\underline{\textbf{A}}$ction$\underline{\textbf{G}}$en ($\textbf{SAG}$) for extremely sparse action generation. To accommodate the iterative interactions, SAG customizes a rollout-adaptive prune-then-reuse mechanism that first identifies prunable computations globally and then reuses cached activations to substitute them during action diffusion. To capture the rollout dynamics, SAG parameterizes an observation-conditioned diffusion pruner for environment-aware adaptation and instantiates it with a highly parameter- and inference-efficient design for real-time prediction. Furthermore, SAG introduces a one-for-all reusing strategy that reuses activations across both timesteps and blocks in a zig-zag manner, minimizing the global redundancy. Extensive experiments on multiple robotic benchmarks demonstrate that SAG achieves up to 4$\times$ generation speedup without sacrificing performance. Project Page: https://sparse-actiongen.github.io/.

## 详细分析

## 论文摘要：Sparse ActionGen: Accelerating Diffusion Policy with Real-time Pruning

**1. 研究背景和动机**
扩散策略因其强大的多模态动作分布建模能力，已成为机器人动作生成的主流方法。然而，其多步去噪过程带来了巨大的计算负担，导致动作生成频率无法满足实时（如50-1000 Hz）机器人控制的需求。现有的基于缓存的加速方法通常依赖于**静态的、预定义的缓存调度**，无法适应机器人-环境交互过程中的动态变化，导致性能与效率的权衡不佳。

**2. 核心方法和技术创新**
本文提出了**Sparse ActionGen**，一种用于极稀疏动作生成的、适应交互过程的加速方法。其核心创新在于：
- **实时扩散剪枝器**：设计了一个参数化的、以当前观测为条件的剪枝器，能够**在推理前实时预测**整个去噪过程（所有时间步和所有Transformer块）的稀疏模式，实现环境感知的自适应。
- **全局“剪枝-重用”管道**：提出了一种**全局视角的稀疏化损失**，指导剪枝器在严格的计算预算下，非均匀地在时间和块维度分配计算资源。同时，设计了**“一体适用”的重用策略**，以“之字形”方式跨时间步和跨块重用缓存的激活值，最大化减少冗余计算。

**3. 主要实验结果**
在多个机器人操作基准测试（如RoboMimic的Lift、Can、Square等任务及Kitchen多阶段任务）上的实验表明：
- SAG能够剪枝超过**90%** 的计算量，在大多数任务上实现**3.6倍至4倍**的加速，且**性能无损**。
- 在复杂的多阶段Kitchen任务上，SAG实现了**100%的成功率**和**4.03倍的加速**，显著优于所有基线方法（如EfficientVLA, BAC, DDIM等）。
- 消融实验证实了实时剪枝器、全局稀疏损失和“一体适用”重用策略均为关键设计。

**4. 研究意义和价值**
SAG首次将**实时、自适应**的稀疏推理机制引入扩散策略的加速中，解决了静态调度无法适应交互动态的根本局限。其方法不改变原始策略模型参数，通过一个轻量级剪枝器（额外开销<0.3% FLOPs）实现了接近理论极限的加速，为**实时视觉运动控制**提供了切实可行的解决方案，对推动高性能扩散策略在真实机器人系统中的部署具有重要价值。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析：Sparse ActionGen (SAG)

### **一、 核心问题**
论文旨在解决**扩散策略在机器人实时视觉运动控制中的推理速度瓶颈**。
- **背景**：扩散策略因其强大的多模态动作分布建模能力，已成为机器人控制的主流方法。但其生成动作需要多步去噪（如50步），计算开销巨大，导致动作频率（如20 Hz）远低于实时控制需求（50-1000 Hz）。
- **现有方法的局限**：主流的基于缓存的加速方法（如EfficientVLA, BAC）依赖**静态的、预定义的缓存调度策略**。这种策略无法适应机器人-环境交互过程中不断变化的**动态性**，导致在复杂的多步任务中性能与效率的权衡不佳。

### **二、 核心创新点**
SAG 提出了一个**滚动自适应**的稀疏动作生成框架，通过“先剪枝，后重用”的机制，实现极致的计算稀疏化。其创新主要体现在以下三个层面：

#### **1. 实时扩散剪枝器**
- **环境感知的自适应**：摒弃静态调度，设计了一个**参数化的、以当前观测为条件**的剪枝器 `G_ψ`。它能够根据实时环境输入（`o_t`），**提前预测**整个去噪过程（K个时间步 × 3L个Transformer块）的稀疏模式（二进制掩码 `ℳ`），实现动态调整。
- **实时预测的高效设计**：为确保剪枝器自身不引入过大开销，采用了**参数和推理高效**的架构：
    - **单网络、单前向传播**：一个剪枝器服务所有块，一次前向预测整个去噪图的稀疏模式。
    - **时空坐标编码**：将时间步和块索引通过正弦位置编码联合编码，以捕获层次化依赖。
    - **极低开销**：剪枝器的计算开销不到总FLOPs的0.3%。

#### **2. 全局“剪枝-重用”流水线**
- **端到端全局稀疏损失**：引入 `ℒ_sparsity`，在严格的总体计算预算下，**非均匀地**指导剪枝器在不同时间步和不同块之间分配计算资源。这避免了为每个块均匀分配预算的次优策略。
- **“一对多”重用策略**：挑战了现有方法**块级独立缓存**的范式。SAG观察到不同块的激活值之间存在强相似性（跨块冗余），因此设计了一个**共享的全局缓存** `τ`。
    - **“之字形”重用**：激活值可以在不同时间步和不同块之间交叉复用，最大化地减少了全局冗余。

#### **3. 滚动自适应的整体框架**
将上述组件集成到一个两阶段流水线中，与机器人-环境的每一次交互（滚动迭代）紧密耦合：
1.  **剪枝阶段**：在每个滚动迭代开始时，基于当前观测，用实时剪枝器预测并决定剪掉哪些计算。
2.  **重用阶段**：在动作扩散生成过程中，跳过被剪枝的计算，用全局缓存中保存的激活值（通过“一对多”策略）进行替代。

### **三、 解决方案总结**
SAG 通过一个**学习到的、轻量级的、环境感知的实时剪枝器**，动态生成适应交互动态的稀疏模式，再结合一个**全局优化的、跨块跨步的激活重用机制**，在几乎不损失策略性能的前提下，实现了对扩散策略的极致加速。

**核心公式体现了其工作流程**：
```python
# 1. 实时预测稀疏掩码
ℳ = G_ψ(o_t) # ℳ ∈ {0,1}^{K×3L}

# 2. 在扩散生成中，根据掩码决定计算或重用
for each block b at step k:
    if ℳ[k,b] == 1: # 剪枝
        h = h + τ # 重用缓存
    else: # 计算
        d_k^b = Block_b(h)
        τ = d_k^b # 更新缓存
        h = h + d_k^b
```

### **四、 实际价值与效果**
- **性能**：在多个机器人仿真基准测试（Lift, Can, Square, Transport, Tool Hang, Kitchen）上，SAG在**剪除超过90%计算**的情况下，实现了**3.6倍至4倍的加速**，且任务成功率与原始全精度模型相当甚至有所提升。
- **优势**：显著优于所有基线方法（如EfficientVLA, BAC, DDIM, Consistency Policy），在保持高性能的同时达到了最高的加速比，特别是在复杂的多阶段任务（Kitchen）上优势明显。
- **实用性**：为基于扩散模型的VLA大模型在需要高频实时控制的机器人场景中的实际部署，提供了切实可行的加速方案。


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: 这篇论文旨在解决扩散策略（Diffusion Policy）在机器人实时视觉运动控制中因多步去噪过程导致的计算延迟过高、无法满足实时性要求的问题。针对现有基于缓存的加速方法采用**静态调度**、无法适应机器人-环境交互**动态变化**的局限性，论文提出了 **Sparse ActionGen (SAG)** 框架。其核心创新在于设计了一个**滚动自适应（rollout-adaptive）的“先剪枝后重用”机制**：通过一个参数高效、可实时预测的**观测条件化扩散剪枝器**，在每次交互迭代前动态预测并生成全局计算稀疏模式；并配合一种**“一对多”重用策略**，以锯齿形方式跨时间步和模型块全局复用缓存激活值，最大化减少冗余计算。实验表明，该方法能在多个机器人操控基准任务上**无损地剪枝超过90%的计算量**，实现**最高4倍的生成速度提升**，同时保持甚至提升了任务成功率，从而在极稀疏条件下实现了高效、自适应的实时动作生成。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## 论文《Sparse ActionGen: Accelerating Diffusion Policy with Real-time Pruning》的创新点分析

这篇论文针对扩散策略在实时机器人控制中计算开销过大的问题，提出了一种名为**Sparse ActionGen (SAG)** 的自适应加速方法。其核心创新在于摒弃了现有方法中**静态的、固定的**缓存或剪枝策略，转而设计了一个能够**动态适应**机器人-环境交互过程的实时剪枝与重用系统。以下是其相对于已有工作的明确创新点：

### 1. **从静态缓存调度到“滚动自适应”的剪枝-重用机制**
   - **相比以往方法的改进/不同之处**：
     - **以往方法**：如EfficientVLA、BAC等方法，依赖于**离线预定义**的静态缓存调度（例如，每隔固定步数更新缓存）。这种调度在整个任务执行过程中保持不变。
     - **SAG的创新**：提出 **“滚动自适应”的剪枝-重用机制**。在每个交互回合（rollout iteration）开始时，SAG会根据**当前的环境观测**，动态地决定在本次动作生成过程中，哪些计算（特定的去噪步和Transformer块）可以被剪枝。
   - **解决的具体问题/带来的优势**：
     - **解决了静态调度的不适应性**：论文通过实验证明（图1），最优的缓存/剪枝调度会随着机器人任务进程（如接近目标、执行精细操作等不同阶段）而动态变化。静态调度无法适应这种“滚动动态”，导致在复杂或长时程任务中性能下降。
     - **优势**：实现了**环境感知的自适应加速**，使策略能够根据当前任务状态智能分配计算资源，从而在保持高性能的同时实现更高的加速比。

### 2. **参数化的、基于观测的实时扩散剪枝器**
   - **相比以往方法的改进/不同之处**：
     - **以往方法**：基于规则的剪枝方法（如BAC）需要在**前向传播后**分析激活相似性来决定剪枝，这本身引入了额外开销，且无法实现“先验”预测。
     - **SAG的创新**：
       1. **参数化与条件化**：设计了一个可学习的剪枝器网络 `G_ψ`，它**以当前观测 `o_t` 为条件**，直接预测出一个全局的二进制剪枝掩码 `ℳ`。这使其能够学习从环境状态到计算稀疏模式的映射。
       2. **高效的实时设计**：该剪枝器采用**高度参数和推理高效的架构**（如使用Transformer编码器和轻量级MLP），**单次前向传播**即可为所有去噪步和所有块生成剪枝计划，其计算开销仅为总FLOPs的0.3%。
   - **解决的具体问题/带来的优势**：
     - **解决了规则方法的滞后性与开销问题**：实现了**先于推理**的稀疏模式预测，避免了边推理边分析带来的延迟。
     - **优势**：实现了**真正的实时预测**，满足了闭环视觉运动控制对低延迟的严格要求，同时保证了剪枝决策的**环境相关性**。

### 3. **全局视角的“一体适用”重用策略**
   - **相比以往方法的改进/不同之处**：
     - **以往方法**：主流的缓存范式是**块级缓存**，即为每个Transformer块（SA, CA, FFN）维护独立的缓存缓冲区，只在**时间步维度**（跨去噪步）内重用激活。
     - **SAG的创新**：
       1. **跨块重用**：观察到不同块的激活之间存在强相似性（图4a），因此提出 **“一体适用”重用策略**。它为**同一类型的所有块**维护一个**共享的全局缓存缓冲区 `τ`**。
       2. **“之字形”重用**：允许一个时间步、一个块的激活被重用于**另一个时间步的另一个块**（图4b），实现了跨时间和跨块的双维度重用。
   - **解决的具体问题/带来的优势**：
     - **解决了块间冗余被忽视的问题**：传统块级缓存忽略了Transformer层间存在的计算冗余。
     - **优势**：**最大化地减少了全局冗余**，进一步提升了缓存利用效率和加速潜力。在极端稀疏（>90%剪枝率）下，能更有效地用缓存值替代被剪枝的计算，维持动作生成的质量。

### 4. **端到端的全局稀疏损失**
   - **相比以往方法的改进/不同之处**：
     - **以往方法**：一些学习型剪枝方法（如L2C）可能采用逐块或基于重要性得分的局部约束。
     - **SAG的创新**：引入了一个**全局稀疏损失 `ℒ_sparsity`**，直接约束整个剪枝掩码 `ℳ` 的总体稀疏度，使其逼近一个目标剪枝率 `ρ`（如91%）。这相当于在**所有去噪步和所有块**的全局范围内进行预算分配。
   - **解决的具体问题/带来的优势**：
     - **解决了均匀分配计算预算的次优性问题**：在极端剪枝下，均匀分配预算会导致关键计算资源不足。全局损失允许模型**非均匀地、自适应地**将有限的计算资源（即“不剪枝”的机会）分配给更重要的时间步和块。
     - **优势**：这是实现**高性能下极端稀疏（>90%）** 的关键。消融实验表明（表4），移除此损失会导致多个任务性能崩溃至0%，证明了全局资源分配对维持策略保真度的决定性作用。

### 总结：核心技术创新与价值
SAG 的核心创新在于将扩散策略的加速从一个**静态的、局部的**优化问题，转变为一个**动态的、全局的、学习驱动的**控制问题。
- **实际价值**：在多个机器人操纵基准测试（如RoboMimic、Franka Kitchen）和真实世界抓取任务中，SAG在**不更新原始策略模型参数、不损失性能**的前提下，实现了 **3.6倍至4倍的生成速度提升**，并将计算量减少了90%以上。这使其能够满足高自由度机械臂（如Franka）所需的50-1000 Hz实时控制频率，解决了扩散策略在实时部署中的核心瓶颈。
- **技术贡献**：它提供了一套完整的、即插即用的加速框架，其“**滚动自适应剪枝器**”和“**全局重用策略**”为后续动态模型压缩与实时推理研究提供了新思路。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 论文实验与评估效果分析

### 一、 核心实验效果
**Sparse ActionGen (SAG)** 在**不牺牲任务性能**的前提下，实现了**高达4倍的扩散策略（Diffusion Policy）动作生成加速**。具体表现为：
- **计算量削减**：在整条轨迹（rollout）中，剪枝（prune）了超过 **90%** 的计算。
- **速度提升**：在大多数视觉运动（visuomotor）任务上实现了 **3.6× 至 4×** 的端到端加速。
- **性能无损**：在多个复杂任务上，成功率与原始全精度模型持平甚至略有提升。

### 二、 使用的数据集
论文在仿真和真实世界两个层面进行了评估：

1.  **仿真基准（Simulation Benchmarks）**：
    - **RoboMimic 图像数据集**：包含5个机器人操作任务。
        - **Lift**：举起不规则物体。
        - **Can**：抓取圆柱体放入桶中。
        - **Square**：推动物体沿正方形轨迹移动。
        - **Transport**：双手协作搬运锤子。
        - **Tool Hang**：高精度组装挂钩。
    - **数据变体**：
        - **Proficient Human (PH)**：专家演示数据。
        - **Mixed Human (MH)**：专家与非专家混合演示数据。
    - **Franka Kitchen 数据集**：多阶段、长视野的厨房操作任务（如操作微波炉、炉灶、水壶等），评估策略在复杂序列任务中的表现。

2.  **真实世界实验（Real-world Deployment）**：
    - **Pick-and-Release 任务**：使用 Franka Research 3 机械臂，完成抓取、拾起和释放一个圆柱形软袋的任务。

### 三、 主要评价指标
1.  **任务成功率（Success Rate, %）**：核心性能指标，衡量策略完成既定任务的能力。
2.  **加速比（Speedup, ×）**：核心效率指标，通过对比**原始模型与加速后模型的端到端推理时间（wall-clock time）** 计算得出。
3.  **推理频率（Inference Frequency, Hz）**：在真实世界实验中，评估是否满足实时控制要求（如Franka机械臂需要50-1000 Hz）。

### 四、 对比的基线方法
论文与当前最先进的扩散策略加速方法进行了全面对比：

| 方法类别 | 基线方法 | 核心思想/特点 |
| :--- | :--- | :--- |
| **采样加速** | **DDIM** | 更高效的采样器，减少去噪步数。 |
| **缓存加速** | **EfficientVLA** | 采用**静态、均匀**的缓存更新计划。 |
| | **BAC (Block-wise Adaptive Caching)** | 采用**静态、分块**的缓存计划。 |
| **学习型加速** | **L2C (Learning-to-Cache)** | 学习图像生成的缓存计划，迁移到动作生成。 |
| | **Falcon** | 重用上一迭代的部分去噪轨迹。 |
| | **SDP (Streaming Diffusion Policy)** | 通过一致性蒸馏加速。 |
| | **CP (Consistency Policy)** | 将扩散过程蒸馏为极少数（如3步）去噪步骤。 |
| **原始模型** | **Full Precision (DP-T)** | 未加速的原始 Diffusion Transformer 策略。 |

### 五、 关键性能提升与结论
根据论文中的表格数据（表1, 2, 3, 5），可以得出以下核心结论：

1.  **在性能与效率的权衡上全面领先**：
    - **SAG 在几乎所有任务上都达到了与原始全精度模型相当或更高的成功率**，同时实现了接近4倍的加速。
    - 相比之下，其他基线方法要么加速有限（如L2C仅~1.26×），要么在追求高加速时性能严重下降（如CP在15×加速下成功率暴跌）。

2.  **在复杂任务上优势显著**：
    - **在 Kitchen 多阶段任务**（表3）中，SAG 取得了 **100% 的成功率和最高的 4.03× 加速**。而 EfficientVLA 等静态缓存方法在该任务上成功率接近0%，表明其无法适应长视野、多模态的任务动态。
    - **在 Transport 和 Tool Hang 等困难任务**上，SAG 的成功率显著高于大多数基线，证明了其**环境感知自适应**的有效性。

3.  **成功实现实时性**：
    - 在**真实世界 Pick-and-Release 任务**（图5）中，SAG 取得了 **54% 的最高成功率**，同时推理频率达到 **45.1 Hz**，满足了实时交互的要求，而其他方法在成功率或频率上存在短板。

4.  **消融实验验证核心设计**（表4）：
    - **移除实时扩散剪枝器**：使用固定计划，平均成功率下降约6%，证明**动态自适应**的必要性。
    - **移除“一体适用”重用策略**：换用分块缓存，在Transport等任务上成功率骤降至0%，平均下降24%，证明**跨块重用**对减少冗余至关重要。
    - **移除全局稀疏损失**：换用均匀分块预算，导致多个任务完全失败（成功率0%），证明**全局、非均匀的计算资源分配**是实现极高稀疏度（90%+）下保持性能的关键。

**总结**：SAG 通过其**动态环境感知的剪枝器**和**全局优化的一体适用重用策略**，首次在扩散策略上实现了**接近无损的极端稀疏化加速**（>90% 剪枝，~4× 加速），显著优于所有依赖静态计划的现有方法，为扩散模型在实时机器人控制中的应用扫清了一个主要障碍。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2601.12894v1)
- [HTML 版本](https://arxiv.org/html/2601.12894v1)
