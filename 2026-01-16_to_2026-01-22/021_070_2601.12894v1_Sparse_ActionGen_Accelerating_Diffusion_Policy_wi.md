# Sparse ActionGen: Accelerating Diffusion Policy with Real-time Pruning

**相关性评分**: 7.0/10

**排名**: #21


---


## 基本信息

- **arXiv ID**: [2601.12894v1](https://arxiv.org/abs/2601.12894v1)
- **发布时间**: 2026-01-19T09:50:36Z
- **相关性评分**: 7.0/10
- **是否相关**: 是

## 作者

Kangye Ji, Yuan Meng, Zhou Jianbo, Ye Li, Hanyun Cui, Zhi Wang

## 关键词

Diffusion, Inference Acceleration, Edge Deployment, fine tune

## 一句话总结

这篇论文提出Sparse ActionGen，通过实时剪枝和缓存重用机制加速扩散策略的动作生成，适用于机器人实时视觉运动控制。

## 摘要

Diffusion Policy has dominated action generation due to its strong capabilities for modeling multi-modal action distributions, but its multi-step denoising processes make it impractical for real-time visuomotor control. Existing caching-based acceleration methods typically rely on $\textit{static}$ schedules that fail to adapt to the $\textit{dynamics}$ of robot-environment interactions, thereby leading to suboptimal performance. In this paper, we propose $\underline{\textbf{S}}$parse $\underline{\textbf{A}}$ction$\underline{\textbf{G}}$en ($\textbf{SAG}$) for extremely sparse action generation. To accommodate the iterative interactions, SAG customizes a rollout-adaptive prune-then-reuse mechanism that first identifies prunable computations globally and then reuses cached activations to substitute them during action diffusion. To capture the rollout dynamics, SAG parameterizes an observation-conditioned diffusion pruner for environment-aware adaptation and instantiates it with a highly parameter- and inference-efficient design for real-time prediction. Furthermore, SAG introduces a one-for-all reusing strategy that reuses activations across both timesteps and blocks in a zig-zag manner, minimizing the global redundancy. Extensive experiments on multiple robotic benchmarks demonstrate that SAG achieves up to 4$\times$ generation speedup without sacrificing performance. Project Page: https://sparse-actiongen.github.io/.

## 详细分析

## 论文摘要：Sparse ActionGen: Accelerating Diffusion Policy with Real-time Pruning

**1. 研究背景和动机**
扩散策略因其强大的多模态动作分布建模能力，已成为机器人动作生成的主流方法。然而，其多步去噪过程带来了巨大的计算负担，使其难以满足实时（如50-1000 Hz）的机器人控制需求。现有的基于缓存的加速方法通常依赖于**静态的、预定义的缓存调度**，无法适应机器人-环境交互过程中的动态变化，导致性能与效率的权衡不佳。

**2. 核心方法和技术创新**
本文提出了**稀疏动作生成器**，这是一种面向交互过程的、自适应的加速方法。其核心创新在于：
- **实时扩散剪枝器**：设计了一个参数化剪枝器，其输入为当前环境观测，能够**实时预测**整个去噪过程（所有时间步和所有Transformer块）的稀疏计算模式，实现环境感知的自适应。
- **全局“剪枝-重用”机制**：提出了一种**全局视角的稀疏化流程**。首先，通过端到端的全局稀疏损失，在严格的计算预算下非均匀地分配跨时间步和跨块的计算资源。其次，提出了**“一对多”重用策略**，通过维护一个共享缓存，以“之字形”方式跨块和跨时间步重用激活值，最大化减少冗余计算。

**3. 主要实验结果**
在多个机器人操控基准测试上进行评估，结果表明：
- **高效加速**：在剪枝超过90%计算量的情况下，实现了**3.6倍至4倍的生成速度提升**，在复杂的多阶段任务上达到4.03倍加速。
- **无损性能**：在Proficient Human和Mixed Human数据集上，平均成功率分别达到84%和81%，**性能与未加速的完整模型相当甚至略有提升**。
- **显著优势**：相较于DDIM、EfficientVLA、BAC等现有加速方法，SAG在保持最高加速比的同时，取得了最佳或极具竞争力的任务成功率。

**4. 研究意义和价值**
SAG首次将**实时、环境感知的自适应剪枝**引入扩散策略加速领域，突破了静态调度方法的局限性。其提出的全局资源分配与重用范式，为高效稀疏推理提供了新思路。该方法在不修改原始策略模型参数的前提下，实现了**接近无损的显著加速**，极大地推动了扩散策略在需要高频、实时响应的实际机器人系统中的应用，具有重要的实际价值。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析：Sparse ActionGen (SAG)

### **一、 核心问题**
论文旨在解决**扩散策略在机器人实时视觉运动控制中的推理速度瓶颈**。
- **背景**：扩散策略因其强大的多模态动作分布建模能力成为主流，但其多步去噪过程计算开销巨大，无法满足机器人控制所需的高频（如50-1000 Hz）实时响应。
- **现有方法的局限**：基于缓存的加速方法（如EfficientVLA, BAC）通常采用**静态的、预定义的缓存调度策略**。这种策略无法适应机器人-环境交互过程中不断变化的动态特性，导致在保持性能与提升效率之间难以取得最优权衡。

### **二、 核心创新点**
SAG 提出了一个**滚动自适应**的稀疏动作生成框架，其创新主要体现在以下三个紧密关联的方面：

1.  **滚动自适应的实时扩散剪枝器**
    - **问题**：如何动态生成适应每次交互回合动态特性的剪枝计划？
    - **创新解决方案**：
        - **环境感知**：摒弃了基于规则、需要后向分析激活值的方法。提出一个**参数化的剪枝器 `G_ψ`**，其输入是当前环境观测 `o_t`，直接学习从观测到预测稀疏模式的映射。这使得剪枝能根据环境状态实时调整。
        - **实时高效**：为避免引入过大开销，剪枝器采用**高度参数和推理高效的架构设计**。它使用正弦位置编码联合编码时间步和块索引，通过一个Transformer编码器和轻量级MLP，**单次前向传播**即可为整个去噪过程（所有K步和所有3L个块）生成全局剪枝掩码 `M`，开销不到总FLOPs的0.3%。

2.  **全局视角的“剪枝-重用”流水线**
    - **问题**：如何在极端稀疏（如>90%剪枝率）下，全局优化计算资源分配并最大化缓存利用率？
    - **创新解决方案**：
        - **端到端全局稀疏损失**：引入 `L_sparsity` 损失，直接约束整体剪枝率接近目标值 `ρ`。这允许模型在**不同时间步和不同网络块之间非均匀地、动态地分配计算预算**，将资源集中在最重要的计算上。
        - **“一对多”重用策略**：挑战了现有方法中“逐块缓存”的范式。SAG观察到不同块的激活值之间存在强相似性（跨块冗余）。因此，它维护一个**跨所有同类型块共享的全局缓存缓冲区 `τ`**。激活值可以以“之字形”方式在**不同时间步和不同块之间交叉重用**，显著减少了全局冗余。

3.  **“先剪枝，后重用”的协同机制**
    - **整体流程**：在每个滚动迭代中，首先利用实时剪枝器根据当前观测预测剪枝掩码；然后在动作扩散生成过程中，跳过被标记为可剪枝的计算，并用全局缓存中重用的激活值来替代。这两个阶段紧密耦合，共同实现高效加速。

### **三、 解决方法总结**
SAG 通过以下**技术路径**解决了实时加速问题：
1.  **动态适应**：用**观测条件化的学习型剪枝器**替代静态调度，使加速策略能随环境交互动态变化。
2.  **全局优化**：通过**全局稀疏损失**指导资源分配，并通过**跨块/跨步的共享缓存**最大化重用效率，从系统层面减少冗余。
3.  **高效实现**：剪枝器本身设计轻量，确保其预测开销可忽略，从而真正实现净加速。

### **四、 实际价值与效果**
- **性能**：在多个机器人操控基准测试（如RoboMimic、Kitchen）上，SAG在**剪枝超过90%计算量**的情况下，实现了 **3.6× 至 4× 的生成加速**，且**任务成功率与原始全精度模型相当甚至有所提升**。
- **优势**：在相同加速比下，性能显著优于其他SOTA加速方法（如EfficientVLA, BAC, DDIM）。特别是在复杂的多阶段任务（Kitchen）上，展现了优异的适应性和鲁棒性。
- **意义**：使计算密集的扩散策略能够应用于对实时性要求严苛的真实世界机器人控制场景，推动了高性能视觉-语言-动作模型的实际部署。

**简而言之，SAG 的核心是让扩散策略的加速过程从“静态预设”变为“动态智能”，并通过全局优化机制，在极端稀疏下仍能保持高性能，从而解决了实时机器人控制的关键瓶颈。**


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: 这篇论文旨在解决扩散策略（Diffusion Policy）在机器人实时视觉运动控制中，因其多步去噪过程导致的计算延迟过高、无法满足实时性要求的问题。针对现有基于缓存的加速方法采用**静态调度**、无法适应机器人-环境交互**动态变化**的缺陷，论文提出了 **Sparse ActionGen (SAG)** 框架。其核心创新在于设计了一个**基于观测的实时扩散剪枝器**，能够根据当前环境状态动态预测并剪枝冗余计算，并结合一个**全局的“剪枝-重用”机制**（包括端到端的全局稀疏性损失和跨块/跨时间步的“一劳永逸”重用策略），从全局视角优化计算资源分配。实验结果表明，该方法在多个机器人操控基准测试中，能够**无损地剪除超过90%的计算量**，实现**最高4倍的生成速度提升**，同时保持甚至提升了任务成功率，从而在极致的稀疏性下实现了高效、自适应的实时动作生成。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## 论文创新点分析

这篇论文《Sparse ActionGen: Accelerating Diffusion Policy with Real-time Pruning》针对扩散策略在实时机器人控制中计算开销过大的核心瓶颈，提出了一种名为Sparse ActionGen (SAG) 的加速方法。其核心创新点在于摒弃了以往静态、固定的缓存调度策略，转而设计了一个能够**动态适应机器人-环境交互过程**的、全局优化的稀疏推理框架。

以下是其相对于已有工作的明确创新点，以及每个创新点的改进之处和带来的优势：

### 1. **从静态缓存调度到“滚动自适应”的剪枝-重用机制**
   - **改进/不同之处**：
     - **以往方法**：如EfficientVLA、BAC等方法，依赖于**离线预定义**的、**固定不变**的缓存更新计划（例如，每N步更新一次缓存）。这种计划在整个任务执行过程中保持不变。
     - **SAG方法**：提出 **“滚动自适应”的剪枝-重用机制**。在每个交互回合（rollout iteration）开始前，SAG会根据当前的环境观测，**动态地、实时地**决定在即将进行的扩散去噪过程中，哪些计算是冗余的、可以被剪枝的。
   - **解决的问题/带来的优势**：
     - **解决了静态计划与动态环境不匹配的问题**。论文通过实验证明（图1），最优的缓存计划会随着机器人任务执行阶段的不同而显著变化。一个在某个阶段表现优异的静态计划，在其他阶段会导致性能严重下降。
     - **实现了环境感知的自适应**。SAG能够根据当前视觉观测（如物体位置、姿态）来调整计算资源的分配，使加速策略与任务的实际动态紧密耦合，从而在保持高性能的同时实现极致的加速。

### 2. **参数化的、实时预测的扩散剪枝器**
   - **改进/不同之处**：
     - **以往方法**：基于规则的剪枝方法（如BAC）需要在**完整的前向传播后**分析激活值的相似性来决定剪枝，这本身引入了额外开销，且无法做到“先验”预测。
     - **SAG方法**：设计了一个轻量级的、**参数化的剪枝器网络 `G_ψ`**。该剪枝器以**当前观测 `o_t` 为条件**，在扩散推理开始之前，**仅通过一次前向传播**，就预测出整个去噪过程（所有时间步和所有Transformer块）的全局稀疏性模式（一个二进制掩码 `ℳ`）。
   - **解决的问题/带来的优势**：
     - **实现了真正的实时预测**。剪枝决策在计算发生之前完成，避免了规则方法中“先计算后分析”的悖论和开销。
     - **保持了极高的效率**。该剪枝器设计极其轻量（参数量和计算开销不到总FLOPs的0.3%），其引入的额外成本微乎其微，满足了实时控制的要求。
     - **将环境信息编码进剪枝决策**。通过以观测为条件，剪枝器学会了将视觉场景与计算冗余模式关联起来，这是静态或规则方法无法做到的。

### 3. **全局视角的“以一替全”重用策略**
   - **改进/不同之处**：
     - **以往方法**：主流的块级缓存范式为**每个计算块（如SA、CA、FFN）维护独立的缓存**，只允许在**时间步维度**上重用本块的激活值。
     - **SAG方法**：提出了 **“以一替全”的重用策略**。它维护一个**跨块的共享缓存缓冲区**。当某个块在某个时间步的计算被剪枝时，SAG会从共享缓存中取出最近计算出的激活值（可能来自**不同块**或**不同时间步**）来替代，形成一种“之字形”的跨块、跨时间步重用模式。
   - **解决的问题/带来的优势**：
     - **挖掘并利用了被忽视的块间冗余**。论文通过可视化分析发现（图4a），不同Transformer块之间的激活值存在高度相似性。传统块独立缓存策略完全忽略了这部分冗余。
     - **最大化缓存利用效率，减少缓存误差**。共享缓存机制允许更有价值的激活值被更广泛地重用，从而在同等剪枝率下，能更好地保持原始模型的输出保真度，提升了加速的“质量”。

### 4. **端到端的全局稀疏性损失函数**
   - **改进/不同之处**：
     - **以往方法**：一些学习型剪枝方法（如L2C）采用**逐块约束**，为每个块分配均匀的计算预算，或者需要后处理算法来选择重要的计算单元。
     - **SAG方法**：引入了 **`ℒ_sparsity` 全局稀疏性损失**。该损失直接约束整个预测掩码 `ℳ` 的**总体稀疏率**，使其逼近一个目标值（如91%）。它不对单个块做均匀限制。
   - **解决的问题/带来的优势**：
     - **实现了计算资源的非均匀、全局最优分配**。在固定的总计算预算下，该损失引导剪枝器将宝贵的计算资源（即“不剪枝”的机会）动态地分配给那些对当前任务更重要的时间步和模型块。消融实验表明（表4），移除该损失会导致性能灾难性下降，因为它无法在极端稀疏（>90%）下做出智能取舍。
     - **简化了训练流程**。无需复杂的逐块调度或后处理，通过一个简单的全局约束即可实现高效的资源分配。

### **总结：核心技术创新价值**
SAG的创新是一个**系统性**的进步，它从**动态适应性**、**预测实时性**、**冗余挖掘全局性**三个层面，系统性地解决了扩散策略实时化的难题。它不是对单个组件的微小改进，而是提出了一套新的、以“**滚动自适应**”和“**全局优化**”为核心的加速范式。

- **实际价值**：在多个机器人操控基准测试中，SAG在**不更新原有扩散策略模型参数、不损失任务性能**的前提下，实现了**3.6倍至4倍**的动作生成加速，计算量减少超过90%。这使得原本无法满足实时控制频率（如20Hz）的扩散策略，能够逼近或达到机器人控制所需的高频率（50-1000Hz），极大地提升了其在实际机器人系统中的部署可行性。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 论文实验与评估效果总结

### 一、 核心效果
**Sparse ActionGen (SAG) 在保持任务性能（成功率）基本无损的前提下，实现了对 Diffusion Policy 推理过程的显著加速。**
- **核心加速比**：在多个机器人操控任务上实现了 **3.6× 至 4.0×** 的生成速度提升。
- **计算削减**：在动作生成过程中，**剪枝（Prune）了超过 90% 的计算量**。
- **性能保持**：在绝大多数任务上，成功率与原始全精度模型（Full Precision）相当甚至略有提升，实现了 **“无损加速”**。

### 二、 使用的数据集
论文在仿真和真实世界两个层面进行了评估：

1.  **仿真基准（Simulation Benchmarks）**：
    - **RoboMimic 图像数据集**：包含5个机器人操作任务。
        - **Lift**：举起不规则物体。
        - **Can**：抓取圆柱体放入箱子。
        - **Square**：推动物体沿正方形轨迹移动。
        - **Transport**：双手协调搬运锤子。
        - **Tool Hang**：高精度挂钩组装。
    - **数据来源**：使用了 **Proficient Human (PH)** 和 **Mixed Human (MH)** 两种演示数据集，后者包含非熟练操作者的数据，更具挑战性。
    - **Franka Kitchen 数据集**：一个多阶段、长视野的厨房任务，要求机器人按任意顺序操作多个物体（微波炉、炉灶、开关、水壶）。

2.  **真实世界实验（Real-world Experiment）**：
    - **任务**：抓取-拾取-释放一个圆柱形软袋。
    - **平台**：Franka Research 3 机械臂，搭载 NVIDIA RTX 4090D GPU。

### 三、 评价指标
1.  **主要指标**：
    - **任务成功率 (%)**：在固定随机种子下，多次运行任务的成功率平均值和标准差。这是衡量策略性能的核心指标。
    - **加速比 (Speedup)**：相对于原始全精度 Diffusion Policy 的 **推理时间（延迟）的减少倍数**。论文通过测量 **wall-clock time** 计算。
    - **推理频率 (Hz)**：在真实世界实验中，评估了每秒能生成动作的次数，这对实时控制至关重要。

2.  **辅助分析**：
    - **剪枝率可视化**：展示了不同 rollout 迭代和不同任务下，剪枝器预测的稀疏模式（哪些时间步、哪些模块被跳过）。
    - **冗余分析**：通过计算激活值之间的余弦相似度，可视化证明了跨时间步和跨模块的冗余是存在的，为“一对多重用”策略提供了依据。

### 四、 对比的基线方法
论文与多类先进的 Diffusion Policy 加速方法进行了全面对比：

1.  **采样加速**：
    - **DDIM**：一种更高效的采样器，减少去噪步数（K=30）。
2.  **缓存/重用加速**：
    - **EfficientVLA**：采用**静态、均匀**的缓存更新计划。
    - **BAC**：采用**静态、分块**的缓存计划。
    - **Falcon**：重用前一步迭代的部分去噪轨迹。
    - **SDP (Streaming Diffusion Policy)**：基于规则的重用方法。
3.  **蒸馏/压缩加速**：
    - **CP (Consistency Policy)**：通过一致性蒸馏将模型压缩到极少的去噪步（K=3）。
    - **L2C**：一种从图像生成领域迁移过来的学习型层缓存方法。
4.  **基准模型**：
    - **Full Precision**：未加速的原始 Diffusion Policy (DP-T)。

### 五、 关键性能提升与结论
实验结果在论文的 **表1、表2、表3 和 图5** 中集中展示，主要结论如下：

| 对比维度 | SAG 表现 | 关键结论 |
| :--- | :--- | :--- |
| **vs. 静态缓存方法 (EfficientVLA, BAC)** | **成功率更高或相当，加速比领先。** 例如在复杂的 Kitchen 任务上，SAG 成功率 100%，加速比 4.03×；而 EfficientVLA 成功率暴跌至 0-20%。 | **证明了动态自适应剪枝的必要性。** 静态计划无法适应 rollout 动态，在复杂或动态任务上性能严重下降。 |
| **vs. 蒸馏方法 (CP)** | **在相近加速比下，成功率远高于 CP。** CP 虽然加速比极高（~15×），但成功率损失巨大（许多任务接近0%）。 | **在追求极致加速时，SAG 的“剪枝-重用”范式比“蒸馏”范式能更好地保真度。** |
| **vs. 其他重用方法 (Falcon, SDP)** | **取得了更好的速度-精度权衡。** SAG 的加速比（~3.7×）高于 Falcon (~1.2-2.8×) 和 SDP (~1.7×)，且成功率保持更好。 | **细粒度的、全局优化的剪枝和跨模块重用策略更有效。** |
| **整体表现** | 在 **PH**、**MH** 和 **Kitchen** 数据集上，SAG 的**平均成功率分别达到 84%、81% 和 100%**，同时实现了 **3.6× 到 4.0× 的加速**。 | **SAG 在广泛的任务和数据集上，实现了当前最佳的速度-精度平衡。** |
| **真实世界验证** | 在抓取释放任务中，SAG 取得了 **最高的成功率（54%）** 和 **第二高的推理频率（45.1 Hz）**，证明了其在实际机器人控制中的有效性和实时性。 | **方法具备从仿真到真实世界的迁移能力。** |

### 六、 消融实验验证
论文通过消融实验（表4）定量验证了其三个核心设计的有效性：
1.  **实时扩散剪枝器**：替换为固定计划后，平均成功率下降约6%。
2.  **一对多重用策略**：换回传统的分块重用策略后，在部分任务（如 Transport）上成功率崩溃，平均下降显著。
3.  **全局稀疏损失**：替换为均匀的分块损失后，模型性能发生**灾难性下降**（多个任务成功率为0%），证明了**非均匀地全局分配计算预算至关重要**。

**总结**：SAG 通过创新的 **“环境感知实时剪枝”** 和 **“全局一对多重用”** 机制，成功解决了现有静态加速方法在动态机器人-环境交互中适应性不足的问题，在多个标准测试和真实任务上实现了 **接近4倍的无损加速**，为 Diffusion Policy 在实时机器人控制中的应用扫除了关键的速度障碍。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2601.12894v1)
- [HTML 版本](https://arxiv.org/html/2601.12894v1)
