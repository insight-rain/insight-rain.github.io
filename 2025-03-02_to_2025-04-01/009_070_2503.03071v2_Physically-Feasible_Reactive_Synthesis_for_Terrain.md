# Physically-Feasible Reactive Synthesis for Terrain-Adaptive Locomotion via Trajectory Optimization and Symbolic Repair

**相关性评分**: 7.0/10

**排名**: #9


---


## 基本信息

- **arXiv ID**: [2503.03071v2](https://arxiv.org/abs/2503.03071v2)
- **发布时间**: 2025-03-05T00:21:23Z
- **相关性评分**: 7.0/10
- **是否相关**: 是

## 作者

Ziyi Zhou, Qian Meng, Hadas Kress-Gazit, Ye Zhao

## 关键词

Robot control, quadruped robot locomotion, Edge Deployment, local observational information

## 一句话总结

该论文提出了一种基于轨迹优化和符号修复的四足机器人地形自适应运动规划框架，通过高层管理器和局部环境信息处理动态不可行性，实现安全关键环境中的快速反应。

## 摘要

We propose an integrated planning framework for quadrupedal locomotion over dynamically changing, unforeseen terrains. Existing approaches either rely on heuristics for instantaneous foothold selection--compromising safety and versatility--or solve expensive trajectory optimization problems with complex terrain features and long time horizons. In contrast, our framework leverages reactive synthesis to generate correct-by-construction controllers at the symbolic level, and mixed-integer convex programming (MICP) for dynamic and physically feasible footstep planning for each symbolic transition. We use a high-level manager to reduce the large state space in synthesis by incorporating local environment information, improving synthesis scalability. To handle specifications that cannot be met due to dynamic infeasibility, and to minimize costly MICP solves, we leverage a symbolic repair process to generate only necessary symbolic transitions. During online execution, re-running the MICP with real-world terrain data, along with runtime symbolic repair, bridges the gap between offline synthesis and online execution. We demonstrate, in simulation, our framework's capabilities to discover missing locomotion skills and react promptly in safety-critical environments, such as scattered stepping stones and rebars.

## 详细分析

## 论文摘要

### 1. 研究背景和动机
四足机器人在动态变化、不可预知的地形（如碎石、钢筋网）上进行自适应运动是一项关键挑战。现有方法要么依赖启发式落脚点选择，牺牲了安全性与通用性；要么求解计算昂贵的长时间轨迹优化问题，难以在线部署。**核心问题**在于如何同时保证运动的安全性、物理可行性以及在线反应的计算效率。

### 2. 核心方法和技术创新
本文提出一个**集成规划框架**，将**形式化方法**与**轨迹优化**相结合，核心创新点包括：
- **分层架构**：结合**反应式综合**（Reactive Synthesis）与**混合整数凸规划**（MICP）。高层使用线性时序逻辑（LTL）生成**构造即正确**的符号化策略；底层使用MICP为每个符号化状态转移提供**物理可行性证明**。
- **可扩展性优化**：
    - **高层管理器**：利用局部环境信息进行**部分求值**，将综合问题的状态变量减少80.9%-90.1%。
    - **符号化修复**：仅在必要时通过修复建议生成新的运动技能，将昂贵的无步态MICP求解次数减少71.7%-97.6%。
- **在线鲁棒性**：在线执行时，使用真实地形数据重新求解MICP，并结合**运行时修复**机制，处理离线未预见的地形或执行失败，弥合了离线综合与在线执行的差距。

### 3. 主要实验结果
在仿真中（Gazebo，Unitree Go2/SkyMul Chotu机器人）验证了框架在**非结构化地形**（8种地形）和**钢筋网地形**（14种类型）上的有效性：
- **离线综合**：符号化修复成功解决了93.4%的地形-目标状态对，且修复时间随问题规模线性增长。
- **在线执行**：
    - 在线MICP求解时间约430毫秒至2.65秒。
    - 成功演示了处理**未预见地形**（如遇到离线未考虑的沟壑）和**求解失败**（因实际地形与预定义形状差异）的能力，通过运行时修复生成新的跳跃步态或重新规划路径。

### 4. 研究意义和价值
- **理论价值**：创新性地将形式化验证（反应式综合）与数值优化（MICP）深度融合，为腿部机器人运动规划提供了兼具**形式化安全保证**和**物理可行性**的新范式。
- **实用价值**：通过多层次的可扩展性设计（高层管理器、符号修复、两阶段优化），显著降低了复杂地形下运动规划的计算负担，使机器人能在**安全关键环境**中实时、安全地做出反应，推动了四足机器人在复杂现实场景（如灾难救援、建筑施工）中的应用潜力。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析

### **研究问题**
论文旨在解决**四足机器人在动态变化、不可预知的复杂地形（如散落的垫脚石、钢筋网）上，进行安全、自适应运动规划**的核心挑战。现有方法存在两大局限：
1.  **启发式方法**：依赖瞬时落脚点选择的启发式规则，缺乏安全性和通用性的形式化保证。
2.  **纯优化方法**：直接求解长时域、复杂地形特征的轨迹优化问题（如混合整数规划，MIP），计算负担沉重，难以在线部署。

### **核心创新点**
本文提出了一种**集成式分层规划框架**，将**形式化方法（反应式合成）** 与**物理优化（混合整数凸规划，MICP）** 相结合，核心创新体现在**方法论融合**和**两级处理流程**上。

#### **1. 方法论融合：符号引导的物理可行性验证**
- **高层（符号层）**：使用**线性时序逻辑（LTL）进行反应式合成**，生成“构造即正确”的控制器。它将连续环境抽象为离散网格和符号状态（如机器人位置、地形类型、请求目标），并规划出满足任务规约的符号动作（技能）序列。
- **底层（物理层）**：为高层规划的**每一个符号状态转移（技能）**，调用一次**混合整数凸规划（MICP）** 进行物理可行性验证与轨迹生成。该MICP模型考虑了单刚体动力学、接触力、摩擦锥、执行器限位等约束，为每个技能提供“可行性证书”。
- **创新价值**：这种结合将长时域、复杂的全局运动规划问题，分解为一系列短时域、简单的符号转移验证问题，**通过符号引导显著降低了MICP的求解规模和时间**。

#### **2. 两级处理流程：离线与在线协同**
框架明确分为**离线合成**和**在线执行**两个阶段，分别针对可预知和不可预知的情况进行优化。

- **离线合成阶段**：
    - **输入**：先验地形信息、局部目标、预定义步态。
    - **关键技术**：
        - **高层管理器**：根据机器人局部环境信息（当前地形、目标），对完整的LTL规约进行**部分求值**，大幅缩减合成所需的状态空间（实验减少80.9%-90.1%）。
        - **符号修复**：当初始技能集无法满足任务规约（即合成失败）时，自动**仅建议缺失的必要符号转移**，然后仅对这些新转移调用计算昂贵的**无固定步态MICP**来生成新步态。这避免了枚举所有可能转移，将昂贵MICP求解次数减少了71.7%-97.6%。

- **在线执行阶段**：
    - **输入**：实时感知的地形、在线目标、离线合成的策略库。
    - **关键技术**：
        - **在线MICP重解**：执行每个符号转移前，使用**实时地形数据**和**固定步态**重新求解一个高效的MICP，生成精确的轨迹，以弥合离线抽象与在线实际情况的差距。
        - **运行时修复**：当遇到**未预知的地形/目标**或**在线MICP求解失败**时，触发在线符号修复过程，生成新技能并更新策略，实现对新环境的持续适应。

### **解决方案总结**
论文通过一个**“符号规划 (Reactive Synthesis) + 物理验证 (MICP)”** 的集成框架，并辅以**“离线预计算 (含修复) + 在线重规划 (含修复)”** 的两级流程，系统性地解决了复杂地形自适应运动规划中的**安全性（形式化保证）、动态可行性（物理验证）和计算效率（符号引导与修复）** 三大核心问题。

**实际价值**：该框架使四足机器人能够在安全关键场景（如灾后废墟、建筑工地）中，实时、安全地穿越高度非结构化的动态环境，并具备发现和运用新运动技能（如跳跃）的能力，显著提升了腿式机器人的自主性与环境适应性。


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: 这篇论文旨在解决四足机器人在动态变化、不可预知地形上实现**安全、高效且具有物理可行性保证**的适应性运动规划问题。现有方法要么依赖缺乏安全保证的启发式落脚点选择，要么求解计算代价高昂的长时域轨迹优化问题。

为此，论文提出了一个**集成式规划框架**，核心创新在于将**形式化方法（反应式综合）** 与**物理优化（混合整数凸规划，MICP）** 相结合。该框架通过高层符号抽象和反应式综合生成“构造即正确”的控制器，并为每个符号级动作（技能）调用MICP来验证其动态可行性并生成具体步态。为了提升可扩展性，框架引入了**高层管理器**来缩减综合问题的状态空间，并利用**符号修复**技术来最小化昂贵的MICP求解次数。在执行阶段，通过结合实时地形数据的在线MICP和运行时修复，弥合了离线规划与在线执行之间的差距。

仿真实验表明，该方法能显著降低计算负担（符号修复减少71.7%-97.6%的昂贵MICP求解，管理器减少80.9%-90.1%的状态变量），使机器人能够在散落踏脚石、钢筋等安全关键环境中，自主发现缺失的运动技能并做出快速、安全的反应，证明了框架在保证运动可行性和安全性方面的有效性。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## 论文创新点分析

这篇论文提出了一种结合**反应式综合（Reactive Synthesis）**与**混合整数凸规划（MICP）**的四足机器人地形自适应运动规划框架。其核心创新在于通过**分层与修复机制**，在保证物理可行性与形式化安全性的同时，显著提升了复杂地形下长时程规划的计算效率与在线反应能力。

以下是论文相对于已有工作的明确创新点及其分析：

---

### 1. **集成反应式综合（符号层）与MICP（物理层）的两层规划框架**
- **改进/不同之处**：
    - **以往方法**：主流方法分为两类：(a) 依赖启发式规则进行瞬时落脚点选择，缺乏安全性与形式化保证；(b) 直接求解长时程、包含复杂地形特征的轨迹优化问题（如完整MIP），计算负担重，难以在线部署。
    - **本文方法**：将问题分解为**符号层**与**物理层**。符号层使用**线性时序逻辑（LTL）进行反应式综合**，生成“构造即正确”的高层策略；物理层为每个符号层状态转移求解一个**短时程、小规模的MICP**，提供物理可行性证明。
- **解决的问题/优势**：
    - **形式化保证**：通过反应式综合，确保高层策略满足任务规约（如安全性与活性要求）。
    - **计算效率**：将单一复杂的长时程MIP问题分解为多个小规模MICP问题，每个只需考虑单个状态转移，**显著降低了计算复杂度**，使在线部署成为可能。
    - **解耦与复用**：符号层策略可复用，物理层验证可并行化，提高了框架的灵活性与可扩展性。

### 2. **引入高层管理器（High-Level Manager）与部分评估（Partial Evaluation）以提升综合可扩展性**
- **改进/不同之处**：
    - **以往方法**：直接对包含全部环境信息（地形、目标）的大规模状态空间进行综合，由于综合算法的时间复杂度随变量数指数增长，导致效率低下。
    - **本文方法**：设计了一个**高层管理器**，基于机器人当前的**局部环境信息**（局部地形与中间目标）对任务规约进行**部分评估**。即，将规约中与当前局部环境相关的命题替换为其真值，从而**大幅减少综合时需要处理的变量数**。
- **解决的问题/优势**：
    - **状态空间爆炸**：论文实验表明，该管理器能将变量数量减少 **80.9% - 90.1%**，极大缓解了综合的计算负担。
    - **在线适应性**：允许综合过程专注于当前最相关的环境部分，使系统能高效应对动态变化的局部场景。

### 3. **采用离线符号修复（Symbolic Repair）机制，最小化昂贵MICP求解次数**
- **改进/不同之处**：
    - **以往方法**：为了确保规约的可实现性，可能需要穷举所有可能的符号状态转移并为每个求解MICP（包括计算昂贵的“无固定步态MICP”），成本极高。
    - **本文方法**：在离线综合阶段，当发现某个局部规约因物理不可行而无法实现时，**不穷举所有可能转移**，而是启动**符号修复过程**。该过程自动分析规约，**仅建议那些缺失但必要的符号转移**，然后仅为这些建议的转移调用昂贵的“无固定步态MICP”来生成新步态。
- **解决的问题/优势**：
    - **计算成本优化**：避免了为大量物理不可行或不必要的转移进行昂贵计算。实验显示，符号修复将需要求解的昂贵MICP次数减少了 **71.7% - 97.6%**。
    - **自动技能发现**：能够自动发现机器人缺失的运动技能（如新的跳跃步态），并仅为其生成物理可行的轨迹，增强了系统的自主性与适应性。

### 4. **设计在线执行与运行时修复（Runtime Repair）机制，弥合离线合成与在线执行的差距**
- **改进/不同之处**：
    - **以往方法**：离线生成的计划可能因在线地形感知误差、未预见地形或目标变化而失败，通常缺乏快速、系统的恢复机制。
    - **本文方法**：
        1.  **在线MICP重规划**：在线执行每个符号转移时，会**使用实时感知的地形数据重新求解一个“固定步态MICP”**，生成精确的轨迹，以应对离线与在线地形的差异。
        2.  **运行时修复**：当遇到**未预见的地形/目标**，或在线MICP求解失败时，系统触发**运行时修复**。该过程类似于离线修复，但基于实时环境，快速合成新的技能与策略。
- **解决的问题/优势**：
    - **应对不确定性**：有效处理了离线先验知识与在线现实世界之间的差异，提升了系统在**动态、未知环境中的鲁棒性**。
    - **保证在线可行性**：通过在线重规划确保每个动作的物理可行性，通过运行时修复保证高层策略的持续有效性，实现了**安全关键环境下的连续穿越能力**。

### 5. **两阶段分层MICP策略：离线“无固定步态”与在线“固定步态”**
- **改进/不同之处**：
    - **以往方法**：通常在线上下文中使用同一种优化模型，要么过于复杂（无固定步态）难以在线求解，要么过于简化（固定步态）限制灵活性。
    - **本文方法**：
        - **离线阶段**：使用**无固定步态MICP**，同时优化接触状态和落脚点选择，以探索和生成新的、复杂的运动技能（如跨越间隙的跳跃）。
        - **在线阶段**：使用**固定步态MICP**，基于离线生成的步态序列，仅优化落脚点和动力学轨迹。此问题规模更小、更易快速求解。
- **解决的问题/优势**：
    - **平衡探索与利用**：离线阶段允许充分探索复杂的运动可能性，在线阶段则保证高效、可靠的轨迹生成。
    - **满足实时性要求**：在线固定步态MICP平均求解时间在数百毫秒到数秒内（取决于场景），满足了四足机器人实时控制的需求。

---

## 总结
该论文的核心创新在于**通过精巧的分层、抽象与修复机制，将形式化方法（反应式综合）与数值优化（MICP）深度融合**，创造性地解决了**地形自适应动态运动规划中“形式化安全保证”、“物理可行性”与“计算效率”三者难以兼顾**的经典难题。其贡献不仅是提出一个新框架，更在于提供了一套系统性的方法，来管理规划问题的复杂性，并使其能适应动态、不确定的现实环境。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 论文实验与评估效果分析

根据论文内容，该研究主要通过在**Gazebo仿真环境**中进行案例研究来评估所提出的集成规划框架。论文**未使用标准化的公开数据集**，也**未与现有的基线方法进行直接的定量性能对比**。其评估重点在于**概念验证和框架能力展示**，而非严格的量化基准测试。

### 一、 评估场景与设置
论文在两个具有挑战性的仿真场景中测试了框架：
1.  **非结构化地形场景**：使用Unitree Go2机器人。地形被抽象为8种类型（平坦、高地形、低地形、密集/稀疏踏脚石、缝隙、高/低缝隙）。
2.  **钢筋网地形场景**：使用SkyMul Chotu（改装版Unitree Go1）机器人。地形根据钢筋在水平（垂直于机器人朝向）和垂直方向的稀疏程度进行分类，构成7种或14种地形类型。

**网格抽象**：测试了 `3x3` 和 `5x5` 两种局部网格大小，以评估不同规划视野和决策复杂度下的表现。

### 二、 主要评价维度与效果
由于缺乏与基线方法的对比，论文的效果评估主要通过框架自身的运行数据和能力演示来体现，主要集中在以下几个方面：

#### 1. **离线合成的效率与可扩展性**
- **评价指标**：符号修复时间、混合整数凸规划求解次数与时间、可成功处理的（地形，请求目标）状态对比例。
- **关键结果**：
    - **符号修复有效性**：修复过程成功解决了 **93.4%** 的不可实现（地形，请求目标）状态对。其余无法修复是因为目标被障碍物阻挡或物理不可达。
    - **计算负担大幅降低**：
        - **高层管理器**通过局部环境信息将合成问题的变量数减少了 **80.9% - 90.1%**。
        - **符号修复**通过仅生成必要的技能，将昂贵的“无步态固定MICP”求解次数减少了 **71.7% - 97.6%**（相比穷举所有可能的符号转移）。
    - **可扩展性**：修复时间随（地形，请求目标）状态对数量线性增长。`5x5`网格的平均修复时间比`3x3`网格多 **478.1%**，但仍在可接受范围内。

#### 2. **在线执行的鲁棒性与反应能力**
- **评价指标**：在线MICP求解时间、处理未预见情况的能力（运行时修复）、任务完成成功率（定性）。
- **关键结果**：
    - **在线求解效率**：
        - 非结构化地形案例：在线（步态固定）MICP平均求解时间为 **430毫秒**。
        - 钢筋网地形案例：平均求解时间为 **1.1秒**（因地形多边形更多、更复杂）。
        - 启用碰撞避免（处理高度变化）时，求解时间增加至 **2.65秒**。
    - **处理未预见情况**：
        - **未预见地形状态**：如图6所示，当离线未考虑“缝隙”地形时，在线遇到后触发**运行时修复**（耗时12.36秒，其中符号修复0.18秒，无步态MICP 12.18秒），成功生成新的跳跃步态并跨越缝隙。
        - **求解失败与重规划**：由于离线与在线地形多边形存在形状/尺寸差异，可能导致在线MICP求解失败。框架能通过将失败转移标记为“不允许”，并触发**运行时重合成**（耗时约0.1秒），利用其他现有技能重新规划路径（如图4(c)(d)中的绿色绕行路径），成功抵达目标。
    - **运动技能发现**：框架能够自动发现并利用复杂的运动技能，例如用于跨越缝隙或从低地形到高地形的**短空翻跳跃步态**。

### 三、 与基线方法的对比及定量结果的缺失
论文**明确指出了现有方法的局限性**（依赖启发式、计算昂贵、缺乏形式化保证），但**并未进行直接的、量化的性能对比**（例如，与纯MIP方法、基于采样的方法或启发式方法在相同场景下的计算时间、成功率、路径长度等指标进行比较）。

**可能原因分析**：
1.  **方法新颖性**：该工作提出的是一个全新的、结合形式化方法与优化方法的集成框架，其直接可比的传统基线可能较少。
2.  **评估重点**：作者更侧重于展示框架的**核心创新点**（形式化保证、物理可行性证书、分层修复机制）在实际复杂场景中的**工作流程和能力**，而非纯粹的数值性能比拼。
3.  **实现复杂性**：在仿真中完全复现并公平对比其他基于MIP或复杂优化的方法可能存在较大工程挑战。

### 四、 主要结论
基于仿真实验，论文得出以下结论：
1.  **框架有效**：所提框架能够为四足机器人在动态变化、未预见的地形上生成**安全、物理可行且反应迅速**的 locomotion 策略。
2.  **可扩展性提升**：通过高层管理器和符号修复，显著缓解了反应式合成和混合整数规划固有的计算可扩展性问题。
3.  **在线鲁棒性强**：通过在线MICP重规划和运行时修复机制，有效弥合了离线合成与在线执行之间的差距，能够处理地形差异和未预见情况。
4.  **通用性良好**：框架在两种不同的机器人平台（Go2, Chotu）和两种差异显著的地形场景（非结构化踏脚石、钢筋网）上均成功演示。

**总结**：该论文的实验评估以**定性演示和框架自身关键指标的定量分析**为主，强有力地证明了其**方法创新性和系统有效性**，但在**与现有先进方法的直接量化性能对比**方面存在不足。这通常是此类提出新范式的研究在初期阶段的常见情况，其价值更多体现在思路的创新和系统集成上。未来的硬件验证和更广泛的基准测试将是重要的下一步工作。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2503.03071v2)
- [HTML 版本](https://arxiv.org/html/2503.03071v2)
