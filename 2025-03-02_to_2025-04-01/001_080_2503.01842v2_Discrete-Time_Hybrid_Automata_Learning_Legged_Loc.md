# Discrete-Time Hybrid Automata Learning: Legged Locomotion Meets Skateboarding

**相关性评分**: 8.0/10

**排名**: #1


---


## 基本信息

- **arXiv ID**: [2503.01842v2](https://arxiv.org/abs/2503.01842v2)
- **发布时间**: 2025-03-03T18:59:23Z
- **相关性评分**: 8.0/10
- **是否相关**: 是

## 作者

Hang Liu, Sangli Teng, Ben Liu, Wei Zhang, Maani Ghaffari

## 关键词

Robot control, quadruped robot locomotion, multi-agent RL, CTDE methods, Edge Deployment, mujoco, local observational information

## 一句话总结

该论文提出了一种离散时间混合自动机学习框架，用于四足机器人滑板任务，结合强化学习，但未明确涉及多智能体RL、CTDE方法、边缘部署或Mujoco。

## 摘要

Hybrid dynamical systems, which include continuous flow and discrete mode switching, can model robotics tasks like legged robot locomotion. Model-based methods usually depend on predefined gaits, while model-free approaches lack explicit mode-switching knowledge. Current methods identify discrete modes via segmentation before regressing continuous flow, but learning high-dimensional complex rigid body dynamics without trajectory labels or segmentation is a challenging open problem. This paper introduces Discrete-time Hybrid Automata Learning (DHAL), a framework to identify and execute mode-switching without trajectory segmentation or event function learning. Besides, we embedded it in reinforcement learning pipeline and incorporates a beta policy distribution and a multi-critic architecture to model contact-guided motions, exemplified by a challenging quadrupedal robot skateboard task. We validate our method through sufficient real-world tests, demonstrating robust performance and mode identification consistent with human intuition in hybrid dynamical systems.

## 详细分析

## 论文《离散时间混合自动机学习：足式运动遇见滑板》详细摘要

### 1. 研究背景和动机
混合动力系统（同时包含连续流和离散模式切换）是机器人学中建模接触事件（如足式机器人步态）的关键框架。现有方法通常依赖预定义步态或需要轨迹分割，难以在无标签、高维复杂系统中学习模式切换。本文旨在解决这一开放性问题，提出一种无需轨迹分割或事件函数学习的框架，以处理高度动态、接触丰富的混合系统，并以极具挑战性的四足机器人滑板任务作为验证场景。

### 2. 核心方法和技术创新
本文提出了**离散时间混合自动机学习（DHAL）**框架，其核心创新包括：
- **离散混合自动机框架**：将混合动力系统建模为离散时间切换系统，通过一个**模式选择器**（DHA）自动识别当前动态模式，无需人工标注或分割。
- **集成VAE与强化学习**：采用β-VAE对每个模式的动态进行编码和解码，预测状态转移和接触事件，并将学习到的动态隐表示嵌入到强化学习策略中。
- **多评论家架构与Beta分布策略**：针对滑板任务中“滑行”与“蹬地”两种不同风格的接触引导运动，设计了**多评论家**框架，分别评估不同阶段的奖励。同时，采用**Beta分布**作为策略分布，有效利用有界动作空间，避免了高斯策略在边界处产生的偏差。

### 3. 主要实验结果
- **动态预测与模式识别**：实验表明，DHAL框架（模式数≥2）比单一动态模型预测损失更低。在真实机器人部署中，系统能自动识别出“滑板上滑行”、“空中过渡”、“地面蹬地”三种直观的运动模式，且隐空间呈现清晰的模式分离。
- **滑板任务性能**：在仿真和真实世界的多种地形（平地、地毯、斜坡、台阶）上，采用DHAL（结合多评论家与Beta分布）的策略成功实现了稳健的滑板运动，性能优于单评论家或高斯策略的基线方法，并展示了良好的抗干扰与恢复能力。

### 4. 研究意义和价值
本工作首次将离散混合自动机学习无缝嵌入强化学习流程，为学习**无标注、高维混合动力系统**提供了一种通用框架。所展示的四足机器人滑板任务，验证了该框架在高度欠驱动、接触复杂的现实场景中的有效性和鲁棒性。这项工作推动了数据驱动的混合系统控制发展，为机器人学习多样化的接触引导技能（如灵巧操作、复杂移动）开辟了新途径。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析：《离散时间混合自动机学习：足式运动与滑板相遇》

### **一、 论文拟解决的核心问题**

论文瞄准**混合动力系统**在机器人控制中的核心挑战。这类系统同时包含连续状态流和离散模式切换（例如，足式机器人的腿部触地/腾空）。现有方法存在两大瓶颈：

1.  **模型依赖与泛化性差**：基于模型的方法（如MPC）通常依赖预定义的步态和简化模型，难以适应复杂、非结构化的接触场景。
2.  **数据驱动方法的局限性**：基于学习的方法（如强化学习）虽能处理复杂动态，但普遍**缺乏对系统内在离散模式切换的显式建模和识别能力**。现有混合系统学习方法通常需要**预先对轨迹进行分段标注**或学习复杂的切换事件函数，这在高维、复杂的刚体动力学系统中（如四足机器人滑滑板）是难以获取且计算成本高昂的。

**因此，论文的核心问题是：如何在不依赖轨迹分段标注或事件函数学习的前提下，让机器人自主地学习、识别并执行混合动力系统中的模式切换？**

### **二、 核心技术创新点**

论文提出了 **“离散时间混合自动机学习”** 框架，包含三大核心技术创新：

#### **1. 离散时间混合自动机框架**
- **是什么**：一个集成到强化学习流程中的神经网络模块，用于**在线、无监督地识别系统的离散运行模式**。
- **怎么工作**：
    - **模式选择器**：输入一段历史状态-动作序列，通过一个分类网络输出一个**独热编码**，指示当前时刻系统处于哪个离散模式（如“滑行”、“蹬地”、“空中过渡”）。
    - **模式专属动力学模型**：为每个预设的模式配备一个独立的 **β-VAE**，用于编码该模式下的动态特征并预测下一时刻的状态和接触信息。
    - **无监督训练**：通过最小化所有模式专属VAE的**整体状态预测误差**来训练。正确的模式选择会带来更低的预测损失，从而驱动模式选择器自动学习出有物理意义的模式分类，**无需任何模式标签**。
- **关键优势**：**免除了耗时的轨迹预分割和事件标注**，实现了端到端的混合动力学学习与识别。

#### **2. 面向接触引导任务的多评论家架构与Beta分布策略**
- **问题**：滑板任务包含“滑行”和“蹬地”两种差异巨大的运动模式，其奖励信号稀疏性与密度不同。单一评论家难以平衡学习。
- **解决方案**：
    - **多评论家架构**：为“滑行”、“蹬地”和“仿真到现实”三个任务目标分别设立独立的评论家网络。每个评论家专注于评估对应奖励组的价值，最后将归一化后的优势函数加权求和，用于策略更新。
    - **Beta分布策略**：摒弃了在有限动作空间中会产生偏差的高斯策略。采用**Beta分布**作为策略输出分布，其天然有界性（`[0,1]`）经过缩放后完美匹配机器人关节限位，避免了动作裁剪带来的梯度偏差，在稀疏奖励下能更安全、有效地利用整个动作空间进行探索。

#### **3. 高度欠驱动混合任务的仿真到现实迁移**
- **挑战**：四足机器人滑滑板是一个**高度欠驱动、接触复杂、动态性极强的混合系统**。机器人只有12个关节可主动控制，却要协调自身和滑板（具有被动轮和桥架结构）的运动。
- **解决方案**：
    - **精心设计的仿真环境**：对滑板的卡车（桥架）进行物理建模，并添加模拟滚动摩擦的补偿力，以逼近真实物理。
    - **系统的仿真到现实技术**：在训练中引入大量的动力学随机化（质量、质心、摩擦、延迟、传感器噪声等）和鲁棒性奖励项（如动作平滑、扭矩变化惩罚）。
    - **框架的有效性**：DHAL框架学习到的**显式模式表征**和**多风格策略**，使得控制器能根据识别出的模式（如“滑行”）调用相应的动态知识，从而在真实世界的扰动下（不平地面、坡道、单级台阶）表现出惊人的鲁棒性和恢复能力（如图1所示，即使卡住也能跳回滑板）。

### **三、 实际价值与验证**

1.  **验证任务**：选择**四足机器人滑滑板**作为验证平台。该任务完美集成了混合动力系统的所有难点：明显的模式切换（蹬地 vs. 滑行）、丰富的接触序列、高度欠驱动。
2.  **实验结果**：
    - **模式识别符合直觉**：在真实机器人上，学习到的模式（通过LED颜色显示）与人类观察到的运动阶段（滑行、空中过渡、蹬地）高度一致。
    - **性能优越**：在多种真实地形（瓷砖、地毯、斜坡、台阶）上的测试表明，完整方法（DHAL+多评论家+Beta策略）的成功率显著高于消融版本（单评论家、高斯策略）和基线方法。
    - **动力学预测更准**：实验证明，采用混合动力学建模（模式数>1）比单一动力学模型具有更低的**状态预测误差**。
    - **泛化性**：框架在倒立行走、灵巧手递物等其它混合任务上也展示了有效的模式识别能力。

### **四、 总结**

| 核心问题 | 传统方法局限 | DHAL 解决方案 | 实际价值 |
| :--- | :--- | :--- | :--- |
| **无标注学习混合系统模式切换** | 需要轨迹分段/事件函数 | **离散混合自动机 + β-VAE**，无监督学习模式 | 降低数据准备成本，实现端到端混合控制 |
| **处理接触引导的多风格运动** | 单一评论家难以平衡稀疏/密集奖励 | **多评论家架构**，分离评估不同运动目标 | 简化奖励设计，自然生成复杂、分阶段的运动技能 |
| **在有限动作空间中进行安全高效探索** | 高斯策略因裁剪引入偏差 | **Beta分布策略**，天然有界，无偏差 | 提升训练稳定性与安全性，利于仿真到现实 |
| **实现复杂欠驱动任务的仿真到现实** | 模型简化或仿真不实导致迁移失败 | **系统随机化 + 混合动力学嵌入** | 在极具挑战性的真实世界滑板任务中实现鲁棒、敏捷的性能 |

**总而言之**，这篇论文的**核心贡献**在于提出了一套完整的、数据驱动的框架（DHAL），首次实现了对高维复杂混合动力系统**无需标注的模式识别与控制**，并通过**多评论家架构**和**Beta分布策略**解决了与之相关的多风格学习与探索难题，最终在一个标志性的高难度机器人任务上完成了从仿真到现实的验证，为学习型混合系统控制开辟了新路径。


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: 这篇论文旨在解决**混合动力系统（如足式机器人）中，无需轨迹分割或事件标签，即可在线识别与执行模式切换的开放性问题**。为此，论文提出了 **“离散时间混合自动机学习”（DHAL）框架**，该框架将混合自动机与变分自编码器（VAE）结合，通过一个模式选择器无监督地学习离散模式，并激活对应的动态模块来预测状态转移和接触事件。为了处理滑板这类接触引导的复杂任务，作者还将该框架嵌入强化学习流程，并引入了**多评论家架构**和**Beta分布策略**来优化稀疏奖励下的探索与控制。最终，该方法在四足机器人滑板这一高度欠驱动、混合动态的任务上，成功实现了**从仿真到现实的鲁棒迁移**，其学习到的模式切换与人类直觉一致，并在多种真实世界扰动下展现了稳健的性能。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## 论文《Discrete-Time Hybrid Automata Learning: Legged Locomotion Meets Skateboarding》的创新点分析

这篇论文针对混合动力系统（Hybrid Dynamical Systems）的学习与控制，提出了一套名为**离散时间混合自动机学习（DHAL）** 的完整框架，并将其应用于极具挑战性的四足机器人滑板任务。其核心创新点明确且具有深度，具体如下：

---

### 1. **提出了无需轨迹分割或事件标注的离散时间混合自动机（DHA）框架**
- **改进/不同之处**：
    - **以往方法**：大多数基于学习的混合动力系统建模方法（如 Neural Hybrid Automata）需要**预先对训练轨迹进行分段（segmentation）**，以标注不同的动态模式（mode），或者需要学习显式的切换事件函数。这严重依赖先验知识或人工标注，且难以扩展到高维复杂系统。
    - **本文方法**：提出的 DHA 框架将**模式选择器（mode selector）** 和**各模式的动态模型**集成在一个统一的、基于 β-VAE 的架构中。模式选择器通过一个**离散分类器**，以前瞻的状态-动作序列为输入，**在线、无监督地**识别当前系统所处的模式，而无需任何预先的轨迹分割或模式标签。
- **解决的问题与优势**：
    - **解决了“标注瓶颈”问题**：消除了对昂贵、困难甚至不可能获取的模式标签的依赖，使方法能直接应用于真实世界的复杂机器人数据。
    - **实现了在线模式识别**：系统能在运行过程中实时识别动态模式，为控制器提供了明确的模式信息，增强了策略的可解释性和适应性。
    - **与强化学习流程自然集成**：该框架被设计为可嵌入强化学习（RL）流程，模式选择器的训练仅依赖于动态预测损失，与策略优化（PPO）的梯度更新解耦，保证了训练稳定性。

### 2. **针对接触引导的混合任务，设计了多评论家（Multi-Critic）架构与Beta分布策略**
- **改进/不同之处**：
    - **多评论家架构**：
        - **以往方法**：在RL中，通常使用单一评论家（Critic）来估计所有奖励项的价值。对于包含稀疏奖励（如特定接触事件）和密集奖励（如速度跟踪、正则化）的复杂任务，稀疏奖励的信号容易被稀释，导致策略难以学习到特定的行为模式。
        - **本文方法**：设计了**三个独立的评论家**，分别对应**滑行（Gliding）**、**蹬地推动（Pushing）** 和**仿真到现实迁移（Sim2Real）** 三组奖励。各评论家独立估计其对应奖励的价值，最终的优势函数（Advantage）是三者归一化后的加权和。
    - **Beta分布策略**：
        - **以往方法**：机器人 locomotion 任务中，策略通常采用**高斯分布（Gaussian Distribution）** 来输出动作。在动作空间有硬性边界（如关节位置限制）时，采样到的越界动作需要被裁剪（clip），这会引入策略梯度估计的**偏差（bias）**，并可能导致方差爆炸，在稀疏奖励环境下尤其有害。
        - **本文方法**：采用**Beta分布**作为策略分布。Beta分布天然定义在有界区间（如[0,1]），通过线性变换可映射到机器人的实际动作范围。这确保了所有采样动作都在有效范围内，**从根本上避免了裁剪带来的梯度偏差**。
- **解决的问题与优势**：
    - **多评论家架构**：
        - **解决了奖励信号冲突问题**：使策略能同时、均衡地学习不同风格（如平稳滑行与主动蹬地）的行为，降低了奖励函数设计的敏感性。
        - **促进了多风格运动学习**：在滑板任务中，成功引导机器人学会了周期性的“蹬地-滑行”交替模式，行为更加自然、鲁棒。
    - **Beta分布策略**：
        - **提供了无偏差、有界的探索**：在稀疏奖励的接触引导任务中，策略能更安全、高效地利用整个动作空间进行探索，避免了高斯策略因试图探索边界外区域而导致的危险或不稳定行为。
        - **提升了训练稳定性与硬件安全性**：从源头防止了产生可能导致硬件损坏的极端关节指令，更利于仿真到现实的直接部署。

### 3. **在高度欠驱动与混合动态的滑板任务上，实现了鲁棒的仿真到现实（Sim2Real）迁移**
- **改进/不同之处**：
    - **以往方法**：针对四足机器人的研究大多集中于传统行走、跑动或复杂地形穿越。将四足机器人控制与滑板这种**被动、欠驱动、动态接触复杂**的对象结合，是一个新颖且极具挑战性的任务范式。先前工作（如双足机器人玩Hovershoes）通常依赖简化模型或大量假设。
    - **本文方法**：首次系统性地使用**基于学习的框架**让四足机器人（Unitree Go1）学会滑滑板。任务本身完美体现了混合动力系统的特性（滑行模式 vs. 蹬地模式），且对平衡、时机和接触控制的要求极高。
- **解决的问题与优势**：
    - **验证了框架在极端场景下的有效性**：滑板任务作为一个“试金石”，成功验证了DHAL框架在识别模式（如空中切换、单腿支撑、双腿滑行）、处理接触不连续性和学习复杂动态方面的能力。
    - **展示了卓越的鲁棒性和泛化能力**：经过充分仿真训练的策略，在真实世界中能够应对**多种干扰和复杂地形**，包括地毯、坡道、台阶、不平整地面，甚至能在部分失足后恢复平衡。论文提供了详实的成功率统计数据（见表III），证明了其超越基线方法的性能。

### 4. **提供了直观且一致的模式识别可视化验证**
- **改进/不同之处**：
    - **以往方法**：学习到的混合动力系统内部模式往往是黑箱，难以解释其是否与物理直觉相符。
    - **本文方法**：通过在机器人身上用**不同颜色的LED灯实时显示DHA识别出的当前模式**，并与关节角度变化曲线对照，直观展示了模式切换与运动阶段（滑行、空中过渡、蹬地）的**高度一致性**。同时，对控制器隐层进行t-SNE可视化，显示了不同模式对应的状态在隐空间中形成了清晰的聚类。
- **解决的问题与优势**：
    - **增强了方法的可解释性**：证明了学习到的混合自动机并非随意划分，而是捕捉到了任务中物理意义明确的离散动态阶段。
    - **为系统调试和信任提供了依据**：这种透明性有助于研究者理解系统决策过程，并相信其识别结果的合理性。

---

**总结**：本文的核心创新在于**方法论层面**的突破——它提供了一个**端到端、无监督**学习混合动力系统并实现**精细控制**的通用框架（DHAL）。该框架通过**离散混合自动机**解决了模式识别的难题，通过**多评论家+Beta分布**解决了复杂接触任务中的策略优化难题，并最终在一个**新颖且极具挑战性的机器人滑板任务**上进行了成功验证，实现了从仿真到现实的鲁棒迁移。这些创新点共同推动了数据驱动的混合系统控制向更复杂、更实用的方向发展。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 实验与评估效果总结

该论文通过一系列仿真和真实世界实验，验证了所提出的**离散时间混合自动机学习（DHAL）框架**在四足机器人滑板任务上的有效性。实验设计旨在回答三个核心问题，并展示了方法在模式识别、动态预测和鲁棒控制方面的优势。

### 1. 使用的数据集与评价指标
- **数据集**：论文**未使用**外部标准数据集。所有数据均在**仿真环境（Isaac Gym）** 中生成，并通过**Sim2Real**流程部署到真实的Unitree Go1四足机器人上进行测试。
- **评价指标**：
    - **动态预测精度**：使用**均方误差（MSE）** 比较预测状态 `o_{t+1}` 与真实状态的差异。
    - **模式识别一致性**：通过**可视化分析**（如关节轨迹图、t-SNE降维）和**人类直觉对齐**来评估自动机识别的离散模式是否合理。
    - **任务成功率**：在多种真实世界场景（平滑地面、地毯、斜坡、单步、不平坦地形）中，统计机器人成功完成至少一个完整“上板-滑行-下板”循环的次数。
    - **训练回报曲线**：比较不同方法在训练过程中的平均累积奖励。

### 2. 对比的基线方法
论文与以下方法进行了对比：
1.  **PPO-oracle-beta**：使用**全部特权观测信息**（包括滑板状态）和Beta分布策略的PPO算法，作为性能上限参考。
2.  **DreamWaq [27]**：一种学习动态模块来估计速度和未来观测的模型。
3.  **PPO-curiosity [48, 10]**：仅使用本体感知并遵循好奇心奖励设计的PPO算法。
4.  **单评论家方法（Single-critic）**：
    - `Single-critic-wo-transfer`：使用与多评论家相同的奖励配置和权重。
    - `Single-critic-w-transfer`：基于多评论家的优势权重，对单评论家的奖励权重进行了迁移调整。
5.  **高斯策略方法（Ours-wo-Beta）**：将DHAL框架中的Beta分布策略替换为传统的高斯分布策略。

### 3. 关键性能结果与结论

#### **Q1: 混合动态系统建模是否优于单一动态模型？**
- **结果**：如图6所示，当最大模式数 `|δ| = 1`（即单一动态模型）时，动态预测的**重建损失最高**。引入混合动态建模（`|δ| >= 2`）后，预测损失显著下降。当 `|δ| >= 3` 时，改进趋于平缓。
- **结论**：对于存在接触突变等特性的系统（如滑板任务），将其建模为**混合动态系统更为合理**。实验确定最大模式数为3是此任务的最优选择，对应滑板上的滑行、板下推地和空中过渡三种运动模式。

#### **Q2: 方法能否有效识别滑板运动模式？**
- **结果**：
    - **可视化验证**：如图7所示，在真实部署中，系统通过RGB灯条颜色（红/蓝/绿）指示不同模式。模式切换平滑且**与物理直觉高度一致**（红色=滑行，绿色=空中过渡，蓝色=推地）。
    - **隐空间分析**：对控制器隐层输出进行t-SNE降维（图8），结果显示不同模式的数据在隐空间中形成了**清晰分离的簇**，证明了DHAL模块能准确区分不同模式。
- **结论**：DHAL框架能够**无监督地、准确地识别**出与任务语义相符的离散运动模式，无需轨迹分割或事件标注。

#### **Q3: 方法能否在真实世界干扰下完成滑板任务？**
- **结果**：
    - **训练性能**：如图9所示，DHAL方法（结合多评论家和Beta分布）的训练回报与拥有特权信息的 `PPO-oracle-beta` 相当，并显著优于 `DreamWaq`、`PPO-curiosity` 及使用高斯分布的策略。
    - **策略质量对比**：如图10所示，与两种单评论家方法相比，DHAL（多评论家）产生的运动**更平滑、自然**，能高效执行快速推地和稳定的上下板转换。单评论家方法要么动作激进易受干扰，要么姿态不自然。
    - **真实世界成功率**：如表III所示，在多种具有挑战性的真实地形上进行了定量测试（每种场景10次试验）。
        - **DHAL（完整方法）** 在平滑地面和地毯上达到 **100%** 成功率，在斜坡、单步和不平坦地形上分别达到 **80%、100%、60%** 的成功率。
        - **单评论家方法** 性能显著下降，特别是在复杂地形上（如 `Our-wo-MC` 在斜坡上成功率为0%）。
        - **高斯策略方法（Ours-wo-Beta）和 DreamWaq** 在真实世界中**完全失败**（✗），产生了危险动作或无法完成任务。
- **结论**：DHAL框架结合多评论家架构和Beta分布策略，能够实现**鲁棒的Sim2Real迁移**，在存在传感器噪声、地形变化等真实干扰下，成功完成高动态、欠驱动的滑板任务。

### 4. 核心结论
- **技术创新价值**：DHAL首次将**离散时间混合自动机**与**强化学习流水线**无缝集成，实现了**无需标注或分割的混合模式识别与预测**。
- **实际应用价值**：通过极具挑战性的“机器狗滑滑板”任务验证，该方法为处理**接触丰富、模式切换频繁**的机器人混合动态控制问题（如复杂移动操作、多模态 locomotion）提供了一种有效的学习框架。其**模式识别结果符合人类直觉**，增强了系统的可解释性。
- **性能优势**：在动态预测精度、模式识别准确性和真实世界任务成功率上，均**显著优于**现有的单一动态模型方法、传统高斯策略以及单评论家RL方法。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2503.01842v2)
- [HTML 版本](https://arxiv.org/html/2503.01842v2)
