# Safe Distributed Learning-Enhanced Predictive Control for Multiple Quadrupedal Robots

**相关性评分**: 8.0/10

**排名**: #3


---


## 基本信息

- **arXiv ID**: [2503.05836v1](https://arxiv.org/abs/2503.05836v1)
- **发布时间**: 2025-03-06T14:33:49Z
- **相关性评分**: 8.0/10
- **是否相关**: 是

## 作者

Weishu Zhan, Zheng Liang, Hongyu Song, Wei Pan

## 关键词

Robot control, quadruped robot locomotion, multi-agent RL, CTDE methods, Edge Deployment, mujoco, local observational information

## 一句话总结

该论文提出了一种用于多四足机器人编队控制的分布式模型预测控制框架，结合了控制李雅普诺夫函数和控制屏障函数以确保稳定性和安全性，并通过高保真仿真和真实实验验证了其有效性。

## 摘要

Quadrupedal robots exhibit remarkable adaptability in unstructured environments, making them well-suited for formation control in real-world applications. However, keeping stable formations while ensuring collision-free navigation presents significant challenges due to dynamic obstacles, communication constraints, and the complexity of legged locomotion. This paper proposes a distributed model predictive control framework for multi-quadruped formation control, integrating Control Lyapunov Functions to ensure formation stability and Control Barrier Functions for decentralized safety enforcement. To address the challenge of dynamically changing team structures, we introduce Scale-Adaptive Permutation-Invariant Encoding (SAPIE), which enables robust feature encoding of neighboring robots while preserving permutation invariance. Additionally, we develop a low-latency Data Distribution Service-based communication protocol and an event-triggered deadlock resolution mechanism to enhance real-time coordination and prevent motion stagnation in constrained spaces. Our framework is validated through high-fidelity simulations in NVIDIA Omniverse Isaac Sim and real-world experiments using our custom quadrupedal robotic system, XG. Results demonstrate stable formation control, real-time feasibility, and effective collision avoidance, validating its potential for large-scale deployment.

## 详细分析

## 论文摘要

### 1. 研究背景和动机
四足机器人因其在非结构化环境中的卓越适应性，在编队控制领域具有巨大潜力，可应用于灾难救援、物资运输等场景。然而，在动态障碍物、通信限制和复杂腿部运动学的约束下，实现**稳定编队**与**无碰撞导航**面临重大挑战。现有方法（如传统MPC、CBF或RL）在实时性、安全性或可扩展性方面存在不足。本文旨在为多四足机器人系统设计一个兼具**理论安全保证**与**实时可行性**的分布式编队控制框架。

### 2. 核心方法和技术创新
本文提出了一个**安全分布式学习增强预测控制**框架，主要技术创新包括：
- **分布式MPC-CLF框架**：将分布式模型预测控制（DMPC）与控制李雅普诺夫函数（CLF）结合，在局部决策的同时，**理论证明了编队误差能收敛至零**，确保了编队稳定性。
- **尺度自适应置换不变编码（SAPIE）**：为解决动态变化的邻居数量与顺序问题，提出一种新颖的编码机制。它通过共享非线性变换与对称池化（如max pooling），将可变数量的邻居状态编码为固定长度的特征向量，确保了控制策略的**置换不变性**与**可扩展性**。
- **基于神经网络的SAPIE-CBF**：将SAPIE与深度神经网络结合，学习去中心化的控制屏障函数（CBF），以动态适应多智能体交互，**形式化地保证了安全集的前向不变性**，实现了碰撞避免。
- **低延迟通信与死锁解决**：开发了基于**数据分发服务（DDS）** 的点对点通信协议，保障实时协调。同时，设计了**事件触发死锁解决机制**，通过微调名义状态而非控制输入，在狭窄空间或复杂地形中有效解除运动停滞。

### 3. 主要实验结果
研究通过高保真仿真与实物实验进行了全面验证：
- **仿真验证**：在NVIDIA Omniverse Isaac Sim中构建数字孪生，模拟了密集障碍物环境（5台机器人）和动态交叉路径场景。结果表明，系统能**稳定保持编队**、**有效避障**，并在交叉路口成功**检测并解除死锁**。
- **实物验证**：在自定义四足机器人平台“XG”上进行了双机编队实验。机器人成功绕开动态障碍物（办公椅）并保持队形，验证了DDS通信与控制框架的**实时性与鲁棒性**。此外，该框架在另一款不同物理特性的四足平台上未经重新标定即成功运行，展示了良好的**跨平台泛化能力**。

### 4. 研究意义和价值
本工作为多四足机器人编队控制提供了一个**安全、可扩展、实时可行**的解决方案。其核心价值在于：
- **理论贡献**：通过MPC-CLF与学习型CBF的结合，在复杂动力学系统上同时提供了**稳定性与安全性的形式化保证**。
- **工程贡献**：提出的SAPIE机制、DDS通信协议及死锁解决策略，**有效解决了实际部署中的关键瓶颈**（如动态拓扑、实时通信、运动停滞）。
- **应用前景**：框架在仿真与实物中的成功验证，以及其跨平台特性，为其在**大规模异构机器人集群**的实际部署（如仓储物流、野外勘探）奠定了坚实基础。代码已开源，有助于推动领域发展。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析

### **一、 研究问题**
本文旨在解决**多足机器人编队控制**在**复杂动态非结构化环境**中面临的核心挑战：
1.  **稳定性与安全性难以兼顾**：在保持编队稳定的同时，实现与动态障碍物、队友之间的实时、无碰撞导航。
2.  **系统动态性与可扩展性**：机器人邻居数量动态变化、通信拓扑结构改变，传统方法难以处理这种“排列不变性”和特征维度不匹配问题。
3.  **实时性与死锁问题**：分布式模型预测控制计算负担重，影响实时性；严格的安全约束（如控制屏障函数）在狭窄空间易导致系统陷入死锁，所有机器人停滞。

### **二、 核心解决方案与创新点**
论文提出了一个名为 **“安全分布式学习增强预测控制”** 的集成框架，其核心由四大创新技术构成：

#### **1. 分布式MPC-CLF框架（保证稳定性）**
- **是什么**：将**分布式模型预测控制**与**控制李雅普诺夫函数**相结合，作为高层控制器。
- **怎么解决**：
    - **DMPC**：每个机器人仅与邻居通信并进行本地优化，实现可扩展的分布式决策。
    - **CLF约束**：在MPC优化问题中嵌入CLF约束，**理论上证明了编队跟踪误差能指数收敛到零**（见Lemma 1），确保了编队稳定性。
    - **分层控制**：高层DMPC输出期望速度/位姿，底层由学习到的步行策略（Walk-These-Ways）执行，解耦了复杂全身动力学与编队控制。

#### **2. 尺度自适应排列不变编码（SAPIE）（处理动态邻居）**
- **是什么**：一种用于编码动态变化邻居信息的神经网络模块。
- **怎么解决**：
    - **排列不变性**：无论邻居的输入顺序如何，编码输出保持不变。
    - **尺度自适应性**：通过共享权重网络处理每个邻居状态，然后使用**行方向最大池化**进行聚合，输出固定长度的特征向量。这样，无论邻居数量是3个还是10个，都能生成统一的编码。
    - **价值**：使后续的安全模块能够鲁棒地处理实时变化的通信拓扑和团队规模，这是实现大规模部署的关键。

#### **3. 基于神经网络的SAPIE-CBF（保证安全性）**
- **是什么**：将SAPIE编码与**深度神经网络**、**控制屏障函数**结合，构建一个可学习的分布式安全滤波器。
- **怎么解决**：
    - **神经网络近似CBF**：用一个神经网络 `h_i(x_i, o_i)` 来近似复杂的、依赖于多邻居的安全约束函数。
    - **专用损失函数训练**：损失函数包含三部分，分别强制：
        1.  安全状态下的CBF值为正。
        2.  不安全状态下的CBF值为负。
        3.  满足CBF的向前不变性条件（即安全集内状态始终安全）。
    - **与MPC-CLF协同**：对MPC-CLF计算出的名义控制输入 `u_hat` 进行微调，得到最终安全控制输入 `u_check`，使其在尽量跟踪编队指令的同时，绝对满足安全约束。

#### **4. 事件触发的死锁解决机制**
- **是什么**：一种检测并主动解除机器人因安全约束冲突而陷入停滞的机制。
- **怎么解决**：
    - **死锁检测**：定义一个事件触发指标 `E_i`，当控制目标与安全约束冲突且机器人速度为零时，判定为死锁。
    - **智能解脱**：**不直接修改控制输入**（以免破坏底层步态稳定性），而是**对MPC的参考状态（名义状态 `x_hat`）施加一个受控的扰动**（通过变换矩阵 `T`）。
    - **效果**：轻微改变机器人的目标位置，从而打破对称性冲突，使优化问题重新有解，让机器人恢复运动，同时保持MPC-CLF的稳定性框架。

### **三、 技术集成与验证**
- **系统集成**：上述四个核心组件被集成到一个统一的分布式控制架构中（如图4所示）。每个机器人本地运行MPC-CLF优化器（负责稳定）和SAPIE-CBF神经网络（负责安全），并通过事件触发机制处理死锁。
- **全面验证**：
    1.  **高保真仿真**：在NVIDIA Omniverse Isaac Sim中构建数字孪生，在密集障碍物、狭窄通道等复杂场景中验证了编队保持、避障和死锁解除能力。
    2.  **实物实验**：
        - 在自研的XG四足机器人平台上，实现了基于**数据分发服务**的低延迟通信，完成了动态避障编队任务。
        - 在另一款不同机械结构的四足机器人上进行了**跨平台验证**，证明了方法的通用性。

### **四、 总结**
- **核心创新**：**并非单一技术的突破，而是一个将分布式优化、学习编码、形式化安全保证和死锁处理机制深度融合的“系统级”创新框架。**
- **解决思路**：通过 **“MPC-CLF（稳）+ SAPIE-CBF（安）+ 事件触发（活）”** 的三位一体策略，同时攻克了多足编队控制中稳定性、安全性、实时性和鲁棒性四大难题。
- **实际价值**：该框架为多足机器人集群在**灾难救援、物资运输、仓库管理等真实复杂场景**中的实际应用提供了兼具高性能与高可靠性的解决方案，并展示了良好的可扩展性和跨平台潜力。


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: ## 论文总结

这篇论文旨在解决**多个四足机器人在动态、非结构化环境中进行编队控制时，如何同时保证编队稳定性、实时避障安全性和系统可扩展性**这一核心挑战。传统方法在应对动态障碍物、通信约束以及四足机器人复杂腿部动力学时，往往存在计算负担重、安全性缺乏理论保证或易陷入死锁等问题。

为此，论文提出了一个**安全分布式学习增强预测控制框架**。该框架的核心创新在于：1）将分布式模型预测控制与**控制李雅普诺夫函数**结合，以理论保证编队误差收敛；2）设计了**尺度自适应置换不变编码**机制，以鲁棒地处理动态变化的邻居机器人信息；3）引入了一个基于深度神经网络的**控制屏障函数**来强制执行分散式安全约束；4）配套开发了低延迟通信协议和事件触发的死锁解决机制。

通过在高保真仿真环境和自研的XG四足机器人平台上进行验证，该框架被证明能够实现**稳定的编队控制、有效的实时碰撞避免以及死锁的自主化解**，展示了其在复杂动态环境中大规模部署的潜力和鲁棒性。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## 论文创新点分析

这篇论文针对多足机器人编队控制中的稳定性、安全性和实时性挑战，提出了一套综合性的分布式学习增强预测控制框架。其核心创新点可归纳为以下四条，每条都针对现有方法的特定局限进行了改进。

---

### 1. **集成分布式模型预测控制与形式化安全/稳定性保证的框架**
- **相比以往方法的改进/不同之处**：
    - **传统方法局限**：传统编队控制方法（如领航-跟随法、虚拟结构法）在动态环境中鲁棒性不足。纯强化学习（RL）方法缺乏形式化安全保证，而传统的基于控制屏障函数的方法可能过于保守导致死锁。现有的多足机器人编队研究（如文献[4, 21]）缺乏对编队误差收敛的理论保证，且未完全解决编队控制与避障的集成问题。
    - **本文方法**：提出了一个**分布式模型预测控制框架**，并**集成了控制李雅普诺夫函数和控制屏障函数**。论文不仅提出了框架，还**提供了编队误差能收敛到零的理论证明**（见Lemma 1及KKT条件分析）。
- **解决的具体问题/带来的优势**：
    - **解决了“安全与稳定难以兼得”的问题**：CLF保证了编队跟踪的指数稳定性，CBF（通过神经网络实现）保证了分散式的碰撞规避安全。两者通过优化问题结合，实现了**形式化保证下的安全稳定控制**。
    - **提升了理论严谨性**：为复杂的多足机器人编队系统提供了可证明的稳定性条件，弥补了现有RL或混合方法在理论保证上的不足。

### 2. **尺度自适应置换不变编码机制**
- **相比以往方法的改进/不同之处**：
    - **传统方法局限**：在多智能体系统中，邻居机器人的数量和顺序是动态变化的。传统控制方法通常假设固定数量的邻居，或使用简单的求和聚合（如文献[26]），这难以处理特征维度不匹配问题，且可能因邻居顺序变化导致控制策略不一致，影响安全性和稳定性。
    - **本文方法**：提出了 **“尺度自适应置换不变编码”**（**SAPIE**）。该机制通过一个共享的小型网络将每个邻居的状态映射为固定长度的特征向量，然后使用**行方向的最大池化**进行聚合。无论邻居数量多少、顺序如何，输出都是固定长度的、与顺序无关的特征表示。
- **解决的具体问题/带来的优势**：
    - **解决了动态拓扑下的编码难题**：使控制器能够鲁棒地处理实时变化的邻居集合（机器人加入、离开或通信链路变化）。
    - **保证了置换不变性**：确保控制策略的输出不依赖于邻居信息的输入顺序，提高了系统的可靠性和一致性。
    - **为安全模块提供适配输入**：SAPIE生成的固定维度特征，作为后续神经网络CBF的输入，使得安全模块也能适应动态的邻居关系。

### 3. **基于神经网络的SAPIE-CBF与事件触发死锁解决机制**
- **相比以往方法的改进/不同之处**：
    - **传统CBF局限**：传统CBF通常依赖于手工设计或固定形式的函数，难以适应复杂、高维、动态的多智能体交互场景，且在狭窄空间内容易引发死锁（所有机器人因相互的安全约束而停滞）。
    - **本文方法**：
        1.  **学习型CBF**：使用**深度神经网络来近似CBF函数**，并结合前述的SAPIE模块作为输入。通过设计一个包含安全分类、前向不变性和控制正则化的综合损失函数进行训练，使CBF能学习复杂环境下的安全边界。
        2.  **事件触发死锁解决**：设计了一个死锁检测指标 `Ei`。当检测到死锁（`Ei < 0`）时，机制**不是直接修改控制输入**（可能破坏CLF的稳定性），而是**对名义状态 `x̂_i` 施加一个受控的扰动**（通过变换矩阵 `T`），从而在不违反MPC-CLF稳定性约束的前提下，生成一个可行的控制输入，打破僵局。
- **解决的具体问题/带来的优势**：
    - **增强了安全约束的适应性**：神经网络CBF能够从数据中学习更精确、更少保守的安全边界，更好地适应密集编队和复杂障碍物环境。
    - **有效破解死锁**：事件触发机制为多机器人系统在受限空间（如狭窄通道）中的导航提供了**主动恢复能力**，避免了传统CBF可能导致的系统完全停滞，提高了任务的完成率。

### 4. **全系统设计与验证：从高保真数字孪生到跨平台实物实验**
- **相比以往方法的改进/不同之处**：
    - **传统验证局限**：许多多机器人算法研究仅停留在仿真阶段，或仿真与实物环境差异较大。通信协议往往使用标准ROS，在实时性和可靠性上面临挑战。
    - **本文方法**：
        1.  **定制化机器人平台与低延迟通信**：开发了自定义四足机器人“XG”平台，并集成了基于**数据分发服务（DDS）的点对点通信协议**。DDS具有高效的QoS机制，提供了比传统ROS更可靠、更低延迟的实时状态共享。
        2.  **高保真数字孪生与Sim2Real流程**：在NVIDIA Omniverse Isaac Sim中构建了与实物属性高度吻合的**数字孪生**环境，用于算法的开发、训练和验证。这大大缩小了仿真到实物的差距。
        3.  **跨平台验证**：将同一套控制框架成功部署到另一组机械结构、负载能力不同的四足机器人上，并表现良好。
- **解决的具体问题/带来的优势**：
    - **确保了实时可行性**：DDS通信和分层计算架构（高层DMPC在CPU，底层步态在GPU/专用控制器）保障了系统的实时运行。
    - **构建了完整的研发闭环**：从高保真仿真到实物验证的流程，加速了算法开发，降低了实物测试风险。
    - **证明了框架的泛化能力**：跨平台实验表明该控制框架**不依赖于特定机器人模型**，具有较强的通用性和可移植性，为大规模异构机器人集群部署奠定了基础。

---

**总结**：本文的核心创新在于**理论、算法与系统工程的深度融合**。它不仅在控制理论层面贡献了具有形式化保证的集成框架（创新点1）和适应动态拓扑的新方法（创新点2、3），更通过先进的系统设计（创新点4）将理论落地，验证了其在复杂现实场景中的有效性和鲁棒性。这些创新共同解决了多足机器人编队在动态未知环境中**安全、稳定、实时、可扩展**协同导航的关键难题。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 论文实验与评估效果分析

该论文通过**高保真仿真**和**真实世界实验**，全面验证了所提出的分布式学习增强预测控制框架在**多四足机器人编队控制**中的有效性。实验设计围绕**编队稳定性、实时避障、死锁解决**和**系统鲁棒性**展开。

### 一、 实验设置与平台

1.  **仿真环境**：
    *   **平台**：NVIDIA Omniverse Isaac Sim。
    *   **场景**：自定义的仓库和办公室数字孪生环境（约25m x 35m），包含静态立方体障碍物构成的狭窄走廊。
    *   **机器人模型**：基于自定义四足机器人XG的高保真USD模型，参数（尺寸、质量、关节约束等）与实物严格校准，以最小化仿真到现实的差距。
    *   **底层控制器**：使用Orbit框架提供的预训练强化学习（RL）步态策略（Walk-These-Ways, WTW）。
    *   **软件框架**：ROS2 Humble。

2.  **真实世界平台**：
    *   **机器人**：自定义四足机器人 **XG**（及其变体XG Black）。
        *   **自由度**：12个。
        *   **传感器**：Mid-360 LiDAR（40线，360°水平视场）。
        *   **计算单元**：双RK3588板（分别用于规划与运动控制）。
        *   **通信**：基于**数据分发服务（DDS）** 的点对点（P2P）低延迟通信协议。

### 二、 评估场景与定性/定量结果

论文主要通过以下三个场景展示效果，并提供了相应的定量与定性分析。

#### **场景1：密集障碍物环境中的安全导航**
*   **目标**：验证编队保持与静态避障能力。
*   **设置**：5个机器人（1领航者+4跟随者）在2D平面中导航，避开随机放置的静态障碍物。CBF网络为4层CNN（64, 128, 64, 1）结合SAPIE编码（最多处理4个邻居）。MPC优化器使用IPOPT。
*   **评价指标**：**编队跟踪误差**（定义为机器人实际状态与基于邻居计算的标称状态之差：`e = x_i - x̂_i`）。
*   **结果（见图8）**：
    *   **轨迹图**：所有机器人成功绕过障碍物，并在通过障碍区后**迅速恢复并保持稳定的编队队形**。
    *   **误差曲线**：编队跟踪误差在**避障阶段（t≈30s）出现峰值**，这是控制器优先保证安全（避撞）的预期行为。**在通过障碍区后，跟踪误差迅速收敛并维持在接近零的低水平**，证明了MPC-CLF在恢复和保持编队稳定性方面的有效性。
*   **对比分析**：论文在引言和相关工作部分指出，传统方法（如基于共识、人工势场）**缺乏独立的避障能力或易陷入死锁**，而纯RL方法**缺乏安全保证**。本框架通过集成CBF和MPC-CLF，**同时实现了安全避障和稳定的编队收敛**，弥补了这些缺陷。

#### **场景2：死锁解决与动态碰撞避免**
*   **目标**：验证在复杂交互中避免死锁和机器人间碰撞的能力。
*   **设置**：4组机器人从不同方向同时向中心点移动，路径在原点附近交叉，极易引发碰撞和死锁。
*   **结果（见图9）**：
    *   所有机器人**成功规划出无碰撞轨迹**，安全通过交叉区域。
    *   当出现死锁风险时，**事件触发死锁解决机制被自动激活**，通过微调标称状态而非控制输入，使系统脱离死锁状态，恢复了运动可行性。
    *   **定性结论**：该实验证明了SAPIE-CBF在处理动态、密集多智能体交互时的有效性，以及死锁解决机制的必要性和实用性。

#### **场景3：真实世界实验与跨平台验证**
*   **目标**：验证框架在物理系统上的实时性和鲁棒性。
*   **设置1 - XG平台编队控制**：
    *   两个XG机器人在真实办公室环境中进行编队行进，并绕开一个动态障碍物（办公椅）。
    *   **结果（见图10时序图）**：机器人**成功检测到动态障碍物，实时调整轨迹，在避障的同时最大限度地保持了编队队形**，之后迅速恢复理想队形。这验证了DDS通信的低延迟性和分布式控制框架的**实时可行性**。
*   **设置2 - 跨平台验证**：
    *   将**相同的控制策略**部署到另一组物理结构不同、为重载设计的四足机器人上。
    *   **结果**：控制器**无需重新校准模型**，即能在这组异构平台上实现稳定的编队控制和避障。
    *   **结论**：这证明了所提框架的**良好泛化能力**和**平台无关性**，为异构机器人集群应用奠定了基础。

### 三、 与基线方法的对比及性能结论

论文**未进行直接的、量化的基线对比实验**（例如，在同一指标下对比APF、传统DMPC等方法的具体数值）。然而，它通过理论分析和实验演示，突出了相对于现有方法的**核心优势和创新点**：

1.  **理论保证 vs. 经验方法**：相较于纯RL或启发式方法，本文框架提供了**基于CLF的编队误差收敛至零的理论证明**，以及**基于CBF的严格安全保证（前向不变性）**。
2.  **动态适应性 vs. 固定结构方法**：提出的 **SAPIE机制** 解决了邻居数量动态变化和排列顺序无关的编码问题，这是传统假设固定邻居数量的CBF或编队控制方法难以处理的。
3.  **系统集成与实时性**：通过**分层架构**（高层DMPC-CLF + 低层RL步态）和**专用通信中间件**，实现了在复杂四足机器人系统上的**实时运行**，解决了传统非线性MPC计算负担重的问题。
4.  **死锁解决**：明确提出了**事件触发的死锁解决机制**，这是许多基于CBF的方法中存在的典型问题（过度保守导致停滞），而本文提供了系统的解决方案。

**总结**：该论文的实验评估**强于系统集成展示和定性功能验证**，通过仿真和实物实验，令人信服地证明了其框架能够实现**安全、稳定、实时且适应动态环境的多四足机器人编队控制**。其价值主要体现在**提出并整合了一套包含SAPIE、神经CBF、死锁解决等创新模块的完整解决方案**，并在真实的四足机器人平台上得到了验证。虽然缺乏严格的量化基线对比是一个局限，但其展示的复杂场景处理能力和跨平台泛化性已充分体现了方法的先进性和实用潜力。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2503.05836v1)
- [HTML 版本](https://arxiv.org/html/2503.05836v1)
