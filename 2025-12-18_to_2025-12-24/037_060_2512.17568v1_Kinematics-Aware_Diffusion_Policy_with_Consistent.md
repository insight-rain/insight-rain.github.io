# Kinematics-Aware Diffusion Policy with Consistent 3D Observation and Action Space for Whole-Arm Robotic Manipulation

**相关性评分**: 6.0/10

**排名**: #37


---


## 基本信息

- **arXiv ID**: [2512.17568v1](https://arxiv.org/abs/2512.17568v1)
- **发布时间**: 2025-12-19T13:34:29Z
- **相关性评分**: 6.0/10
- **是否相关**: 是

## 作者

Kangchen Lv, Mingrui Yu, Yongyi Jia, Chenyu Zhang, Xiang Li

## 关键词

Vision-Language-Action Model, VLA for Robotics, Inference Efficiency, Lightweight Architecture, Inference Acceleration, Edge Deployment

## 一句话总结

该论文提出了一种基于扩散策略的机器人全身操控方法，通过一致的3D空间表示和运动学先验，提高策略的样本效率和空间泛化能力，但未直接涉及视觉-语言-动作模型或边缘部署。

## 摘要

Whole-body control of robotic manipulators with awareness of full-arm kinematics is crucial for many manipulation scenarios involving body collision avoidance or body-object interactions, which makes it insufficient to consider only the end-effector poses in policy learning. The typical approach for whole-arm manipulation is to learn actions in the robot's joint space. However, the unalignment between the joint space and actual task space (i.e., 3D space) increases the complexity of policy learning, as generalization in task space requires the policy to intrinsically understand the non-linear arm kinematics, which is difficult to learn from limited demonstrations. To address this issue, this letter proposes a kinematics-aware imitation learning framework with consistent task, observation, and action spaces, all represented in the same 3D space. Specifically, we represent both robot states and actions using a set of 3D points on the arm body, naturally aligned with the 3D point cloud observations. This spatially consistent representation improves the policy's sample efficiency and spatial generalizability while enabling full-body control. Built upon the diffusion policy, we further incorporate kinematics priors into the diffusion processes to guarantee the kinematic feasibility of output actions. The joint angle commands are finally calculated through an optimization-based whole-body inverse kinematics solver for execution. Simulation and real-world experimental results demonstrate higher success rates and stronger spatial generalizability of our approach compared to existing methods in body-aware manipulation policy learning.

## 详细分析

## 论文详细摘要

**论文标题**：用于全身机器人操作的、具有一致3D观测与动作空间的运动学感知扩散策略

**1. 研究背景和动机**
在涉及全身碰撞避免或身体-物体交互的机器人操作任务中，仅考虑末端执行器位姿的策略学习是不充分的。传统方法通常在关节空间学习动作，但关节空间与实际任务空间（3D空间）的不对齐增加了策略学习的复杂性，因为策略需要隐式理解复杂的非线性运动学，这难以从有限的演示中学习。因此，需要一种既能实现全身控制，又能提高样本效率和空间泛化能力的新方法。

**2. 核心方法和技术创新**
本文提出了**运动学感知扩散策略（KADP）**，其核心创新在于构建了**任务、观测与动作空间在3D空间中的一致性**。具体方法如下：
- **3D节点表示**：使用一组位于机器人手臂上的3D点来表示机器人状态和动作。这种表示与3D点云观测空间和任务空间自然对齐，简化了策略学习中的空间关系推理。
- **运动学约束融入扩散过程**：在扩散模型的前向和反向过程中，通过可微分的正向运动学和一个预训练的逆向运动学MLP网络，将运动学约束直接融入，确保生成的3D节点位置始终对应一个运动学上可行的机器人构型。
- **优化执行**：最终通过一个基于优化的全身逆向运动学求解器，将预测的3D节点轨迹转换为关节角度指令进行执行。

**3. 主要实验结果**
在8个RLBench仿真任务和4个真实世界任务上进行了系统评估：
- **仿真实验**：KADP的平均成功率达到**64.3%**，显著优于使用末端执行器位姿（40.2%）、关节空间（42.8%）或ERJ空间（44.7%）的基线方法。
- **真实世界实验**：在需要精确抓取、开门、避障（将方块放入狭窄柜子）以及用肘部按压按钮等任务中，KADP均表现出色，尤其在需要全身控制和避障的任务上优势明显（如`放入柜子`任务成功率90%，而末端执行器基线仅10%）。
- **消融研究**：验证了运动学约束能有效降低逆向运动学误差；同时，使用完整8个节点的表示性能最佳，证明了全身构型表示的重要性。

**4. 研究意义和价值**
本研究提出了一种新颖的机器人状态与动作表示方法，**首次在扩散策略框架中实现了任务、观测与动作空间在3D空间中的完全对齐**。其价值在于：
- **技术贡献**：解决了关节空间策略学习样本效率低、泛化差，以及末端执行器策略无法进行全身控制的根本矛盾。
- **实际应用**：为在复杂、受限环境中需要全身协调和避障的机器人操作任务，提供了一种高效、可泛化的模仿学习解决方案。
- **局限性**：方法仍受限于演示数据的分布，且高维节点表示可能与其他策略学习范式（如强化学习）的兼容性有待探索。未来可向大规模、多任务、长视野学习场景拓展。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析

### **研究问题**
论文旨在解决**全身机械臂操控（Whole-Arm Robotic Manipulation）** 中策略学习的核心难题：在需要**避障**或**身体-物体交互**的场景中，仅控制末端执行器姿态（6D位姿）是不够的，必须对整个机械臂的构型进行精确控制。传统方法通常在**关节空间**学习策略，但关节空间与任务实际发生的**3D空间**不对齐，迫使策略隐式地学习复杂的非线性运动学映射，这从有限的演示数据中难以泛化，导致**样本效率低**和**空间泛化能力弱**。

### **核心创新点**
论文提出了 **KADP（Kinematics-Aware Diffusion Policy）** 框架，其创新性主要体现在以下三个紧密关联的方面：

1.  **一致的3D空间表示法**
    - **问题**：传统方法中，观察（点云）、任务（3D空间）、动作（关节角度或末端位姿）处于不同空间，增加了学习映射的复杂度。
    - **创新**：提出使用一组分布在机械臂身体上的**3D节点**来统一表示**机器人状态**和**动作**。这些节点坐标与3D点云观察、任务执行空间天然对齐。
    - **价值**：这种空间一致性让策略网络能直接在3D空间中推理机械臂、物体与环境之间的空间几何关系，极大简化了“观察->动作”的映射学习，从而提升了**样本效率**和**空间泛化能力**。

2.  **融入运动学约束的扩散模型**
    - **问题**：上述3D节点表示相对于机器人实际自由度是冗余的，标准扩散模型生成的节点位置可能对应**运动学不可行**的机器人构型。
    - **创新**：将**运动学先验**直接整合到扩散过程的前向和反向采样中。具体做法是：在**关节空间**定义噪声添加和去噪过程，然后通过**正向运动学**映射回3D节点空间。
        ```python
        # 关键公式：在关节空间添加噪声，再映射到节点空间
        A^k = F_fk( sqrt(ᾱ^k) * F_ik(A^0) + sqrt(1-ᾱ^k) * ε )
        # A^k: 第k步的噪声节点， F_fk: 正向运动学， F_ik: 逆运动学， ε: 高斯噪声
        ```
    - **价值**：确保了扩散模型生成的每一步节点轨迹都严格满足机器人运动学约束，从根源上保证了动作的**物理可行性**。

3.  **基于优化的全身逆运动学执行**
    - **问题**：策略输出是3D节点轨迹，但机器人执行需要关节角度命令。
    - **创新**：使用一个**基于优化的全身逆运动学（IK）求解器**，将预测的节点位置转换为关节角度。训练时，用一个可微的MLP拟合IK求解器以提供梯度；推理时，使用更精确的优化求解器。
        ```python
        # 优化问题：最小化预测节点与运动学计算节点之间的误差
        min_{A_joint} || Λ · ( F_fk(A_joint) - A_node ) ||^2
        s.t. 关节角度限制
        ```
    - **价值**：实现了从高维、冗余的3D节点表示到低维、可行的关节命令的准确、稳定转换，完成了从决策到执行的闭环。

### **解决方案总结**
论文通过 **“统一3D表示 -> 运动学约束扩散生成 -> 优化逆解执行”** 三步走的技术路径，系统性地解决了全身操控中策略学习的空间对齐与运动学可行性问题。该方法在**保持末端执行器精细操作能力**的同时，**解锁了全身避障和身体部位交互的能力**，并且得益于空间一致性，在数据有限的情况下仍表现出优异的泛化性能。

### **实际价值**
- **性能提升**：在8个模拟任务和4个真实任务中，KADP平均成功率显著高于基于末端位姿、关节空间及混合空间（ERJ）的基线方法。
- **泛化能力强**：在物体位置变化的抓取任务中，成功区域远大于基线，展示了卓越的**空间泛化**能力。
- **实用性强**：框架兼容标准扩散策略架构，计算效率满足实时控制要求（5Hz策略频率），并已在真实Franka机械臂上验证。


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: 这篇论文针对**全臂机器人操作中，由于任务空间（3D空间）与关节动作空间不对齐，导致模仿学习策略样本效率低、空间泛化能力差**的核心问题，提出了一种**运动学感知的扩散策略（KADP）**。其核心创新在于**使用一组位于机械臂本体上的3D节点来统一表示机器人状态和动作**，使任务、观测和动作空间在3D空间中对齐，从而简化了策略学习映射。该方法进一步将运动学约束融入扩散模型的去噪过程，并通过基于优化的全身逆运动学求解器生成关节指令。实验结果表明，该方法在仿真和真实世界的多种复杂操作任务中，相比仅控制末端执行器或直接预测关节角的基线方法，**取得了显著更高的成功率和更强的空间泛化能力**，有效实现了高效、可泛化的全身运动控制。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## 论文创新点分析

这篇论文《Kinematics-Aware Diffusion Policy with Consistent 3D Observation and Action Space for Whole-Arm Robotic Manipulation》针对全身机器人操作策略学习，提出了一个名为KADP的创新框架。其核心创新点可归纳为以下三个方面：

### 1. **提出一种新颖的、空间一致的3D节点表示法，用于统一机器人状态和动作空间**
   - **相比以往方法的改进/不同之处**：
     - **传统方法**：通常采用**笛卡尔空间末端执行器位姿**（仅控制末端，无法全身控制）或**关节空间角度**（与任务空间不对齐，学习复杂）作为动作表示。
     - **近期混合方法**：如ERJ空间（末端位姿+冗余关节角）或HDP（双分支预测末端位姿和关节轨迹），仍需在策略中隐式学习非线性运动学。
     - **本文方法**：提出使用一组附着在机械臂本体上的**3D节点**的坐标来表示机器人状态和动作。这些节点位于3D欧几里得空间。
   - **解决的具体问题/带来的优势**：
     - **解决了空间不对齐问题**：将任务空间、观测空间（3D点云）和动作空间统一在同一个3D空间中。策略网络可以直接在3D空间中推理机械臂、物体和环境之间的空间几何关系，无需隐式学习复杂的关节-任务空间非线性映射。
     - **提升了样本效率和空间泛化能力**：当被操作物体位置变化时，基于节点的策略能直观地理解新的点云观测与3D节点位置的关系，而关节空间策略则难以应对这种非线性变化。实验证明，在有限演示数据下，KADP取得了更高的成功率和更强的空间泛化性（见图6热力图）。
     - **同时实现了全身控制**：与仅控制末端的笛卡尔空间方法不同，足够的节点可以唯一确定整个机器人关节构型，从而实现对全身姿态的精确控制，以进行碰撞规避或身体-物体交互。

### 2. **将运动学约束显式地整合到扩散模型的生成过程中**
   - **相比以往方法的改进/不同之处**：
     - **标准扩散策略**：在原始数据空间（如关节角或末端位姿）直接添加高斯噪声并进行去噪。对于本文提出的冗余3D节点表示，标准流程无法保证生成的节点位置对应一个运动学上可行的机器人构型。
     - **本文方法**：重新定义了扩散过程在**紧凑的关节空间**中进行，而非原始的3D节点空间。具体而言，噪声添加和去噪的插值操作都在关节空间执行，然后通过正运动学映射到节点空间（公式8, 11）。训练时使用一个可微的MLP近似逆运动学来传递梯度，推理时则使用更精确的优化式逆运动学求解器。
   - **解决的具体问题/带来的优势**：
     - **保证了动作的动力学可行性**：确保扩散模型每一步生成的中间状态以及最终输出的3D节点轨迹都严格满足机器人运动学约束，对应一个真实的、可到达的关节构型。
     - **减少了执行误差**：如图4(a)所示，引入运动学约束后，逆运动学求解误差（IK Error）降至接近零，从而提高了从预测节点到实际关节命令转换的准确性，最终将任务成功率提升了4.3%。

### 3. **构建了一个完整的、基于扩散模型的全身操作策略学习与执行框架**
   - **相比以往方法的改进/不同之处**：
     - **现有3D空间对齐方法**：如Act3D、ChainedDiffuser等，其动作空间仅针对**末端执行器**（选择一个3D点或体素）。
     - **本文框架**：是首个在**保持任务-观测-动作空间一致性的前提下**，实现**全身控制**的扩散策略框架。它完整包含了：3D点云观测编码、基于运动学约束的扩散动作生成、以及基于优化的全身逆运动学求解器用于执行。
   - **解决的具体问题/带来的优势**：
     - **实现了复杂场景下的全身操作**：该框架能够处理需要精细全身控制的任务，例如将物体放入狭窄橱柜（需避免臂身碰撞）或用肘部按压按钮（末端控制无效）。如表II所示，在这些任务上KADP显著优于仅末端控制的方法(DP3-EE)。
     - **验证了统一表示的有效性**：通过8个仿真任务和4个真实世界任务的系统评估，证明了该框架在**样本效率**（在少量演示下学习）、**空间泛化性**（对物体位置变化鲁棒）和**任务成功率**方面的综合优势，平均成功率超越基线方法近20%（表I）。

---
**总结**：本文的核心创新在于通过**空间一致的3D节点表示法**和**运动学约束增强的扩散模型**，巧妙地解决了全身操作策略学习中“**实现全身控制**”与“**保持高样本效率及泛化能力**”之间的矛盾。它避免了关节空间学习的复杂性，又突破了末端控制的空间局限性，为从演示中学习复杂的、身体感知的机器人操作技能提供了一种有效且可推广的解决方案。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 实验与评估效果总结

该论文通过详尽的仿真和真实世界实验，系统评估了所提出的**KADP**方法的性能，并与多种基线方法进行了对比。实验结果表明，KADP在**成功率**和**空间泛化能力**上均显著优于现有方法。

### 一、 数据集与任务
1.  **仿真实验 (RLBench)**:
    *   **数据集**: 从机器人学习基准平台 **RLBench** 中选取了 **8个** 具有挑战性的任务。
    *   **任务特点**: 这些任务大多难以仅通过末端执行器控制完成，需要全身控制以避免碰撞或进行身体-物体交互。任务包括：打开烤箱、打开抽屉、打开盒子、开门、关门、关微波炉、拔充电器、叠放酒杯。
    *   **数据收集**: 每个任务使用标准专家演示接口收集 **20条** 轨迹。

2.  **真实世界实验**:
    *   **平台**: 7自由度 Franka Emika Panda 机械臂，配备固定视角的 RealSense D435 相机。
    *   **任务**: 设计了 **4个** 任务，以评估不同能力：
        *   `pick up cube`: 评估**空间泛化**和**样本效率**。
        *   `open door`: 评估精确抓取和轨迹跟随。
        *   `put cube in cabinet`: 评估**全身碰撞避免**能力。
        *   `push button elbow`: 评估**非末端执行器交互**（使用肘部）。

### 二、 评价指标
*   **主要指标**: **任务成功率**。在仿真和真实实验中，均通过多次运行（仿真100次，真实世界10次）计算平均成功率。
*   **辅助指标**:
    *   **IK误差**: 预测的3D节点位置与通过逆运动学求解器得到的关节角度所对应的节点位置之间的平均每节点距离。用于衡量**运动学可行性**。
    *   **空间泛化热图**: 在 `pick up cube` 任务中，通过在20cm×20cm工作空间内采样25个位置，可视化成功与失败的分布区域，直观展示泛化能力。

### 三、 基线方法对比
论文与以下三种基于相同扩散策略框架（DP3）但使用不同动作表示的基线方法进行了公平对比：
1.  **DP3-EE**: 预测**笛卡尔空间末端执行器位姿**，通过逆运动学求解关节指令。
2.  **DP3-Joint**: 直接预测**关节空间角度**。
3.  **DP3-ERJ**: 使用**ERJ空间**（末端执行器位姿 + 冗余关节位置），一种结合笛卡尔空间和关节空间的混合表示。

### 四、 关键性能提升与结论
#### 1. 仿真实验结果 (表 I)
*   **整体性能**: KADP在8个任务上的**平均成功率达到64.3%**，比表现最好的基线方法（DP3-ERJ，44.7%）**提升了近20个百分点**。
*   **任务表现**: KADP在**所有任务**上均取得了**最佳或次佳**性能，展现了其**鲁棒性和普适性**。
*   **基线分析**:
    *   **DP3-EE** 性能最差（平均40.2%），验证了仅控制末端执行器在全身操作任务中的局限性。
    *   **DP3-Joint** 性能也较低（平均42.8%），证明了**动作空间与任务/观测空间不一致**带来的样本效率低和泛化能力差的问题。
    *   **DP3-ERJ** 虽有提升（44.7%），但其**部分对齐**和**不完全的运动学感知**限制了其有效性。

#### 2. 真实世界实验结果 (表 II)
*   **空间泛化与样本效率 (`pick up cube`)**:
    *   在仅使用5条演示时，KADP成功率为60%，优于DP3-EE（52%）和DP3-Joint（24%）。
    *   使用13条演示时，KADP成功率提升至88%，**泛化区域的热图显示其成功区域显著大于基线**。
*   **全身操作能力**:
    *   `put cube in cabinet`: KADP取得了**90%** 的高成功率，而DP3-EE仅为10%（因碰撞失败），DP3-Joint为70%（因空间泛化不准导致碰撞）。
    *   `push button elbow`: KADP和DP3-Joint均达到100%成功率，而DP3-EE为0%（无法控制肘部），证明了KADP在**非末端交互任务**上的有效性。
*   **结论**: KADP在需要精确末端控制的任务上不逊于末端策略，在需要全身控制的任务上显著优于所有基线，**实现了性能与泛化能力的统一**。

#### 3. 消融实验分析
*   **运动学约束的作用**: 移除运动学约束（KADP w/o KC）会使IK误差从近乎0mm增加到2.1mm，且任务成功率**下降约4.3%**，证明了将运动学先验融入扩散过程对保证动作可行性的重要性。
*   **节点数量的影响**: 使用更少的节点（Node-3, Node-5）会导致性能下降。Node-3（约等于末端表示）性能与DP3-EE相当；Node-5性能提升，但不及完整的8节点表示，验证了**使用足够节点完整描述机器人构型**的必要性。

### 总结
论文通过**定量（成功率）** 和**定性（热图、失败案例分析）** 相结合的方式，全面证明了KADP框架的有效性。其核心优势在于通过**一致的3D节点表示**，同时解决了**全身控制需求**与**动作空间对齐**这两个传统上矛盾的问题，从而在多样化的操作任务中实现了**更高的成功率和更强的空间泛化能力**。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2512.17568v1)
- [HTML 版本](https://arxiv.org/html/2512.17568v1)
