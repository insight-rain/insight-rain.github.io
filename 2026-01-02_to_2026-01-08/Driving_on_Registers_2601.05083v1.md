# Driving on Registers

**相关性评分**: 7.0/10

**排名**: #37


---


## 基本信息

- **arXiv ID**: [2601.05083v1](https://arxiv.org/abs/2601.05083v1)
- **发布时间**: 2026-01-08T16:28:24Z
- **相关性评分**: 7.0/10
- **是否相关**: 是

## 作者

Ellington Kirby, Alexandre Boulch, Yihong Xu, Yuan Yin, Gilles Puy, Éloi Zablocki, Andrei Bursuc, Spyros Gidaris, Renaud Marlet, Florent Bartoccioni, Anh-Quan Cao, Nermin Samet, Tuan-Hung VU, Matthieu Cord

## 关键词

Vision-Language-Action Model, VLA for Robotics, Inference Efficiency, Lightweight Architecture, Inference Acceleration, Edge Deployment

## 一句话总结

DrivoR是一种基于Transformer的高效端到端自动驾驶架构，通过相机感知寄存器令牌压缩多相机特征，使用轻量级解码器生成和评分轨迹，提升推理效率，适用于边缘部署。

## 摘要

We present DrivoR, a simple and efficient transformer-based architecture for end-to-end autonomous driving. Our approach builds on pretrained Vision Transformers (ViTs) and introduces camera-aware register tokens that compress multi-camera features into a compact scene representation, significantly reducing downstream computation without sacrificing accuracy. These tokens drive two lightweight transformer decoders that generate and then score candidate trajectories. The scoring decoder learns to mimic an oracle and predicts interpretable sub-scores representing aspects such as safety, comfort, and efficiency, enabling behavior-conditioned driving at inference. Despite its minimal design, DrivoR outperforms or matches strong contemporary baselines across NAVSIM-v1, NAVSIM-v2, and the photorealistic closed-loop HUGSIM benchmark. Our results show that a pure-transformer architecture, combined with targeted token compression, is sufficient for accurate, efficient, and adaptive end-to-end driving. Code and checkpoints will be made available via the project page.

## 详细分析

## 论文《Driving on Registers》详细摘要

### 1. 研究背景和动机
端到端（E2E）自动驾驶规划方法因其能直接从传感器数据映射到驾驶决策而备受关注。然而，现有方法通常依赖庞大的视觉主干网络（如Vision Transformers），其输出的海量视觉令牌（tokens）在处理数百条候选轨迹时会造成巨大的计算瓶颈。为了在保持精度的同时提升效率，本文提出了一种名为 **DrivoR** 的简单、高效的纯Transformer架构，旨在探索**如何用最少的令牌来有效表示驾驶场景**，并实现准确、高效且行为可调的端到端驾驶。

### 2. 核心方法和技术创新
DrivoR的核心创新在于其**三模块Transformer架构**：
- **感知编码器**：基于预训练的ViT，为每个摄像头引入一组**相机感知的寄存器令牌**。这些可学习的寄存器在ViT内部压缩多摄像头特征，生成一个紧凑的“场景令牌”表示，将下游处理的令牌数量减少了250倍，极大降低了计算开销。
- **轨迹解码器**：使用一组可学习的查询，通过交叉注意力关注场景令牌，生成多条候选轨迹。
- **评分解码器**：将生成的每条轨迹重新嵌入为查询，再次与场景令牌进行交叉注意力交互，预测一组**可解释的子分数**（如安全性、舒适性、效率）。该模块与轨迹生成模块**解耦**，且梯度被阻断回传，确保了评分的独立性。

**关键技术点**：
- **寄存器令牌压缩**：首次将ViT寄存器令牌重新用于E2E规划中的视觉特征压缩，实现了高效且信息保留的表示。
- **解耦与行为控制**：分离轨迹生成与评分，并通过在推理时调整各子分数的权重，实现无需重新训练的行为调节（如安全优先 vs. 效率优先）。
- **简洁设计**：无需中间BEV表示或大型轨迹词典，仅使用轻量级ViT-S主干和LoRA微调，模型参数量仅约4000万。

### 3. 主要实验结果
DrivoR在多个权威基准测试中达到了领先或可比的性能：
- **NAVSIM-v1**：PDMS得分达到93.7，超越了包括DiffusionDrive、iPad等在内的众多强基线模型，接近人类驾驶员水平（94.8）。
- **NAVSIM-v2**：在更具挑战性的两阶段评估中，EPDMS得分达到48.3，取得了新的最优结果。
- **HUGSIM**：在零样本设置下的光真实感闭环仿真中，取得了最高的道路完成率（49.8）和驾驶分数（35.7）。
- **效率**：相比使用ViT-L主干的基线模型，DrivoR实现了**超过3倍的吞吐量提升**（从400ms/前向传播降至110ms），同时FLOPs和峰值内存消耗大幅降低。

### 4. 研究意义和价值
本研究证明了**纯Transformer架构结合针对性的令牌压缩，足以实现高性能的端到端自动驾驶**。其价值体现在：
- **技术贡献**：提出了寄存器令牌这一高效的特征压缩机制，为处理高分辨率、多传感器输入的实时系统提供了新思路。
- **实用价值**：模型结构简单高效，参数量小，更易于部署。解耦的评分机制赋予了模型在推理时灵活调节驾驶行为的能力，增强了实用性和可解释性。
- **领域影响**：为端到端驾驶社区提供了一个强大、简洁的基线模型，推动了该方向在效率与性能协同优化上的研究。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析：DrivoR

### **核心问题**
论文旨在解决端到端（E2E）自动驾驶规划中的两个关键瓶颈：
1.  **计算效率低下**：基于视觉Transformer（ViT）的感知主干网络会输出数千个图像块（patch）令牌，这些令牌需要为数百条候选轨迹进行重复处理，导致巨大的计算和内存开销。
2.  **规划与评分耦合过紧**：许多现有方法使用同一模块或特征同时生成和评估轨迹，限制了模型的表达能力和对驾驶行为的可控性。

### **核心创新点**
DrivoR 通过一个简洁、高效的纯Transformer架构解决了上述问题，其创新主要体现在以下三个方面：

#### **1. 基于“寄存器令牌”的感知压缩**
- **技术**：在预训练的ViT中，为每个摄像头引入一组固定数量的、可学习的 **“摄像头感知寄存器令牌”**。这些令牌在ViT的前向传播过程中，通过自注意力机制“吸收”并压缩对应摄像头的视觉信息。
- **效果**：
    - 将原本数千个图像块令牌压缩为每摄像头仅 **16个** 场景令牌（例如，4个摄像头共64个令牌），压缩比高达 **250:1**。
    - 显著降低了后续轨迹生成和评分解码器的计算负担（FLOPs降低，吞吐量提升3倍以上）。
    - 实现了**摄像头感知**的压缩：模型能区分令牌来自哪个摄像头，且实验发现前向摄像头的寄存器会学习关注不同区域（如前方车辆、交通灯），而后向摄像头的令牌则倾向于“坍缩”为相似表示，这与驾驶中“主要关注前方，偶尔观察后方”的直觉相符。

#### **2. 解耦的轨迹生成与评分双解码器**
- **架构**：采用两个独立的轻量级Transformer解码器。
    1.  **轨迹解码器**：以可学习的查询为输入，基于压缩后的场景令牌，通过交叉注意力生成一组（如64条）候选轨迹。
    2.  **评分解码器**：将生成的每条轨迹重新嵌入为新的查询，**阻断其到轨迹解码器的梯度**，然后同样基于场景令牌对每条轨迹进行独立评分。
- **优势**：
    - **解耦学习**：生成器专注于覆盖多样的、合理的未来轨迹，而评分器专注于根据场景上下文评估每条轨迹的质量。注意力图分析显示，两个解码器关注的摄像头不同（例如，生成时主要看前方，评分时可能根据转弯行为关注侧方或后方），证明了解耦的必要性。
    - **行为可控性**：评分器预测的是可解释的**子分数**（如安全性、舒适性、效率），而非单一总分。在推理时，可以通过调整这些子分数的权重（`λ_c`），实现**无需重新训练**的驾驶行为调节（例如，偏向安全或偏向高效）。

#### **3. 极简的纯Transformer端到端流程**
- **设计哲学**：摒弃了复杂的中间表示（如鸟瞰图BEV）、大型预计算轨迹词典或额外的3D监督。整个流程仅包含一个感知编码器和两个解码器，结构清晰。
- **训练目标**：
    - **轨迹损失**：采用“赢家通吃”回归，只监督与真实轨迹最接近的那条预测轨迹，鼓励多样性。
    - **评分损失**：使用二元交叉熵损失，让评分器模仿数据集提供的“先知”评分器（Oracle Scorer）对各个子分数的判断。

### **解决方案总结**
DrivoR 通过 **“寄存器压缩”** 解决计算瓶颈，通过 **“双解码器解耦”** 解决规划与评分的功能分离问题，最终用一个**参数少（约40M）、效率高、性能强**的模型，在多个权威基准测试（NAVSIM-v1/v2, HUGSIM）上达到或超越了更复杂模型的性能，证明了**有针对性的令牌压缩与简洁的Transformer设计足以实现准确、高效且可适应的端到端驾驶**。


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: 这篇论文针对端到端自动驾驶规划中，视觉主干网络输出大量特征令牌导致下游轨迹生成与评分计算成本高昂的核心问题，提出了一种名为DrivoR的简洁高效架构。其主要创新在于引入**相机感知的寄存器令牌**，对预训练的视觉Transformer（ViT）提取的多摄像头特征进行压缩，形成紧凑的场景表示，并在此基础上使用两个解耦的轻量级Transformer解码器分别生成候选轨迹和进行可解释的多维度评分（如安全、舒适、效率）。该方法在NAVSIM-v1、NAVSIM-v2和HUGSIM等多个权威闭环基准测试中达到或超越了同期先进方法的性能，同时显著降低了计算开销和模型参数量，证明了纯Transformer架构结合针对性的令牌压缩能够实现准确、高效且行为可调的端到端驾驶。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## 论文《Driving on Registers》的创新点分析

这篇论文提出了一个名为 **DrivoR** 的端到端自动驾驶架构。其核心创新在于**利用ViT的寄存器令牌进行感知压缩**，并构建了一个**解耦的轨迹生成与评分系统**。以下是其相对于已有工作的明确创新点：

### 1. **引入“相机感知寄存器令牌”进行高效感知压缩**
   - **改进/不同之处**：
     - **以往方法**：常见的感知特征压缩方法（如空间池化）对所有相机输入进行**均匀处理**，将所有图像特征视为同等重要，并进行相同的平均操作。这无法适应不同相机视角（如前视、后视）信息密度的差异。
     - **DrivoR方法**：为每个相机引入一组**可学习的、相机特定的寄存器令牌**。这些令牌在ViT编码过程中与图像块令牌一起处理，并在ViT最后一层被提取出来，作为该相机的紧凑场景表示。最终将所有相机的寄存器令牌拼接，形成整个场景的令牌表示。
   - **解决的问题/带来的优势**：
     - **显著降低计算开销**：将每帧数千个图像令牌压缩为每相机仅16个寄存器令牌（例如，4相机共64个令牌），使下游轨迹生成和评分的计算量**降低250倍以上**，解决了多相机、高分辨率下Transformer注意力计算复杂度（O(n²)）的瓶颈。
     - **保留关键信息，实现自适应压缩**：模型可以学习为信息更丰富的前视相机分配更多样化的寄存器（关注不同区域，如车辆、交通灯、路缘），而为信息较少的后视/侧视相机让多个寄存器“坍缩”到相似表示。这比均匀池化更符合驾驶的注意力需求（主要关注前方，偶尔检查后方）。
     - **保持高性能**：尽管压缩剧烈，但性能接近甚至超过使用完整特征图的方法，在多个基准测试中达到SOTA。

### 2. **采用完全解耦的双解码器架构进行轨迹生成与评分**
   - **改进/不同之处**：
     - **以往方法**：许多轨迹提案方法使用**单一模块或共享主干**来同时生成和评分轨迹，或者评分模块能直接访问轨迹生成器的内部潜在表示。
     - **DrivoR方法**：设计了**两个完全独立的轻量级Transformer解码器**：
       1. **轨迹解码器**：使用可学习查询，基于场景令牌生成多条候选轨迹。
       2. **评分解码器**：将**已解码的轨迹坐标**（而非轨迹解码器的内部令牌）重新嵌入为查询，再与场景令牌进行交叉注意力来预测分数。在训练时，**阻断评分解码器的梯度流向轨迹解码器**。
   - **解决的问题/带来的优势**：
     - **强制功能分离**：确保评分器仅基于最终的轨迹几何形状和场景上下文进行判断，而不是依赖于轨迹生成过程中可能存在的、与质量无关的中间特征。这提高了评分的**可靠性和可解释性**。
     - **提升性能**：消融实验表明，这种解耦设计比共享分支或非解耦设计带来显著的性能提升（PDMS分数从86.8提升至90.0）。
     - **注意力模式差异化**：可视化显示，轨迹生成更专注于前视相机以规划路径，而评分则会根据轨迹风险（如转弯时）动态关注侧视或后视相机来评估安全。解耦架构更好地适应了这两种不同的注意力需求。

### 3. **设计可解释、可调节行为的子评分系统**
   - **改进/不同之处**：
     - **以往方法**：评分模块通常输出一个单一的、综合的分数，难以在推理时灵活调整驾驶风格（如更安全 vs. 更高效）。
     - **DrivoR方法**：评分解码器预测**多个可解释的子分数**（如安全性、舒适性、效率），这些子分数直接对应NAVSIM基准中的评价指标（如无过错碰撞、可行驶区域合规、进度）。在推理时，可以通过**调整这些子分数的权重**（λ_c）来组合成最终的总分，从而选择不同行为偏好的轨迹。
   - **解决的问题/带来的优势**：
     - **实现行为可控的驾驶**：使用单一训练好的模型，即可在推理时通过调整权重实现“安全优先”、“效率优先”或“舒适优先”等不同的驾驶策略，**无需重新训练**。
     - **提升评分准确性**：学习预测多个具体的子目标，比直接学习一个复杂的综合目标函数更容易，这本身也带来了整体评分性能的提升（消融实验显示，预测6个子分数比预测1个综合分数PDMS更高：90.0 vs. 88.2）。

### 4. **整体架构的极简与高效设计**
   - **改进/不同之处**：
     - **以往方法**：许多SOTA端到端驾驶模型依赖复杂的中间表示（如鸟瞰图BEV）、大型预计算轨迹词典、或重型多模态融合模块（LiDAR+相机）。它们通常使用巨大的ViT变体（如ViT-L/H），计算成本高。
     - **DrivoR方法**：
       - **纯Transformer架构**：仅包含一个感知编码器和两个解码器，**没有BEV表示，没有大型轨迹词典**。
       - **使用小型骨干网络**：基于轻量的**DINOv2 ViT-S**，并通过LoRA进行微调，参数量仅约**4000万**，远小于竞争对手。
       - **避免3D中间监督**：仅依赖轨迹回归损失和评分监督（来自数据集中的Oracle评分器），无需昂贵的3D边界框标注。
   - **解决的问题/带来的优势**：
     - **计算效率极高**：在A100 GPU上，前向传播时间从对比方法（如GTRS使用ViT-L）的400ms降低到110ms，吞吐量提升3倍以上，内存占用和FLOPs也大幅减少。
     - **实现性能与效率的卓越平衡**：尽管模型简单轻量，但在NAVSIM-v1/v2和闭环HUGSIM基准测试中均达到或超越了更复杂、更庞大的SOTA方法，证明了**高效设计不必然牺牲精度**。

### 总结
DrivoR的核心创新在于**“高效的令牌压缩”**与**“解耦且可解释的决策”** 两者的结合。它通过**相机感知寄存器**巧妙地解决了视觉Transformer在自动驾驶中的计算瓶颈，同时通过**双分支解耦设计**和**子评分系统**实现了可靠、可控的轨迹选择。最终，该研究证明了一个**极简、高效的纯Transformer架构**足以胜任复杂、自适应的端到端驾驶任务，为实时自动驾驶系统的部署提供了新的设计范式。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 论文实验与评估效果总结

### 一、 使用的数据集与评价指标
论文在三个主流的自动驾驶端到端规划基准上进行了全面评估：

1.  **NAVSIM-v1**：
    *   **数据集**：基于nuPlan构建，是OpenScene的一个子集。
    *   **核心指标**：**预测性驾驶员模型分数 (PDMS)**。这是一个复合指标，包含惩罚项（如无责碰撞NC、可行驶区域合规DAC）和行为项（如舒适度Comf.、自车进度EP、碰撞时间TTC）的加权组合。PDMS是主要排名指标。

2.  **NAVSIM-v2**：
    *   **数据集**：在NAVSIM-v1基础上，通过高斯泼溅生成扰动场景（如车辆位姿偏移），以测试模型在分布外（OOD）场景的泛化能力。
    *   **核心指标**：**扩展预测性驾驶员模型分数 (EPDMS)**。在PDMS基础上增加了更多子指标（如行车方向合规DDC、交通线合规TLC、历史舒适度HC等）。

3.  **HUGSIM**：
    *   **数据集**：一个**照片级真实感的闭环仿真基准**，场景源自KITTI-360、nuScenes、PandaSet和Waymo。
    *   **核心指标**：
        *   **道路完成率 (RC)**：成功完成场景的比例。
        *   **HUGSIM驾驶分数 (HD-Score)**：结合RC与NC、DAC、TTC、舒适度的平均分。

### 二、 对比的基线方法
论文与大量同期最先进的端到端驾驶方法进行了对比，主要包括：
*   **基于轨迹提议的方法**：Hydra-MDP++、iPad、DiffusionDrive、GTRS、ZTRS等。
*   **其他代表性端到端方法**：UniAD、VAD-v2、PARA-Drive、DriveSuprim、RAP等。
*   **多模态方法**：TransFuser（相机+激光雷达）。
*   **简单基线**：仅使用自车状态的MLP、恒定速度模型。

### 三、 关键性能结果与结论

#### 1. **性能领先**
DrivoR在三个基准测试中均达到或超越了当时的先进水平（SOTA）：
*   **NAVSIM-v1 (PDMS)**: **93.7分**，超越了iPad (91.7)、DriveSuprim (93.5) 等方法，**接近人类驾驶员水平 (94.8)**。仅略低于使用了**10倍训练数据**的RAP-DINO (93.8)。
*   **NAVSIM-v2 (EPDMS)**: **48.3分**，在官方修复评测代码漏洞后，**排名第一**，超越了GTRS (45.4)、ZTRS (48.1) 等方法。
*   **HUGSIM (零样本泛化)**: **RC: 49.8, HD-Score: 35.7**，在报告的基线方法中**均为最高**，展示了强大的泛化到真实感闭环仿真的能力。

#### 2. **核心结论与优势**
*   **高效且准确**：DrivoR证明了**纯Transformer架构**结合**针对性的令牌压缩**（相机感知寄存器），无需复杂的中间表示（如BEV）或大型轨迹词典，即可实现高精度端到端驾驶。
*   **计算效率显著提升**：与使用ViT-L等大型骨干网络的方法（如GTRS）相比，DrivoR（基于ViT-S）实现了：
    *   **3倍以上的吞吐量提升**（从400ms/前向传播降至110ms/前向传播）。
    *   **3倍的GFLOPS和峰值内存使用降低**。
    *   参数量仅约**34M**，远小于许多对比方法。
*   **可解释与可控制的行为**：通过**解耦的评分解码器**预测可解释的子分数（安全、舒适、效率等），使得在推理时可以通过调整子分数的权重（`λ_c`）来**灵活调整驾驶策略**（如偏向安全或偏向高效），而无需重新训练模型。
*   **寄存器压缩的有效性**：消融实验表明，使用**16个寄存器/相机**压缩视觉特征，其性能接近使用完整特征图（250倍令牌数）的模型，同时下游计算量大幅减少。注意力可视化显示，前向摄像头寄存器会**专业化关注不同区域**（如前方车辆、交通灯），而后向摄像头令牌则趋于**坍缩**，这与驾驶中对前方信息需求更高的直觉相符。

#### 3. **关键消融发现**
*   **感知骨干**：使用**DINOv2预训练权重**并进行**LoRA微调**至关重要，比随机初始化或冻结骨干性能有大幅提升。
*   **轨迹与评分解耦**：使用**独立的轨迹解码器和评分解码器**，并在评分时阻断梯度回传到轨迹生成器（“解耦”），能显著提升性能。因为两个任务关注的视觉信息不同（轨迹生成主要看前方，评分会根据轨迹风险关注侧/后方）。
*   **多子分数预测**：预测PDMS的**多个子分数组件**，而不仅仅是最终总分，不仅实现了行为控制，也提升了评分准确性。

**总结**：DrivoR通过其简洁而高效的设计——**寄存器令牌压缩**和**解耦的双解码器**——在多个权威基准上实现了领先的性能，同时显著降低了计算开销，并提供了行为可调的灵活性，为实时、高效的端到端自动驾驶系统提供了一个强有力的基线模型。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2601.05083v1)
- [HTML 版本](https://arxiv.org/html/2601.05083v1)
