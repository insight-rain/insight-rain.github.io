# PyramidalWan: On Making Pretrained Video Model Pyramidal for Efficient Inference

**相关性评分**: 6.0/10

**排名**: #50


---


## 基本信息

- **arXiv ID**: [2601.04792v1](https://arxiv.org/abs/2601.04792v1)
- **发布时间**: 2026-01-08T10:16:06Z
- **相关性评分**: 6.0/10
- **是否相关**: 是

## 作者

Denis Korzhenkov, Adil Karjauv, Animesh Karnewar, Mohsen Ghafoorian, Amirhossein Habibian

## 关键词

Inference Efficiency, Lightweight Architecture, Inference Acceleration, Edge Deployment

## 一句话总结

PyramidalWan通过将预训练视频扩散模型转换为金字塔结构，实现高效推理，提升计算效率，适用于边缘部署。

## 摘要

Recently proposed pyramidal models decompose the conventional forward and backward diffusion processes into multiple stages operating at varying resolutions. These models handle inputs with higher noise levels at lower resolutions, while less noisy inputs are processed at higher resolutions. This hierarchical approach significantly reduces the computational cost of inference in multi-step denoising models. However, existing open-source pyramidal video models have been trained from scratch and tend to underperform compared to state-of-the-art systems in terms of visual plausibility. In this work, we present a pipeline that converts a pretrained diffusion model into a pyramidal one through low-cost finetuning, achieving this transformation without degradation in quality of output videos. Furthermore, we investigate and compare various strategies for step distillation within pyramidal models, aiming to further enhance the inference efficiency. Our results are available at https://qualcomm-ai-research.github.io/PyramidalWan.

## 详细分析

## 论文摘要：PyramidalWan: 将预训练视频模型金字塔化以实现高效推理

### 1. 研究背景和动机
近年来，视频扩散模型在生成质量上取得了显著进展，但其多步推理过程计算成本高昂，限制了实际应用。为提升效率，现有研究主要集中于**步数蒸馏**和**架构优化**。**金字塔模型**作为一种新兴的补充策略，其核心思想是：在扩散过程的不同阶段，根据噪声水平的高低，在相应的低分辨率或高分辨率上进行处理。然而，现有的开源金字塔视频模型通常需要从头训练，且在视觉合理性上往往落后于最先进的系统。本研究旨在解决这一矛盾，探索如何以**低成本微调**的方式，将预训练好的高性能视频扩散模型高效地转化为金字塔模型，同时不损失生成质量。

### 2. 核心方法和技术创新
本文提出了一套完整的**金字塔化（Pyramidization）** 流程，主要包含以下技术创新：
- **金字塔化微调**：基于 **PyramidalFlow** 框架，将预训练的 **Wan2.1-1.3B** 视频扩散Transformer模型分解为三个时空分辨率递减的阶段。通过引入**金字塔流匹配损失**和**蒸馏损失**进行低成本微调，成功将其转化为金字塔模型 **PyramidalWan**，在保持质量的同时显著降低计算量。
- **金字塔步数蒸馏的系统性研究**：首次系统探索了在金字塔设置下的步数蒸馏策略。提出了适用于**原始教师模型**和**金字塔教师模型**的**分布匹配蒸馏（DMD）** 方法变体（DMD-OT, DMD-PT），以及**对抗蒸馏**方法。这使得模型能在每个阶段仅用极少的步数（如2-2-1调度）进行高效推理。
- **理论框架扩展**：将PyramidalFlow中阶段间分辨率转换的操作（如上采样/下采样）从简单的平均池化和最近邻插值，**推广到基于正交变换（如小波）的任意上采样函数类**，为方法提供了更坚实的数学基础。
- **补丁金字塔模型验证**：首次成功地将**金字塔补丁化流（PPF）** 框架应用于视频生成，并证明其在有限训练预算下可用于步数蒸馏。

### 3. 主要实验结果
- **效率提升**：PyramidalWan（20-20-10调度）相比原始Wan模型（50步），计算量（FLOPs）减少约 **78%**，同时保持了相当的VBench总分（82.83 vs 82.49）。
- **质量保持**：经过步数蒸馏的模型（如PyramidalWan-DMD-PT*，采用2-2-1调度）在人类偏好研究中，其视觉质量与计算成本更高的基线模型（如50步的Wan或2步的Wan-DMD）**没有显著差异**。
- **填补空白**：传统的步数蒸馏模型（如Wan-DMD）在单步生成时质量大幅下降。而本文的金字塔模型通过**仅在最高分辨率阶段执行单步**，配合低分辨率阶段的多步，成功实现了高质量、高效率的“准单步”生成。
- **对比优势**：与动态令牌削减方法（如Jenga）相比，金字塔模型提供了**静态计算图**，部署更简单，且在质量-效率权衡上表现更优。

### 4. 研究意义和价值
本工作的价值在于：
- **实用性强**：提供了一条切实可行的路径，能够将现有强大的预训练视频扩散模型低成本地改造为高效的金字塔版本，**弥合了高性能与高效率之间的鸿沟**。
- **方法全面**：不仅实现了从常规模型到金字塔模型的转换，还系统研究了金字塔模型自身的步数蒸馏，为未来更高效视频生成系统的设计提供了重要参考和实践经验。
- **理论贡献**：对金字塔流框架的理论扩展，增强了其普适性和严谨性。
- **应用前景**：所提出的模型特别适合对延迟敏感的应用场景（如移动设备），为实现实时或近实时的视频生成奠定了基础，推动了生成式AI技术的实用化进程。

## 问答对

### 问题 1

**Q**: 这篇论文的核心创新点是什么，他想解决什么问题，怎么解决的？

**A**: ## 论文核心分析：PyramidalWan

### **核心问题**
现有的视频扩散模型（如Wan2.1）生成高质量视频需要**多步推理**，计算成本极高。虽然已有**金字塔模型**（PyramidalFlow）通过在不同噪声级别处理不同分辨率来提升效率，但它们通常需要**从头训练**，且性能往往落后于最先进的非金字塔模型。此外，**步数蒸馏**技术虽能减少推理步数，但单步生成质量仍不理想。

**核心矛盾**：如何在**不牺牲生成质量**的前提下，显著降低预训练视频扩散模型的推理成本？

### **核心创新点**

#### 1. **提出“金字塔化”流程：将预训练模型高效转换为金字塔模型**
   - **问题**：传统金字塔模型需从头训练，成本高且性能可能下降。
   - **解决方案**：
     - 基于**PyramidalFlow框架**，将预训练Wan2.1-1.3B模型的前向/后向扩散过程分解为三个时空阶段（分辨率递减）。
     - 通过**低成本微调**（使用金字塔流匹配损失和蒸馏损失），而非从头训练，实现转换。
     - 关键发现：在**像素空间（RGB）对视频进行下采样后再编码为潜变量**（定义②），比直接在潜变量空间下采样（定义①）能获得更好的视觉质量。
   - **效果**：在几乎不损失质量的前提下，将计算成本降低约78%（FLOPs从2×12592降至2×2821）。

#### 2. **系统研究金字塔模型中的步数蒸馏策略**
   - **问题**：步数蒸馏能进一步减少步数，但如何适配金字塔结构？
   - **解决方案**：探索并比较了两种主流蒸馏方法在金字塔设定下的变体：
     - **分布匹配蒸馏**：
       - **DMD-OT**：使用**原始非金字塔教师模型**进行蒸馏。
       - **DMD-PT**：使用**金字塔化后的教师模型**进行蒸馏，并推导了适配金字塔前向过程的梯度公式（`L_dmd-pyr`）。
     - **对抗蒸馏**：
       - **Adv-OD**：使用原始模型特征提取器。
       - **Adv-PD**：使用金字塔模型特征提取器。
   - **关键创新**：首次实现了**对预训练金字塔扩散模型进行步数蒸馏**，并提出了针对金字塔前向过程的DMD损失梯度计算公式。

#### 3. **理论贡献：推广金字塔阶段间的转换操作**
   - **问题**：原PyramidalFlow使用平均池化和最近邻上采样进行分辨率转换，其理论是否可推广？
   - **解决方案**：将阶段转换操作（`ℜ↓`, `ℜ↑`, `ℜ𝒩↑`）**推广到基于正交变换（如小波）的任意上/下采样函数**。证明了原方法（Haar小波）是此广义框架的一个特例。
   - **价值**：为未来探索更优的采样/上采样方法提供了理论灵活性。

#### 4. **探索补丁金字塔模型在视频生成中的应用**
   - **问题**：补丁金字塔化（PPF）是另一种高效方法，但在视频生成中效果未知。
   - **解决方案**：首次成功将PPF框架应用于**少步视频生成**的蒸馏训练。
   - **发现**：在有限算力下，PyramidalFlow在扩散式微调上优于PPF；但PPF在蒸馏为少步模型时仍是一个强有力的候选方案。

### **解决方案的技术路径总结**
```mermaid
graph TD
    A[预训练视频扩散模型 Wan2.1] --> B[金字塔化微调]；
    B --> C[金字塔扩散模型 PyramidalWan]；
    C --> D{步数蒸馏}；
    D --> E[DMD-OT: 原始教师]；
    D --> F[DMD-PT: 金字塔教师]；
    D --> G[对抗蒸馏 Adv-OD/PD]；
    E & F & G --> H[少步金字塔模型]；
    H --> I[高效推理： 如 2-2-1 调度]；

    style B fill:#e1f5fe
    style D fill:#f3e5f5
    style I fill:#e8f5e8
```

### **实际价值与影响**
1.  **效率大幅提升**：最终模型（如PyramidalWan-DMD-PT* 使用2-2-1调度）仅需**1步**处理最高分辨率，配合低分辨率阶段的少量步数，实现了与50步原始模型或2步蒸馏模型**相当的视觉质量**，同时计算成本极低（见表1，TFLOPs低至282）。
2.  **部署友好**：金字塔模型每阶段的计算图是**静态的**，与Jenga等动态token剪枝方法相比，更易于在资源受限设备（如移动芯片）上部署。
3.  **开辟新方向**：证明了**对预训练模型进行“金字塔化”改造的可行性**，以及**对金字塔教师模型进行蒸馏的有效性**，为后续研究提供了新范式。
4.  **实用权衡**：论文坦承，尽管在人工评估中表现相当，但少步金字塔模型在**VBench-2.0的“创造性”和“可控性”等定量指标上仍有下降**，指出了未来改进的方向。

**结论**：PyramidalWan的核心创新在于提供了一套**低成本、高质量**的“组合拳”，将预训练SOTA模型转化为高效的金字塔版本，并通过系统的蒸馏研究，实现了在**极低推理成本下接近原模型质量的视频生成**，在生成质量与效率的权衡中找到了一个极具实用价值的新平衡点。


### 问题 2

**Q**: 请用一段话总结这篇论文，明确说明：论文试图解决的核心问题；提出的主要方法或框架；最终取得的主要效果或结论。要求语言简洁、信息密度高，不要复述摘要原文。

**A**: 这篇论文旨在解决预训练视频扩散模型推理效率低下的核心问题。针对现有金字塔模型需要从头训练且性能不佳的痛点，论文提出了一种名为PyramidalWan的低成本微调流程，能够将预训练的传统视频扩散模型（如Wan2.1）高效地转化为时空金字塔模型。该方法基于PyramidalFlow框架，将去噪过程分解为多个分辨率递增的阶段，并引入了结合流匹配和蒸馏损失的微调策略。此外，论文系统研究了在金字塔设置下的多种步数蒸馏技术（如DMD和对抗蒸馏），以进一步实现少步推理。最终，该方法在显著降低计算成本（如FLOPs减少78%）和延迟的同时，保持了与原始模型相当的视觉质量，并通过用户研究表明其少步生成结果可与计算成本更高的基线模型相媲美。


### 问题 3

**Q**: 这篇论文相对于已有工作有哪些明确的创新点？请逐条列出，并对每一条说明：相比以往方法改进或不同之处在哪里，以及该创新解决了什么具体问题或带来了什么优势。

**A**: ## 论文创新点分析

这篇论文《PyramidalWan: On Making Pretrained Video Model Pyramidal for Efficient Inference》的核心贡献在于提出了一套系统的方法，将预训练的视频扩散模型高效地转化为金字塔模型，以显著降低推理成本，同时保持生成质量。其创新点具体如下：

---

### 1. **提出低成本微调流程，将预训练常规模型转化为金字塔模型**
   - **相比以往方法的改进/不同之处**：
     - **以往方法**：如PyramidalFlow等金字塔模型通常需要**从头开始训练**（from scratch）。这不仅计算成本高昂，且现有开源金字塔模型在视觉合理性上往往落后于最先进的系统。
     - **本文方法**：提出了一种**低成本的微调（low-cost finetuning）流程**，能够将**已有的、高性能的预训练扩散模型**（如Wan2.1-1.3B）直接转化为金字塔结构。该方法基于金字塔流匹配损失（Pyramidal Flow Matching Loss）进行微调。
   - **解决的具体问题/带来的优势**：
     - **解决了“训练成本-性能”的权衡问题**：避免了从头训练一个高质量金字塔模型所需的巨大计算开销。
     - **保持了模型性能**：实验表明，转化后的金字塔模型（PyramidalWan）在视觉质量上与原版多步推理模型相当，**没有出现质量退化**。
     - **大幅提升推理效率**：将计算成本降低了约78%（如Table 1所示，FLOPs从2×12592降至2×2821），实现了高效的视频生成。

### 2. **在金字塔框架内系统研究并提出了多种步数蒸馏策略**
   - **相比以往方法的改进/不同之处**：
     - **以往方法**：步数蒸馏（Step Distillation）研究多集中在常规（非金字塔）模型上，且多数工作专注于图像生成。少数视频步数蒸馏工作（如SwD, Neodragon）**未全面研究金字塔教师模型**或**未探索基于PPF的训练**。
     - **本文方法**：
       1. **探索了两种教师模型场景**：使用**原始常规教师模型**（DMD-OT）和**金字塔教师模型**（DMD-PT）进行蒸馏。
       2. **提出了适用于金字塔框架的DMD变体**：针对金字塔教师模型，推导了新的噪声估计器和损失梯度公式（`L_dmd-pyr`），以适应金字塔特有的阶段间信号定义和重加噪过程。
       3. **探索了对抗性蒸馏**：在金字塔设置下应用了基于判别器的对抗蒸馏方法（Adv-OD/PD）。
   - **解决的具体问题/带来的优势**：
     - **填补了研究空白**：首次系统研究了在金字塔扩散模型上进行步数蒸馏，特别是使用金字塔教师模型的情况。
     - **实现了极高效的少步推理**：结合金字塔结构（在低分辨率阶段进行多步计算）和步数蒸馏（减少每阶段步数），实现了如“2-2-1”这样的调度（即最高分辨率仅需1步）。这使模型在保持竞争力的视觉质量下，将单次前向传递延迟降低到仅比单步原始模型慢13%，同时FLOPs大幅降低（如2-2-1调度仅需282 TFLOPs）。
     - **提供了实用指南**：通过实验比较不同蒸馏策略，为在不同计算预算和场景下训练高效视频生成器提供了实践见解。

### 3. **理论扩展：将金字塔阶段间过渡操作泛化到更广泛的函数类**
   - **相比以往方法的改进/不同之处**：
     - **以往方法**：PyramidalFlow框架中，阶段间的下采样和上采样操作固定为**平均池化（Average Pooling）** 和**最近邻上采样（Nearest-Neighbor Upsampling）**。
     - **本文方法**：从理论层面将过渡操作**泛化到基于正交变换（如小波变换）的任意上/下采样函数**。论文指出，原框架中的平均池化和最近邻上采样可以看作是**Haar小波算子**的缩放实例，从而被包含在这个广义框架中。
   - **解决的具体问题/带来的优势**：
     - **提供了理论统一性和灵活性**：为金字塔模型的设计提供了更坚实的数学基础，并打开了使用其他更优上/下采样方法（如基于小波的方法）的可能性，可能在未来带来更好的质量或效率。
     - **深化了对机制的理解**：通过将操作与小波分析联系起来，强化了“谱自回归”的理论依据——即高频信息在扩散过程中更早被噪声掩盖，因此可以在低分辨率下处理。

### 4. **首次成功训练用于少步视频生成的Pyramidal Patchification模型**
   - **相比以往方法的改进/不同之处**：
     - **以往方法**：Pyramidal Patchification Flow（PPF）作为一种替代金字塔流的方法，主要通过调整**块化（Patchification）的核大小**而非输入分辨率来改变计算量。此前工作（如Li et al.）主要展示了在**文本到图像**模型上的成功。
     - **本文方法**：论文首次证明并成功训练了用于**少步视频生成**的PPF模型（Wan-PPF-DMD）。尽管发现PPF在有限的训练预算下进行扩散式微调时效果不如PyramidalFlow，但其在**蒸馏到少步推理模型**时表现出强大潜力。
   - **解决的具体问题/带来的优势**：
     - **拓展了高效视频生成的技术选项**：为社区提供了另一种可行的、免于复杂阶段过渡数学推导的高效架构选择。
     - **验证了PPF在视频领域的适用性**：特别是在蒸馏场景下，PPF可以成为一个强有力的候选方案。

---

## 总结
本文的核心创新在于**“高效转化”**和**“系统优化”**。它没有提出一个全新的底层架构，而是提供了一套**实用的工程与算法方案**，将现有的高性能预训练模型“升级”为计算效率极高的金字塔版本，并深入探索了在该框架下进行极致压缩（步数蒸馏）的最佳实践。这为解决视频扩散模型推理成本高昂这一核心痛点，提供了兼具**性能保持**和**部署友好**（静态计算图）的解决方案。其理论泛化也为后续研究奠定了基础。


### 问题 4

**Q**: 论文在实验或评估中最终实现了怎样的效果？请说明使用了哪些数据集和评价指标，与哪些基线方法进行了对比，以及在关键指标上的主要性能提升或结论。如果论文未给出明确的定量结果，也请说明原因。

**A**: ## 论文实验与评估效果总结

### 一、 核心目标与实现效果
本论文的核心目标是：**将预训练的视频扩散模型（Wan2.1-1.3B）高效地转换为金字塔模型，以显著降低推理成本，同时保持生成视频的视觉质量**。实验最终成功实现了这一目标，并进一步探索了在金字塔架构内进行步数蒸馏，以实现更高效的少步推理。

**主要实现效果如下：**
1.  **高效金字塔化**：通过低成本微调（5K步），成功将预训练的标准视频扩散模型转换为时空金字塔模型（PyramidalWan）。在保持视觉质量（VBench总分相当）的同时，**将推理计算成本（FLOPs）降低了约78%**（从 2×12592 TFLOPs 降至 2×2821 TFLOPs）。
2.  **少步推理突破**：提出的金字塔步数蒸馏模型（如 PyramidalWan-DMD-PT*）能够在**最高分辨率仅需1步**（配合低分辨率阶段的少量步数，如2-2-1调度）的极高效设置下生成视频。其质量在用户偏好研究中与计算成本高得多的基线模型（如50步的Wan模型或2步的Wan-DMD模型）**无显著差异**，填补了单步/少步高质量视频生成的空白。
3.  **方法普适性验证**：不仅实现了从标准模型到金字塔模型的转换，还首次成功演示了**对预训练的金字塔模型进行步数蒸馏**，为未来基于高效金字塔架构的训练提供了重要参考。

### 二、 使用的数据集
1.  **合成数据集（主要）**：使用由更大规模模型 **Wan2.1-14B** 生成的 **80K个合成视频**。论文发现，在此数据上训练的模型比在真实视频数据上训练的视觉质量更优。
2.  **文本提示数据集**：用于原始Wan模型的步数蒸馏（Wan-DMD），使用了来自Open-Sora计划的 **350K文本提示子集**，此阶段无需视觉数据。

### 三、 评价指标
论文使用了两个主流的视频生成评估套件：
1.  **VBench**：综合性评估，包含多个维度，如主体一致性、运动平滑度、美学质量、成像质量、语义对齐等，最终汇总为 **Total Score**。
2.  **VBench-2.0**：更侧重于视频生成的**内在忠实度**，评估维度包括创造力、常识、可控性、人体保真度、物理合理性等，最终汇总为 **Total Score**。
3.  **计算效率指标**：
    *   **FLOPs（浮点运算次数）**：衡量推理计算成本。
    *   **Latency（延迟）**：测量单次去噪器前向传播的耗时（毫秒）。
4.  **用户研究（Human Preference Study）**：让评估者对成对视频（本模型 vs. 基线模型）进行偏好选择（“偏好A”、“偏好B”或“无偏好”），使用二项检验进行统计分析，这是对定量指标的重要补充。

### 四、 对比的基线方法
论文与一系列强基线方法进行了全面对比：
1.  **原始模型**：
    *   `Wan2.1-1.3B (50 steps)`：多步推理的黄金标准。
    *   `Wan2.1-1.3B (25 steps)`：速度更快的多步基线。
2.  **标准步数蒸馏模型**（在原始分辨率上进行）：
    *   `Wan-DMD (4, 2, 1 steps)`：使用分布匹配蒸馏（DMD）得到的少步模型。
    *   `Wan-Adv (4, 2, 1 steps)`：使用对抗蒸馏得到的少步模型。
3.  **其他高效生成方法**：
    *   `Jenga`：一种动态令牌裁剪/稀疏化方法（在补充材料中对比）。
4.  **其他金字塔/补丁金字塔方法**：
    *   `Wan-PPF-DMD`：基于金字塔补丁化流（PPF）框架的蒸馏模型。

### 五、 关键性能提升与结论
1.  **质量-效率权衡优异**：
    *   **PyramidalWan (20-20-10)**：在VBench总分（82.83）上与50步的原始Wan模型（82.49）相当，甚至略高，同时计算成本降至约1/4.5。这证明了**金字塔化微调能在几乎不损失质量的前提下大幅提升效率**。
    *   **PyramidalWan-DMD-PT* (2-2-1)**：在用户研究中，其生成视频的偏好性与50步的Wan模型和2步的Wan-DMD模型**没有统计学上的显著差异**（p值 < 0.001，支持“基线并非严格更优”的假设）。这表明该模型在**极低的推理成本下（单高分辨率步）达到了与高成本基线相当的视觉质量**。

2.  **突破单步推理瓶颈**：
    *   标准的少步蒸馏模型（`Wan-DMD`）在2步和4步时表现优异（VBench总分 > 83），但**在单步（1 step）时质量大幅下降**（VBench总分降至79.45）。
    *   本文的金字塔少步模型（如 `PyramidalWan-DMD-OT (2-2-1)`）通过将计算负担分配至低分辨率阶段，**成功实现了可行的“准单步”生成**（高分辨率仅1步），且VBench总分保持在82.86，填补了性能空白。

3.  **方法对比结论**：
    *   **金字塔流 vs. 补丁金字塔**：在有限的训练预算下，PyramidalFlow框架的微调效果优于PPF框架。PPF在直接微调扩散模型时未能收敛，但有趣的是，其检查点仍可用于后续的DMD蒸馏。
    *   **蒸馏策略**：对于金字塔模型，使用简化版的金字塔DMD目标（`-PT*`）虽然在理论上不完备，但取得了更好的实践效果。同时，**对抗蒸馏与DMD在金字塔设置下都是有效的**。
    *   **与动态裁剪方法对比**：与Jenga等动态令牌裁剪方法相比，金字塔化方法提供了**静态计算图**，更易于部署，并且在实验中展现了更好的视觉质量（Jenga易产生场景突变、运动不连贯等伪影）。

4.  **定量指标与人类偏好的一致性**：
    *   尽管部分金字塔少步模型（如PyramidalWan-DMD-PT*）的VBench-2.0总分（51.75）低于一些基线（如Wan-DMD 2步的56.67），但其在**用户偏好研究中表现优异**。这提示VBench-2.0的某些维度（如创造力、可控性）的评分可能与人类主观感受存在差异，金字塔模型在视觉观感上更具竞争力。

**总结**：论文通过系统的实验证明，所提出的金字塔化与蒸馏流程能够将强大的预训练视频扩散模型高效地适配到金字塔架构中，在计算成本降低一个数量级的同时，依然能生成视觉质量令人满意的视频，特别是在少步/“准单步”推理场景下取得了突破性进展。


## 相关链接

- [arXiv 页面](https://arxiv.org/abs/2601.04792v1)
- [HTML 版本](https://arxiv.org/html/2601.04792v1)
